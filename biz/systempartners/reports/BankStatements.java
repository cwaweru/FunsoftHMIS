/*
 * ReportIntfr.java
 *
 * Created on July 6, 2008, 4:40 PM
 */
package biz.systempartners.reports;
import java.sql.SQLException;

/**
 *
 * @author samuel
 */
public class BankStatements extends javax.swing.JInternalFrame {

    java.sql.Connection connectDB = null;
    com.afrisoftech.lib.DBObject dbObject = null;

    /**
     * Creates new form ReportIntfr
     */
    public BankStatements(java.sql.Connection connDb) {
        connectDB = connDb;
        dbObject = new com.afrisoftech.lib.DBObject();
        initComponents();
        //  loadReport();

    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {
        java.awt.GridBagConstraints gridBagConstraints;

        headerPanel = new javax.swing.JPanel();
        export2SpreadSheetBtn = new javax.swing.JButton();
        beginDatePicker = new com.afrisoftech.lib.DatePicker();
        endDatePicker = new com.afrisoftech.lib.DatePicker();
        beginDateLbl = new javax.swing.JLabel();
        endDateLbl = new javax.swing.JLabel();
        printBtn = new javax.swing.JButton();
        saveReportBtn = new javax.swing.JButton();
        accountNoCmb = new javax.swing.JComboBox();
        accountNoTxt = new javax.swing.JTextField();
        jLabel1 = new javax.swing.JLabel();
        jLabel2 = new javax.swing.JLabel();
        buttonPanel = new javax.swing.JPanel();
        closeBtn = new javax.swing.JButton();
        reloadReportBtn = new javax.swing.JButton();
        spaceLable = new javax.swing.JLabel();
        creditTotalTxt = new javax.swing.JTextField();
        balanceTotalTxt = new javax.swing.JTextField();
        debitTotalTxt = new javax.swing.JTextField();
        bankStatementTabbedPane = new javax.swing.JTabbedPane();
        reportBodyPanel = new javax.swing.JPanel();
        reportBodyJscrollPane = new javax.swing.JScrollPane();
        reportBodyTable = new com.afrisoftech.dbadmin.JTable();
        reportBodyDetailsPanel = new javax.swing.JPanel();
        jScrollPane1 = new javax.swing.JScrollPane();
        tableViewDetails = new com.afrisoftech.dbadmin.JTable();

        setClosable(true);
        setIconifiable(true);
        setMaximizable(true);
        setResizable(true);
        setTitle("Creditors Report Module -");
        try {
            setSelected(true);
        } catch (java.beans.PropertyVetoException e1) {
            e1.printStackTrace();
        }
        setVisible(true);
        getContentPane().setLayout(new java.awt.GridBagLayout());

        headerPanel.setLayout(new java.awt.GridBagLayout());

        export2SpreadSheetBtn.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Icons/16x16/Appointments.png"))); // NOI18N
        export2SpreadSheetBtn.setMnemonic('x');
        export2SpreadSheetBtn.setText("Export report ...");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 7;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        headerPanel.add(export2SpreadSheetBtn, gridBagConstraints);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        headerPanel.add(beginDatePicker, gridBagConstraints);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 3;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        headerPanel.add(endDatePicker, gridBagConstraints);

        beginDateLbl.setText("Begin Date");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        headerPanel.add(beginDateLbl, gridBagConstraints);

        endDateLbl.setText("End Date");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        headerPanel.add(endDateLbl, gridBagConstraints);

        printBtn.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Icons/16x16/Devices & Hardware/Printer 4.png"))); // NOI18N
        printBtn.setMnemonic('p');
        printBtn.setText("Print ...");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 6;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        headerPanel.add(printBtn, gridBagConstraints);

        saveReportBtn.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Icons/16x16/Globe 4.png"))); // NOI18N
        saveReportBtn.setMnemonic('s');
        saveReportBtn.setText("Save Report ...");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 7;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        headerPanel.add(saveReportBtn, gridBagConstraints);

        accountNoCmb.setModel(com.afrisoftech.lib.ComboBoxModel.ComboBoxModel(connectDB, "select DISTINCT bank_account_no from ac_banks_setup ORDER BY bank_account_no"));
        accountNoCmb.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                accountNoCmbActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.gridwidth = 2;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        headerPanel.add(accountNoCmb, gridBagConstraints);

        accountNoTxt.setEditable(false);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 4;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.gridwidth = 3;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        headerPanel.add(accountNoTxt, gridBagConstraints);

        jLabel1.setText("Acc. No.");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        headerPanel.add(jLabel1, gridBagConstraints);

        jLabel2.setText("Acc. Name");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 3;
        gridBagConstraints.gridy = 1;
        headerPanel.add(jLabel2, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.gridheight = 2;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        getContentPane().add(headerPanel, gridBagConstraints);

        buttonPanel.setLayout(new java.awt.GridBagLayout());

        closeBtn.setMnemonic('l');
        closeBtn.setText("Close Reporter");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 5;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        buttonPanel.add(closeBtn, gridBagConstraints);

        reloadReportBtn.setMnemonic('r');
        reloadReportBtn.setText("Reload report");
        reloadReportBtn.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                reloadReportBtnActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 4;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        buttonPanel.add(reloadReportBtn, gridBagConstraints);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 10.0;
        gridBagConstraints.weighty = 1.0;
        buttonPanel.add(spaceLable, gridBagConstraints);

        creditTotalTxt.setEditable(false);
        creditTotalTxt.setBorder(javax.swing.BorderFactory.createTitledBorder("Credit"));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 20.0;
        gridBagConstraints.weighty = 1.0;
        buttonPanel.add(creditTotalTxt, gridBagConstraints);

        balanceTotalTxt.setEditable(false);
        balanceTotalTxt.setBorder(javax.swing.BorderFactory.createTitledBorder("Balance"));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 3;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 20.0;
        gridBagConstraints.weighty = 1.0;
        buttonPanel.add(balanceTotalTxt, gridBagConstraints);

        debitTotalTxt.setEditable(false);
        debitTotalTxt.setBorder(javax.swing.BorderFactory.createTitledBorder("Debit"));
        debitTotalTxt.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                debitTotalTxtActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 20.0;
        gridBagConstraints.weighty = 1.0;
        buttonPanel.add(debitTotalTxt, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 3;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        getContentPane().add(buttonPanel, gridBagConstraints);

        bankStatementTabbedPane.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                bankStatementTabbedPaneMouseClicked(evt);
            }
        });

        reportBodyPanel.setBorder(javax.swing.BorderFactory.createTitledBorder(javax.swing.BorderFactory.createEtchedBorder()));
        reportBodyPanel.setLayout(new java.awt.GridBagLayout());

        reportBodyTable.setAutoCreateRowSorter(true);
        reportBodyTable.setFont(new java.awt.Font("Dialog", 1, 13)); // NOI18N
        reportBodyTable.setForeground(new java.awt.Color(0, 0, 255));
        reportBodyTable.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {"Bal  B/F", null},
                {"Receipts                            Total", null},
                {"Payments                          Total", null},
                {"Balance Per Cash Book    Total", null},
                {null, null},
                {"        BANK RECONCILIATION", "        "},
                {"Balance Per Cash Book             Total", null},
                {"ADD", null},
                {"Payments in Cash Book not yet the in Bank Statement", null},
                {"Recipts in Bank Statement not yet recorded In Cash Book", null},
                {"LESS", null},
                {"Pyment in Bank Statement not yet recorded In Cash Book", null},
                {"Receipts in Cash Book not yet in the Bank Statement", null},
                {"Balance Per Bank Statement         ", null},
                {null, null},
                {"Unbalanced Amount", null},
                {null, null},
                {null, null},
                {null, null}
            },
            new String [] {
                "Detail", "Totals"
            }
        ) {
            boolean[] canEdit = new boolean [] {
                false, false
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        reportBodyTable.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                reportBodyTableMouseClicked(evt);
            }
        });
        reportBodyJscrollPane.setViewportView(reportBodyTable);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        reportBodyPanel.add(reportBodyJscrollPane, gridBagConstraints);

        bankStatementTabbedPane.addTab("Bank Statement", reportBodyPanel);

        reportBodyDetailsPanel.setBorder(javax.swing.BorderFactory.createTitledBorder(javax.swing.BorderFactory.createEtchedBorder()));
        reportBodyDetailsPanel.setLayout(new java.awt.GridBagLayout());

        tableViewDetails.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {

            }
        ));
        tableViewDetails.setToolTipText("Please enter actual bank balance");
        jScrollPane1.setViewportView(tableViewDetails);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 6;
        gridBagConstraints.gridwidth = 6;
        gridBagConstraints.gridheight = 3;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 100.0;
        gridBagConstraints.insets = new java.awt.Insets(0, 10, 10, 10);
        reportBodyDetailsPanel.add(jScrollPane1, gridBagConstraints);

        bankStatementTabbedPane.addTab("Bank Account Details", reportBodyDetailsPanel);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 2;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 200.0;
        getContentPane().add(bankStatementTabbedPane, gridBagConstraints);

        setBounds(0, 0, 848, 479);
    }// </editor-fold>//GEN-END:initComponents
    private void clear(){
       reportBodyTable.getModel().setValueAt(null, 0, 1);//bal brought forward
       reportBodyTable.getModel().setValueAt(null, 1, 1);//Receipts
       reportBodyTable.getModel().setValueAt(null, 2, 1);//payments 
       reportBodyTable.getModel().setValueAt(null, 3, 1);
       reportBodyTable.getModel().setValueAt(null, 4, 1);
       reportBodyTable.getModel().setValueAt(null, 5, 1);//Receipts
       reportBodyTable.getModel().setValueAt(null, 6, 1);
       reportBodyTable.getModel().setValueAt(null, 7, 1);//payments
       reportBodyTable.getModel().setValueAt(null, 8, 1);//Receipts
       reportBodyTable.getModel().setValueAt(null, 9, 1);
       reportBodyTable.getModel().setValueAt(null, 10, 1);
       reportBodyTable.getModel().setValueAt(null, 11, 1);
       reportBodyTable.getModel().setValueAt(null, 12, 1);
       reportBodyTable.getModel().setValueAt(null, 13, 1);
       reportBodyTable.getModel().setValueAt(null, 14, 1);
       reportBodyTable.getModel().setValueAt(null, 15, 1);
       
       
    }
    private void loadAndOpenReport(){
     if (this.bankStatementTabbedPane.getSelectedIndex() ==0) 
        {
            this.setCursor(new java.awt.Cursor(java.awt.Cursor.WAIT_CURSOR));
            
            Double balanceTotal = 0.00;
            Double totalDebit = 0.00;
            Double payments8 = 0.00;
            Double payments11 = 0.00;
            Double receipts9 = 0.00;
            Double totalStatement = 0.00;
            Double receipts12 = 0.00;
            Double totalCredit = 0.00;
            Double userAmount = 0.00;
            Double expectedBal = 0.00;
           com.afrisoftech.lib.DBObject dbObject = new com.afrisoftech.lib.DBObject();
           
        try{                  
       java.sql.PreparedStatement getBalF = connectDB.prepareStatement("select sum(debit-credit),sum(debit),sum(credit) from ac_cash_book where "
               + "date::date < '"+beginDatePicker.getDate()+"' and account_no = '"+accountNoCmb.getSelectedItem().toString()+"'");
       java.sql.ResultSet resultGetBal = getBalF.executeQuery();
       while (resultGetBal.next()){
       reportBodyTable.getModel().setValueAt(com.afrisoftech.lib.CurrencyFormatter.getFormattedDouble(java.lang.Double.valueOf(dbObject.getDBObject(resultGetBal.getObject(1),"0.00").toString())), 0, 1);//bal brought forward
       balanceTotal = java.lang.Double.valueOf(dbObject.getDBObject(resultGetBal.getObject(1),"0.00").toString());
       //reportBodyTable.getModel().setValueAt((java.lang.Double.valueOf(resultGetBal.getObject(1).toString())+ java.lang.Double.valueOf(resultGetBal.getObject(2).toString())) - java.lang.Double.valueOf(resultGetBal.getObject(3).toString()), 3, 1);//bal expected
       }
       //date between
       java.sql.PreparedStatement getTotal = connectDB.prepareStatement("select sum(debit),sum(credit) from ac_cash_book where "
       + "date::date between '"+beginDatePicker.getDate()+"' and '"+endDatePicker.getDate()+"' and account_no = '"+accountNoCmb.getSelectedItem().toString()+"'");
       java.sql.ResultSet resultTotal = getTotal.executeQuery();
       while (resultTotal.next()){
//       com.afrisoftech.lib.CurrencyFormatter.getFormattedDouble(java.lang.Double.valueOf(resultReconcilition.getObject(1).toString()));
//       totalDebit =   java.lang.Double.valueOf(resultTotal.getObject(1).toString());    
           //dbObject.getDBObject(rset.getObject(2),"-").toString()
       reportBodyTable.getModel().setValueAt(com.afrisoftech.lib.CurrencyFormatter.getFormattedDouble(java.lang.Double.valueOf(dbObject.getDBObject(resultTotal.getObject(1),"0.00").toString())), 1, 1);//Receipts
       reportBodyTable.getModel().setValueAt(com.afrisoftech.lib.CurrencyFormatter.getFormattedDouble(java.lang.Double.valueOf(dbObject.getDBObject(resultTotal.getObject(2),"0.00").toString())), 2, 1);//payments
       reportBodyTable.getModel().setValueAt(com.afrisoftech.lib.CurrencyFormatter.getFormattedDouble((java.lang.Double.valueOf(balanceTotal)+ java.lang.Double.valueOf(dbObject.getDBObject(resultTotal.getObject(1),"0.00").toString())) - java.lang.Double.valueOf(dbObject.getDBObject(resultTotal.getObject(2),"0.00").toString())), 3, 1);//bal expected
       reportBodyTable.getModel().setValueAt(com.afrisoftech.lib.CurrencyFormatter.getFormattedDouble((java.lang.Double.valueOf(balanceTotal)+ java.lang.Double.valueOf(dbObject.getDBObject(resultTotal.getObject(1),"0.00").toString())) - java.lang.Double.valueOf(dbObject.getDBObject(resultTotal.getObject(2),"0.00").toString())), 6, 1);//bal expected
       expectedBal = (java.lang.Double.valueOf(balanceTotal)+ java.lang.Double.valueOf(dbObject.getDBObject(resultTotal.getObject(1),"0.00").toString())) - java.lang.Double.valueOf(dbObject.getDBObject(resultTotal.getObject(2),"0.00").toString());
       //expectedBal = ;
       }
       //endDatePicker
       java.sql.PreparedStatement getReconcilition = connectDB.prepareStatement("select sum(debit),sum(credit) from ac_cash_book where "
               + "date::date between '"+beginDatePicker.getDate()+"' and '"+endDatePicker.getDate()+"' and account_no = '"+accountNoCmb.getSelectedItem().toString()+"' and reconciled = false");
       java.sql.ResultSet resultReconcilition = getReconcilition.executeQuery();
       while (resultReconcilition.next()){
       receipts12 = java.lang.Double.valueOf(dbObject.getDBObject(resultReconcilition.getObject(1),"0.00").toString());
       payments8 = java.lang.Double.valueOf(dbObject.getDBObject(resultReconcilition.getObject(2),"0.00").toString());
       reportBodyTable.getModel().setValueAt(com.afrisoftech.lib.CurrencyFormatter.getFormattedDouble(java.lang.Double.valueOf(dbObject.getDBObject(resultReconcilition.getObject(1),"0.00").toString())), 12, 1);//Receipts
       reportBodyTable.getModel().setValueAt(com.afrisoftech.lib.CurrencyFormatter.getFormattedDouble(java.lang.Double.valueOf(dbObject.getDBObject(resultReconcilition.getObject(2),"0.00").toString())), 8, 1);//payments
       
       }
       
       java.sql.PreparedStatement getActualBal = connectDB.prepareStatement("select amount from ac_actual_bank_statement where "
         + "end_date::date = '"+endDatePicker.getDate()+"' and bank_account = '"+accountNoCmb.getSelectedItem().toString()+"'");
       java.sql.ResultSet resultActualBal = getActualBal.executeQuery();
       while (resultActualBal.next()){
       //reportBodyTable.getModel().setValueAt(com.afrisoftech.lib.CurrencyFormatter.getFormattedDouble(java.lang.Double.valueOf(dbObject.getDBObject(resultActualBal.getObject(1),"0.00").toString())), 13, 1);
       userAmount = java.lang.Double.valueOf(dbObject.getDBObject(resultActualBal.getObject(1),"0.00").toString());
       
       }
       java.sql.PreparedStatement getBankStmt = connectDB.prepareStatement("select sum(debit), sum(credit) from ac_bank_reconcillations where "
         + "statement_date::date between  '"+beginDatePicker.getDate()+"' and '"+endDatePicker.getDate()+"' and account_no = '"+accountNoCmb.getSelectedItem().toString()+"' and reconciled = false");
       java.sql.ResultSet resultBankStmt = getBankStmt.executeQuery();
       while (resultBankStmt.next()){
       //payments11 = resultBankStmt.getDouble(2);
       payments11 = java.lang.Double.valueOf(dbObject.getDBObject(resultBankStmt.getObject(2),"0.00").toString());
       receipts9 = java.lang.Double.valueOf(dbObject.getDBObject(resultBankStmt.getObject(1),"0.00").toString());
       reportBodyTable.getModel().setValueAt(com.afrisoftech.lib.CurrencyFormatter.getFormattedDouble(java.lang.Double.valueOf(dbObject.getDBObject(resultBankStmt.getObject(1),"0.00").toString())), 9, 1);
       reportBodyTable.getModel().setValueAt(com.afrisoftech.lib.CurrencyFormatter.getFormattedDouble(java.lang.Double.valueOf(dbObject.getDBObject(resultBankStmt.getObject(2),"0.00").toString())), 11, 1);
       
       }
       totalStatement = (payments8 + receipts9 + expectedBal)-(payments11+receipts12);
       reportBodyTable.getModel().setValueAt(com.afrisoftech.lib.CurrencyFormatter.getFormattedDouble(java.lang.Double.valueOf(dbObject.getDBObject(totalStatement,"0.00").toString())- userAmount), 15, 1);//amount - user amount
       reportBodyTable.getModel().setValueAt(com.afrisoftech.lib.CurrencyFormatter.getFormattedDouble(java.lang.Double.valueOf(dbObject.getDBObject(totalStatement,"0.00").toString())), 13, 1);//bal brought forward
       
        }catch(SQLException Esq){
            Esq.printStackTrace();
            javax.swing.JOptionPane.showMessageDialog(this, Esq.getMessage());
        }

       this.setCursor(new java.awt.Cursor(java.awt.Cursor.DEFAULT_CURSOR));
        }
        this.setCursor(new java.awt.Cursor(java.awt.Cursor.DEFAULT_CURSOR));    
    }
    private void reloadReportBtnActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_reloadReportBtnActionPerformed
        this.setCursor(new java.awt.Cursor(java.awt.Cursor.WAIT_CURSOR));
        loadAndOpenReport();
        this.setCursor(new java.awt.Cursor(java.awt.Cursor.DEFAULT_CURSOR));
        // TODO add your handling code here:
    }//GEN-LAST:event_reloadReportBtnActionPerformed

    private void reportBodyTableMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_reportBodyTableMouseClicked
       
        this.setCursor(new java.awt.Cursor(java.awt.Cursor.WAIT_CURSOR));
                for(int t=0;t<tableViewDetails.getModel().getRowCount();t++){
                      for(int c=0;c<tableViewDetails.getModel().getColumnCount();c++){
                           tableViewDetails.getModel().setValueAt(null, t, c);
                      }
                }
        try{
            
      
     if(reportBodyTable.getSelectedRow()==12){
    tableViewDetails.setModel(com.afrisoftech.dbadmin.TableModel.createTableVectors(connectDB,"select date,cheque_no,debit as debit,"
    + "reconciled from ac_cash_book where account_no = '"+accountNoCmb.getSelectedItem().toString()+"' "
    + " AND reconciled = false AND date between '"+beginDatePicker.getDate().toString()+"' and '"+endDatePicker.getDate().toString()+"' and debit >0 ORDER BY date ASC")); 
   
     bankStatementTabbedPane.setSelectedIndex(1);
     } 
     else if(reportBodyTable.getSelectedRow()==8){
    tableViewDetails.setModel(com.afrisoftech.dbadmin.TableModel.createTableVectors(connectDB,"select date,cheque_no,"
    + "credit as credit,reconciled from ac_cash_book where account_no = '"+accountNoCmb.getSelectedItem().toString()+"' "
    + " AND reconciled = false AND date between '"+beginDatePicker.getDate().toString()+"' and '"+endDatePicker.getDate().toString()+"' and credit > 0 ORDER BY date ASC"));
    bankStatementTabbedPane.setSelectedIndex(1);

     }else if(reportBodyTable.getSelectedRow()==9){
   //SELECT account_no, record_date, statement_date, cheque_no, particulars,debit, credit, reconciled, remarks,statement_date_stamp, user_logged_in FROM ac_bank_reconcillations;
    tableViewDetails.setModel(com.afrisoftech.dbadmin.TableModel.createTableVectors(connectDB,"select statement_date,cheque_no,"
    + "debit as debit,reconciled from ac_bank_reconcillations where account_no = '"+accountNoCmb.getSelectedItem().toString()+"' "
    + " AND reconciled = false AND statement_date between '"+beginDatePicker.getDate().toString()+"' and '"+endDatePicker.getDate().toString()+"' and debit > 0 ORDER BY statement_date ASC"));
    bankStatementTabbedPane.setSelectedIndex(1);

     }else if(reportBodyTable.getSelectedRow()==11){
   //SELECT account_no, record_date, statement_date, cheque_no, particulars,debit, credit, reconciled, remarks,statement_date_stamp, user_logged_in FROM ac_bank_reconcillations;
    tableViewDetails.setModel(com.afrisoftech.dbadmin.TableModel.createTableVectors(connectDB,"select statement_date,cheque_no,"
    + "credit as credit,reconciled from ac_bank_reconcillations where account_no = '"+accountNoCmb.getSelectedItem().toString()+"' "
    + " AND reconciled = false AND statement_date between '"+beginDatePicker.getDate().toString()+"' and '"+endDatePicker.getDate().toString()+"' and credit > 0 ORDER BY statement_date ASC"));
    bankStatementTabbedPane.setSelectedIndex(1);

     }
                        
       }
        catch(Exception meza){
            System.out.println("the populate table error is "+meza); 
            javax.swing.JOptionPane.showMessageDialog(this, meza.getMessage());
        }
        
       this.setCursor(new java.awt.Cursor(java.awt.Cursor.DEFAULT_CURSOR));


        // TODO add your handling code here:
    }//GEN-LAST:event_reportBodyTableMouseClicked

    private void bankStatementTabbedPaneMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_bankStatementTabbedPaneMouseClicked
        // TODO add your handling code here:
    }//GEN-LAST:event_bankStatementTabbedPaneMouseClicked

    private void debitTotalTxtActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_debitTotalTxtActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_debitTotalTxtActionPerformed

    private void accountNoCmbActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_accountNoCmbActionPerformed
        // TODO add your handling code here:
       clear();
      bankStatementTabbedPane.setSelectedIndex(0);
        for(int t=0;t<tableViewDetails.getModel().getRowCount();t++){
         for(int c=0;c<tableViewDetails.getModel().getColumnCount();c++){
               tableViewDetails.getModel().setValueAt(null, t, c);
                      }
                }
        try{
       java.sql.Statement stmt = connectDB.createStatement();
       java.sql.ResultSet rset = stmt.executeQuery("select account_name from ac_cash_book where account_no ='"+accountNoCmb.getSelectedItem().toString()+"'");
       
       while(rset.next()){
        accountNoTxt.setText(rset.getObject(1).toString());
       }
       loadAndOpenReport();
        }catch(java.sql.SQLException sqE){
           sqE.printStackTrace();
       javax.swing.JOptionPane.showMessageDialog(this, sqE.getMessage());  
        }
    }//GEN-LAST:event_accountNoCmbActionPerformed

  
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JComboBox accountNoCmb;
    private javax.swing.JTextField accountNoTxt;
    private javax.swing.JTextField balanceTotalTxt;
    private javax.swing.JTabbedPane bankStatementTabbedPane;
    private javax.swing.JLabel beginDateLbl;
    private com.afrisoftech.lib.DatePicker beginDatePicker;
    private javax.swing.JPanel buttonPanel;
    private javax.swing.JButton closeBtn;
    private javax.swing.JTextField creditTotalTxt;
    private javax.swing.JTextField debitTotalTxt;
    private javax.swing.JLabel endDateLbl;
    private com.afrisoftech.lib.DatePicker endDatePicker;
    private javax.swing.JButton export2SpreadSheetBtn;
    private javax.swing.JPanel headerPanel;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JButton printBtn;
    private javax.swing.JButton reloadReportBtn;
    public static javax.swing.JPanel reportBodyDetailsPanel;
    public static javax.swing.JScrollPane reportBodyJscrollPane;
    public static javax.swing.JPanel reportBodyPanel;
    public static javax.swing.JTable reportBodyTable;
    private javax.swing.JButton saveReportBtn;
    private javax.swing.JLabel spaceLable;
    private javax.swing.JTable tableViewDetails;
    // End of variables declaration//GEN-END:variables
}
