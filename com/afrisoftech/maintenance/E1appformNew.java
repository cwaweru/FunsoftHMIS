/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package com.afrisoftech.maintenance;

import java.sql.*;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.JComponent;
import javax.swing.JOptionPane;
import org.netbeans.lib.sql.pool.PooledConnection;
import org.netbeans.lib.sql.pool.PooledConnectionSource;

/**
 *
 * @author charlie
 */
public class E1appformNew extends javax.swing.JInternalFrame{
    JComponent[] arrComponents;
    public Connection connectDB=null;
    public PooledConnectionSource pconnDB;
    
    /**
     * Creates new form MachineSetup
     */
     public E1appformNew(Connection cd,PooledConnectionSource pc) {
         connectDB=cd;
         pconnDB=pc;
         
         initComponents();
         
        //tblReport = loadData(tblReport, this.uuid, "tblReport");
//        
//        arrComponents = new JComponent[10];
//        arrComponents[0] = buildingCombo;
//        arrComponents[1] = floorTextField;
//        arrComponents[2] = deptCombo;
//        arrComponents[3] = urgencyCombo;
//        //arrComponents[4] = tblReport;
//        arrComponents[5] = descriptionArea;
//        arrComponents[6] = roomTextField;
//        arrComponents[7] = phoneTextField;
//        arrComponents[8] = subjectTextField;
       
        /*try {
         initComponents();
         dbConn mpya=new dbConn();
         Connection conn=mpya.connector();
         machineCbx.removeAllItems();
         String sql="select asset_name from public.asset_registration WHERE make LIKE 'laundry'";
         Statement stmt = conn.createStatement();
         ResultSet rs = stmt.executeQuery( sql );
         while ( rs.next() ) {
         machineCbx.addItem(rs.getString("asset_name"));
         }
         } catch (SQLException ex) {
         Logger.getLogger(MachineSetup.class.getName()).log(Level.SEVERE, null, ex);
         }*/
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {
        java.awt.GridBagConstraints gridBagConstraints;

        createE1jPanel = new javax.swing.JPanel();
        jPanel7 = new javax.swing.JPanel();
        jPanel11 = new javax.swing.JPanel();
        jLabel8 = new javax.swing.JLabel();
        jLabel16 = new javax.swing.JLabel();
        urgencyCombo = new javax.swing.JComboBox();
        jLabel161 = new javax.swing.JLabel();
        jLabel81 = new javax.swing.JLabel();
        deptCombo = new javax.swing.JComboBox();
        jLabel164 = new javax.swing.JLabel();
        buildingCombo = new javax.swing.JComboBox();
        floorTextField = new javax.swing.JTextField();
        jLabel10 = new javax.swing.JLabel();
        jLabel9 = new javax.swing.JLabel();
        roomTextField = new javax.swing.JTextField();
        subjectTextField = new javax.swing.JTextField();
        phoneTextField = new javax.swing.JTextField();
        currentUsrTextField = new javax.swing.JTextField();
        jLabel83 = new javax.swing.JLabel();
        jLabel82 = new javax.swing.JLabel();
        jScrollPane2 = new javax.swing.JScrollPane();
        descriptionArea = new javax.swing.JTextArea();
        filler1 = new javax.swing.Box.Filler(new java.awt.Dimension(0, 0), new java.awt.Dimension(25, 20), new java.awt.Dimension(0, 0));
        jPanel2 = new javax.swing.JPanel();
        jPanel3 = new javax.swing.JPanel();
        jPanel4 = new javax.swing.JPanel();
        jButton1 = new javax.swing.JButton();
        jButton4 = new javax.swing.JButton();
        jPanel5 = new javax.swing.JPanel();
        jPanel6 = new javax.swing.JPanel();
        jButton5 = new javax.swing.JButton();

        setClosable(true);
        setIconifiable(true);
        setMaximizable(true);
        setResizable(true);
        setTitle("E1 Application Form");
        setMaximumSize(new java.awt.Dimension(900, 517));
        setMinimumSize(new java.awt.Dimension(900, 517));
        setPreferredSize(new java.awt.Dimension(900, 517));
        setVisible(true);
        getContentPane().setLayout(new java.awt.GridBagLayout());

        createE1jPanel.setLayout(new java.awt.GridBagLayout());

        jPanel7.setBorder(javax.swing.BorderFactory.createTitledBorder(""));
        jPanel7.setLayout(new java.awt.GridBagLayout());

        jPanel11.setBorder(javax.swing.BorderFactory.createTitledBorder(""));
        jPanel11.setLayout(new java.awt.GridBagLayout());

        jLabel8.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        jLabel8.setText("Department:");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(0, 12, 0, 0);
        jPanel11.add(jLabel8, gridBagConstraints);

        jLabel16.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        jLabel16.setText("Room:");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(0, 12, 0, 0);
        jPanel11.add(jLabel16, gridBagConstraints);

        urgencyCombo.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "-", "Not Urgent", "Urgent", "Very Urgent" }));
        urgencyCombo.setMinimumSize(new java.awt.Dimension(150, 20));
        urgencyCombo.setName("urgencyCombo"); // NOI18N
        urgencyCombo.setPreferredSize(new java.awt.Dimension(150, 20));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 2;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        jPanel11.add(urgencyCombo, gridBagConstraints);

        jLabel161.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        jLabel161.setText("Floor:");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(0, 12, 0, 0);
        jPanel11.add(jLabel161, gridBagConstraints);

        jLabel81.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        jLabel81.setText("Urgency:");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 2;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(0, 12, 0, 0);
        jPanel11.add(jLabel81, gridBagConstraints);

        try{
            java.sql.Statement deptsStt=connectDB.createStatement();
            java.sql.ResultSet deptsSet=deptsStt.executeQuery("SELECT '-' AS store_name UNION SELECT DISTINCT store_name FROM st_stores ORDER BY store_name");

            while(deptsSet.next()){
                deptCombo.addItem(deptsSet.getString(1));
            }
        }
        catch(java.sql.SQLException sqle){
            sqle.printStackTrace();
        }
        deptCombo.setMinimumSize(new java.awt.Dimension(150, 20));
        deptCombo.setName("deptCombo"); // NOI18N
        deptCombo.setPreferredSize(new java.awt.Dimension(150, 20));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        jPanel11.add(deptCombo, gridBagConstraints);

        jLabel164.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        jLabel164.setText("Building:");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(0, 12, 0, 0);
        jPanel11.add(jLabel164, gridBagConstraints);

        try{
            java.sql.Statement buildStt=connectDB.createStatement();
            java.sql.ResultSet buildSet=buildStt.executeQuery("SELECT '-' AS value UNION SELECT DISTINCT value FROM maintenance.vw_list_buildings ORDER BY value");

            while(buildSet.next()){
                buildingCombo.addItem(buildSet.getString(1));
            }
        }
        catch(java.sql.SQLException sqle){
            sqle.printStackTrace();
        }
        buildingCombo.setMinimumSize(new java.awt.Dimension(150, 20));
        buildingCombo.setName("buildingCombo"); // NOI18N
        buildingCombo.setPreferredSize(new java.awt.Dimension(150, 20));
        buildingCombo.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                buildingComboActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 3;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        jPanel11.add(buildingCombo, gridBagConstraints);

        floorTextField.setColumns(10);
        floorTextField.setMaximumSize(new java.awt.Dimension(32767, 32767));
        floorTextField.setMinimumSize(new java.awt.Dimension(150, 20));
        floorTextField.setName("floorTextField"); // NOI18N
        floorTextField.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                floorTextFieldActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        jPanel11.add(floorTextField, gridBagConstraints);

        jLabel10.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        jLabel10.setText("Subject:");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 4;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(0, 12, 0, 0);
        jPanel11.add(jLabel10, gridBagConstraints);

        jLabel9.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        jLabel9.setText("Description:");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 5;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(0, 12, 0, 0);
        jPanel11.add(jLabel9, gridBagConstraints);

        roomTextField.setMaximumSize(new java.awt.Dimension(32767, 32767));
        roomTextField.setMinimumSize(new java.awt.Dimension(150, 20));
        roomTextField.setName("roomTextField"); // NOI18N
        roomTextField.setPreferredSize(new java.awt.Dimension(150, 20));
        roomTextField.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                roomTextFieldActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 3;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        jPanel11.add(roomTextField, gridBagConstraints);

        subjectTextField.setColumns(10);
        subjectTextField.setMaximumSize(new java.awt.Dimension(32767, 32767));
        subjectTextField.setMinimumSize(new java.awt.Dimension(150, 20));
        subjectTextField.setName("subjectTextField"); // NOI18N
        subjectTextField.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                subjectTextFieldActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 4;
        gridBagConstraints.gridwidth = 2;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.weightx = 2.0;
        jPanel11.add(subjectTextField, gridBagConstraints);

        phoneTextField.setMaximumSize(new java.awt.Dimension(32767, 32767));
        phoneTextField.setMinimumSize(new java.awt.Dimension(150, 20));
        phoneTextField.setName("phoneTextField"); // NOI18N
        phoneTextField.setPreferredSize(new java.awt.Dimension(150, 20));
        phoneTextField.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                phoneTextFieldActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 3;
        gridBagConstraints.gridy = 2;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        jPanel11.add(phoneTextField, gridBagConstraints);

        currentUsrTextField.setEditable(false);
        currentUsrTextField.setColumns(10);
        try{
            if(connectDB==null){
                System.err.println("SHIDA IKO HAPA!!");
            }
            java.sql.Statement currUsr=connectDB.createStatement();
            java.sql.ResultSet currUserSet=currUsr.executeQuery("SELECT current_user");

            while(currUserSet.next()){
                currentUsrTextField.setText(currUserSet.getString(1));
            }
        }
        catch(java.sql.SQLException sqle){
            sqle.printStackTrace();
        }
        currentUsrTextField.setFont(new java.awt.Font("Cantarell", 1, 15)); // NOI18N
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 3;
        gridBagConstraints.gridy = 6;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        jPanel11.add(currentUsrTextField, gridBagConstraints);

        jLabel83.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        jLabel83.setText("Phone Ext:");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 2;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(0, 12, 0, 0);
        jPanel11.add(jLabel83, gridBagConstraints);

        jLabel82.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        jLabel82.setText("Current User");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 6;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(0, 12, 0, 0);
        jPanel11.add(jLabel82, gridBagConstraints);

        jScrollPane2.setHorizontalScrollBarPolicy(javax.swing.ScrollPaneConstants.HORIZONTAL_SCROLLBAR_NEVER);
        jScrollPane2.setVerticalScrollBarPolicy(javax.swing.ScrollPaneConstants.VERTICAL_SCROLLBAR_ALWAYS);

        descriptionArea.setColumns(20);
        descriptionArea.setLineWrap(true);
        descriptionArea.setRows(5);
        jScrollPane2.setViewportView(descriptionArea);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 5;
        gridBagConstraints.gridwidth = 3;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel11.add(jScrollPane2, gridBagConstraints);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 3;
        gridBagConstraints.gridwidth = 4;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        jPanel11.add(filler1, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 3.0;
        jPanel7.add(jPanel11, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 20.0;
        gridBagConstraints.weighty = 1.0;
        createE1jPanel.add(jPanel7, gridBagConstraints);

        jPanel2.setBorder(javax.swing.BorderFactory.createTitledBorder(""));
        jPanel2.setLayout(new java.awt.GridBagLayout());

        jPanel3.setBorder(javax.swing.BorderFactory.createTitledBorder(""));
        jPanel3.setLayout(new java.awt.GridBagLayout());
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel2.add(jPanel3, gridBagConstraints);

        jPanel4.setBorder(javax.swing.BorderFactory.createTitledBorder("Actions"));
        jPanel4.setLayout(new java.awt.GridBagLayout());

        jButton1.setMnemonic('w');
        jButton1.setText("Save Details");
        jButton1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton1ActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel4.add(jButton1, gridBagConstraints);

        jButton4.setMnemonic('C');
        jButton4.setText("Clear");
        jButton4.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton4ActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 4;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel4.add(jButton4, gridBagConstraints);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 2;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 5.0;
        jPanel4.add(jPanel5, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 30.0;
        jPanel2.add(jPanel4, gridBagConstraints);

        jPanel6.setBorder(javax.swing.BorderFactory.createTitledBorder("Assistance"));
        jPanel6.setLayout(new java.awt.GridBagLayout());

        jButton5.setMnemonic('H');
        jButton5.setText("Help");
        jPanel6.add(jButton5, new java.awt.GridBagConstraints());

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 2;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel2.add(jPanel6, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        createE1jPanel.add(jPanel2, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.ipadx = 100;
        gridBagConstraints.ipady = 100;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 5.0;
        getContentPane().add(createE1jPanel, gridBagConstraints);

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void jButton4ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton4ActionPerformed
        // TODO add your handling code here:
        deptCombo.setSelectedIndex(0);
        buildingCombo.setSelectedIndex(0);
        floorTextField.setText("");
        roomTextField.setText("");
        urgencyCombo.setSelectedIndex(0);
        phoneTextField.setText("");
        subjectTextField.setText("");
        descriptionArea.setText("");

        if(!jButton1.isEnabled()){
            jButton1.setEnabled(true);
        }

    }//GEN-LAST:event_jButton4ActionPerformed

    private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton1ActionPerformed

        if(deptCombo.getSelectedItem()==null||deptCombo.getSelectedItem().toString().equalsIgnoreCase("-")||
            buildingCombo.getSelectedItem()==null||buildingCombo.getSelectedItem().toString().equalsIgnoreCase("-")||
            phoneTextField.getText().length()<3||
            descriptionArea.getText()==null||
            subjectTextField.getText().length()<3||
            urgencyCombo.getSelectedItem()==null||urgencyCombo.getSelectedItem().toString().equalsIgnoreCase("-")){
            javax.swing.JOptionPane.showMessageDialog(this, "Please ensure that you have appropriate values for Department, Building, Phone ext, \n"
                + "Description, Subject and Urgency.",
                "Caution Message",
                javax.swing.JOptionPane.INFORMATION_MESSAGE);
        } else{
            
            //random numbers give a temporary e1_id before the update with the nextval just before commit
            //concatenated 2 random numbers to further decrease the likelihood of 2 or more jar files generating the same number
            //done to minimize what appears to be skipping of e1_id's when/if exceptions occur
            double random1=(double)java.lang.Math.random()*10000;
            double random2=(double)java.lang.Math.random()*10000;
            java.lang.StringBuffer tempE1_ID=new java.lang.StringBuffer();
            tempE1_ID.append(random1+"_"+random2+"");
            
            //replacing inherent period characters with zeroes to prevent DB exceptions
            int index1=tempE1_ID.indexOf(".");
            int index2=tempE1_ID.lastIndexOf(".");
            tempE1_ID.setCharAt(index2, '0');
            tempE1_ID.setCharAt(index1, '0');
            
            System.err.println("temporary ID "+tempE1_ID.toString());


            java.text.SimpleDateFormat sdf=new java.text.SimpleDateFormat("yyyy-MM-dd HH:mm:ss");

            String e1_ID=null;
            try{

                connectDB.setAutoCommit(false);

                java.sql.PreparedStatement savePrepStt=connectDB.prepareStatement("INSERT INTO maintenance.e1_details VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?)");
                savePrepStt.setString(1, tempE1_ID.toString());
                savePrepStt.setObject(2, deptCombo.getSelectedItem());
                savePrepStt.setObject(3, buildingCombo.getSelectedItem());
                savePrepStt.setString(4, floorTextField.getText());
                savePrepStt.setString(5, roomTextField.getText());
                savePrepStt.setObject(6, urgencyCombo.getSelectedItem());
                savePrepStt.setString(7, subjectTextField.getText());
                savePrepStt.setString(8, phoneTextField.getText());
                savePrepStt.setString(9, descriptionArea.getText());
                savePrepStt.setString(10, currentUsrTextField.getText());
                savePrepStt.setBoolean(11, false);//e1 not approved
                savePrepStt.setBoolean(12, false);//job card from e1 not registered
                savePrepStt.setObject(13, java.sql.Timestamp.valueOf(sdf.format(new java.util.Date())));

                savePrepStt.executeUpdate();
                
                java.sql.Statement nextValStt=connectDB.createStatement();
                java.sql.ResultSet nextValRs=nextValStt.executeQuery("SELECT nextval('maintenance.e1_seq')");

                while(nextValRs.next()){
                    e1_ID="E1_"+nextValRs.getString(1);
                }
                
                java.sql.PreparedStatement updatePs=connectDB.prepareStatement("UPDATE maintenance.e1_details SET e1_id='"+e1_ID+"' WHERE e1_ID='"+tempE1_ID.toString()+"'");
                updatePs.executeUpdate();
                
                tempE1_ID=null;

                //save and clean up
                connectDB.commit();
                connectDB.setAutoCommit(true);

                //disable save
                jButton1.setEnabled(false);

                //clear fields
                jButton4.doClick();

                //notification
                javax.swing.JOptionPane.showMessageDialog(this, "E1 successfully created. E1 Number: "+e1_ID);

            }//ends try
            catch(java.sql.SQLException sqle){
                sqle.printStackTrace();
                
                javax.swing.JOptionPane.showMessageDialog(this, sqle,
                        "Error Message!",
                        javax.swing.JOptionPane.ERROR_MESSAGE);
                
                try{
                    connectDB.rollback();
                    connectDB.setAutoCommit(true);
                }
                catch(java.sql.SQLException sqlex){
                    sqlex.printStackTrace();
                    
                    javax.swing.JOptionPane.showMessageDialog(this, sqlex,
                        "Error Message!",
                        javax.swing.JOptionPane.ERROR_MESSAGE);
                    
                }
            }

        }

    }//GEN-LAST:event_jButton1ActionPerformed

    private void phoneTextFieldActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_phoneTextFieldActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_phoneTextFieldActionPerformed

    private void subjectTextFieldActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_subjectTextFieldActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_subjectTextFieldActionPerformed

    private void roomTextFieldActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_roomTextFieldActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_roomTextFieldActionPerformed

    private void floorTextFieldActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_floorTextFieldActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_floorTextFieldActionPerformed

    private void buildingComboActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_buildingComboActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_buildingComboActionPerformed

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JComboBox buildingCombo;
    private javax.swing.JPanel createE1jPanel;
    private javax.swing.JTextField currentUsrTextField;
    private javax.swing.JComboBox deptCombo;
    private javax.swing.JTextArea descriptionArea;
    private javax.swing.Box.Filler filler1;
    private javax.swing.JTextField floorTextField;
    private javax.swing.JButton jButton1;
    private javax.swing.JButton jButton4;
    private javax.swing.JButton jButton5;
    private javax.swing.JLabel jLabel10;
    private javax.swing.JLabel jLabel16;
    private javax.swing.JLabel jLabel161;
    private javax.swing.JLabel jLabel164;
    private javax.swing.JLabel jLabel8;
    private javax.swing.JLabel jLabel81;
    private javax.swing.JLabel jLabel82;
    private javax.swing.JLabel jLabel83;
    private javax.swing.JLabel jLabel9;
    private javax.swing.JPanel jPanel11;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JPanel jPanel4;
    private javax.swing.JPanel jPanel5;
    private javax.swing.JPanel jPanel6;
    private javax.swing.JPanel jPanel7;
    private javax.swing.JScrollPane jScrollPane2;
    private javax.swing.JTextField phoneTextField;
    private javax.swing.JTextField roomTextField;
    private javax.swing.JTextField subjectTextField;
    private javax.swing.JComboBox urgencyCombo;
    // End of variables declaration//GEN-END:variables
}
