/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */

package com.afrisoftech.theater;

import java.util.Vector;
import java.util.logging.Level;
import javax.swing.JOptionPane;
import javax.swing.JPanel;

/**
 *
 * @author MUGISPL
 */
public class InteroperativeSupplypnl extends javax.swing.JPanel {

    /**
     * Creates new form InteroperativeSupplypnl
     */
    java.sql.Connection connectDB = null;
    Vector details = new Vector();
    
    org.netbeans.lib.sql.pool.PooledConnectionSource pConnDB = null;
    private JPanel jpaneltoload1;
    public InteroperativeSupplypnl(java.sql.Connection connDb, org.netbeans.lib.sql.pool.PooledConnectionSource pconnDB,Vector patDetails) {

        details=patDetails;

        connectDB = connDb;

        pConnDB = pconnDB;
        initComponents();
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {
        java.awt.GridBagConstraints gridBagConstraints;

        jPanel75 = new javax.swing.JPanel();
        jPanel76 = new javax.swing.JPanel();
        jLabel176 = new javax.swing.JLabel();
        jTextField46 = new javax.swing.JTextField();
        jLabel177 = new javax.swing.JLabel();
        jTextField47 = new javax.swing.JTextField();
        jLabel178 = new javax.swing.JLabel();
        jTextField64 = new javax.swing.JTextField();
        jLabel179 = new javax.swing.JLabel();
        jTextField65 = new javax.swing.JTextField();
        jLabel180 = new javax.swing.JLabel();
        jTextField66 = new javax.swing.JTextField();
        jLabel181 = new javax.swing.JLabel();
        jTextField67 = new javax.swing.JTextField();
        jLabel182 = new javax.swing.JLabel();
        jTextField68 = new javax.swing.JTextField();
        jSeparator9 = new javax.swing.JSeparator();
        jPanel77 = new javax.swing.JPanel();
        jButton17 = new javax.swing.JButton();
        jButton18 = new javax.swing.JButton();
        jButton19 = new javax.swing.JButton();
        jButton20 = new javax.swing.JButton();
        jPanel78 = new javax.swing.JPanel();
        jScrollPane20 = new javax.swing.JScrollPane();
        jTable10 = new javax.swing.JTable();
        jScrollPane28 = new javax.swing.JScrollPane();
        jTable9 = new javax.swing.JTable();

        setLayout(new java.awt.GridBagLayout());

        jPanel75.setLayout(new java.awt.GridBagLayout());

        jPanel76.setLayout(new java.awt.GridBagLayout());

        jLabel176.setText("Surgeon");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 0.2;
        jPanel76.add(jLabel176, gridBagConstraints);

        jTextField46.setText(NursingTheatre.surgeon);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 0.2;
        jPanel76.add(jTextField46, gridBagConstraints);

        jLabel177.setText("Assistant Surgeon");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 0.2;
        jPanel76.add(jLabel177, gridBagConstraints);

        jTextField47.setText(NursingTheatre.assistant_surgeon);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 0.2;
        jPanel76.add(jTextField47, gridBagConstraints);

        jLabel178.setText("Scrub Nurse");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 0.2;
        jPanel76.add(jLabel178, gridBagConstraints);

        jTextField64.setText(NursingTheatre.scrub_nurse);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 0.2;
        jPanel76.add(jTextField64, gridBagConstraints);

        jLabel179.setText("Circulating Nurse");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 0.2;
        jPanel76.add(jLabel179, gridBagConstraints);

        jTextField65.setText(NursingTheatre.nurses);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 0.2;
        jPanel76.add(jTextField65, gridBagConstraints);

        jLabel180.setText("Time Started");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 0.2;
        jPanel76.add(jLabel180, gridBagConstraints);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 3;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 0.2;
        jPanel76.add(jTextField66, gridBagConstraints);

        jLabel181.setText("Time Ended");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 4;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 0.2;
        jPanel76.add(jLabel181, gridBagConstraints);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 5;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 0.2;
        jPanel76.add(jTextField67, gridBagConstraints);

        jLabel182.setText("Sets Used");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 2;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 0.2;
        jPanel76.add(jLabel182, gridBagConstraints);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 2;
        gridBagConstraints.gridwidth = 2;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 0.2;
        jPanel76.add(jTextField68, gridBagConstraints);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 3;
        gridBagConstraints.gridwidth = 6;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 0.2;
        jPanel76.add(jSeparator9, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.gridwidth = 5;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(2, 2, 2, 2);
        jPanel75.add(jPanel76, gridBagConstraints);

        jPanel77.setLayout(new java.awt.GridBagLayout());

        jButton17.setText("Save");
        jButton17.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton17ActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel77.add(jButton17, gridBagConstraints);

        jButton18.setText("Save & Print");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel77.add(jButton18, gridBagConstraints);

        jButton19.setText("Clear");
        jButton19.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton19ActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 3;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel77.add(jButton19, gridBagConstraints);

        jButton20.setText("Cancel");
        jButton20.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton20ActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 4;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel77.add(jButton20, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 5;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.gridwidth = 2;
        gridBagConstraints.gridheight = 2;
        gridBagConstraints.fill = java.awt.GridBagConstraints.VERTICAL;
        gridBagConstraints.weighty = 1.0;
        jPanel75.add(jPanel77, gridBagConstraints);

        jPanel78.setLayout(new java.awt.GridBagLayout());

        jTable10.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null}
            },
            new String [] {
                "Count", "Plain gauze", "Raytec Gauze", "Brain Swabs", "Tonsil Swabs", "Throat swabs", "Pled Gets", "Epidermis Needles", "Suture Needles", "Surgical Blades", "Others"
            }
        ) {
            Class[] types = new Class [] {
                java.lang.Boolean.class, java.lang.Object.class, java.lang.Object.class, java.lang.Object.class, java.lang.Object.class, java.lang.Object.class, java.lang.Object.class, java.lang.Object.class, java.lang.Object.class, java.lang.Object.class, java.lang.Object.class
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }
        });
        jScrollPane20.setViewportView(jTable10);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.gridwidth = 6;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 6.0;
        jPanel78.add(jScrollPane20, gridBagConstraints);

        jTable9.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "GAUZE/SWABS", "SHARPS", "OTHERS"
            }
        ));
        jScrollPane28.setViewportView(jTable9);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.gridwidth = 6;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        jPanel78.add(jScrollPane28, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.gridwidth = 5;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel75.add(jPanel78, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        add(jPanel75, gridBagConstraints);
    }// </editor-fold>//GEN-END:initComponents

    private void jButton17ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton17ActionPerformed
         if(details.isEmpty()==false){

            try {  connectDB.setAutoCommit(false);
                for(int j=0;j<jTable10.getModel().getRowCount();j++){
                    if(Boolean.valueOf(String.valueOf(jTable10.getModel().getValueAt(j,0)))==true){

              
                java.sql.PreparedStatement pstmt = connectDB.prepareStatement(""
                    + "INSERT INTO nursing.interoperatives(" +
"            patient_no, visit_id, surgeon, assistant_surgeon, scrub_nurse," +
"            circulation_nurse, time_started, time_ended, sets_used, plain_gauze, " +
"            raytec_gauze, brain_swabs, tonsil_swabs, throat_swabs, pled_gets," +
"            epidermis_needles, suture_needles, surgical_blades, others, date," +
"            user_name, time_entered,booking_no)" +
"    VALUES (?, ?, ?, ?, ?,?, ?, ?, ?, ?,?, ?, ?, ?, ?,?, ?, ?, ?, ?::date,?, ?::time,?);");
                pstmt.setObject(1, details.elementAt(0));
                pstmt.setObject(2,details.elementAt(1));
                pstmt.setObject(3, jTextField46.getText().toUpperCase());
                pstmt.setObject(4, jTextField47.getText().toUpperCase());
                pstmt.setObject(5,jTextField64.getText().toUpperCase());
                pstmt.setObject(6, jTextField65.getText().toUpperCase());
                pstmt.setObject(7,jTextField66.getText().toUpperCase());
                pstmt.setObject(8,jTextField67.getText().toUpperCase());
                pstmt.setObject(9, jTextField68.getText().toUpperCase());
                pstmt.setObject(10,jTable10.getModel().getValueAt(j, 0) );
                 pstmt.setObject(11,jTable10.getModel().getValueAt(j, 1) );
                 pstmt.setObject(12,jTable10.getModel().getValueAt(j, 2) );
                 pstmt.setObject(13,jTable10.getModel().getValueAt(j, 3) );
                 pstmt.setObject(14,jTable10.getModel().getValueAt(j, 4) );
                 pstmt.setObject(15,jTable10.getModel().getValueAt(j, 5) );
                 pstmt.setObject(16,jTable10.getModel().getValueAt(j, 6) );
                 pstmt.setObject(17,jTable10.getModel().getValueAt(j, 7) );
                 pstmt.setObject(18,jTable10.getModel().getValueAt(j, 8) );
                 pstmt.setObject(19,jTable10.getModel().getValueAt(j, 9) );
                pstmt.setObject(20,details.elementAt(2));
                 pstmt.setObject(21,details.elementAt(3));
                  pstmt.setObject(22,details.elementAt(4));
                  pstmt.setObject(23,details.elementAt(5));
                
                pstmt.executeUpdate();
                }
                }
                 connectDB.commit();
                    connectDB.setAutoCommit(true);
                jButton19.doClick();

                JOptionPane.showMessageDialog(null,"Data Saved successfully.\n Nice Time.");

            }
            catch(Exception anaesthetic){
                 try {
                        connectDB.rollback();
                    } catch (java.sql.SQLException sql) {
                        javax.swing.JOptionPane.showMessageDialog(this, sql.getMessage(), "Error Message!", javax.swing.JOptionPane.ERROR_MESSAGE);
                    }
                java.util.logging.Logger.getLogger(Implantformpnl.class.getName()).log(Level.SEVERE,null,anaesthetic);
                JOptionPane.showMessageDialog(null,"Data not Saved .\nTry Again ");

            }
        }else
        {
            JOptionPane.showMessageDialog(null,"Please ensure you select patient No and Date first.\n& CONTINUE");

        }
         
           jButton19.doClick();
    }//GEN-LAST:event_jButton17ActionPerformed

    private void jButton19ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton19ActionPerformed
       jTextField46.setText(null);
       jTextField47.setText(null);
       jTextField64.setText(null);
       jTextField65.setText(null);
       jTextField66.setText(null);
       jTextField67.setText(null);
       jTextField68.setText(null);
        for(int j=0;j<jTable10.getModel().getRowCount();j++){
                for(int i=0;i<10;i++){
               jTable10.getModel().setValueAt(null,j, i) ;
                }
        }
    }//GEN-LAST:event_jButton19ActionPerformed

    private void jButton20ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton20ActionPerformed
      jpaneltoload1= new JPanel();
           jpaneltoload1 = (JPanel)new CancelTheatre();
              this.removeAll();
                this.setLayout(new java.awt.BorderLayout());
                this.add(jpaneltoload1, java.awt.BorderLayout.CENTER);
                  this.updateUI();
    }//GEN-LAST:event_jButton20ActionPerformed


    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton jButton17;
    private javax.swing.JButton jButton18;
    private javax.swing.JButton jButton19;
    private javax.swing.JButton jButton20;
    private javax.swing.JLabel jLabel176;
    private javax.swing.JLabel jLabel177;
    private javax.swing.JLabel jLabel178;
    private javax.swing.JLabel jLabel179;
    private javax.swing.JLabel jLabel180;
    private javax.swing.JLabel jLabel181;
    private javax.swing.JLabel jLabel182;
    private javax.swing.JPanel jPanel75;
    private javax.swing.JPanel jPanel76;
    private javax.swing.JPanel jPanel77;
    private javax.swing.JPanel jPanel78;
    private javax.swing.JScrollPane jScrollPane20;
    private javax.swing.JScrollPane jScrollPane28;
    private javax.swing.JSeparator jSeparator9;
    private javax.swing.JTable jTable10;
    private javax.swing.JTable jTable9;
    private javax.swing.JTextField jTextField46;
    private javax.swing.JTextField jTextField47;
    private javax.swing.JTextField jTextField64;
    private javax.swing.JTextField jTextField65;
    private javax.swing.JTextField jTextField66;
    private javax.swing.JTextField jTextField67;
    private javax.swing.JTextField jTextField68;
    // End of variables declaration//GEN-END:variables
}
