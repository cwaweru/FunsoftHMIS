/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */

package com.afrisoftech.theater;

import java.util.Vector;
import java.util.logging.Level;
import javax.swing.JOptionPane;
import javax.swing.JPanel;

/**
 *
 * @author MUGISPL
 */
public class Implantformpnl extends javax.swing.JPanel {

    /**
     * Creates new form Implantformpnl
     */
    java.sql.Connection connectDB = null;
    Vector details = new Vector();
    javax.swing.JPanel jpaneltoload1=null;
    
    org.netbeans.lib.sql.pool.PooledConnectionSource pConnDB = null;
    public Implantformpnl(java.sql.Connection connDb, org.netbeans.lib.sql.pool.PooledConnectionSource pconnDB,Vector patDetails) {

        details=patDetails;
        connectDB = connDb;

        pConnDB = pconnDB;
        initComponents();
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {
        java.awt.GridBagConstraints gridBagConstraints;

        jPanel94 = new javax.swing.JPanel();
        jPanel95 = new javax.swing.JPanel();
        jLabel262 = new javax.swing.JLabel();
        jTextField107 = new javax.swing.JTextField();
        jLabel263 = new javax.swing.JLabel();
        jTextField108 = new javax.swing.JTextField();
        jLabel264 = new javax.swing.JLabel();
        jTextField109 = new javax.swing.JTextField();
        jLabel265 = new javax.swing.JLabel();
        jTextField110 = new javax.swing.JTextField();
        jPanel96 = new javax.swing.JPanel();
        jScrollPane36 = new javax.swing.JScrollPane();
        jTable10 = new com.afrisoftech.dbadmin.JTable();
        jPanel3 = new javax.swing.JPanel();
        postbtn = new javax.swing.JButton();
        resetbtn = new javax.swing.JButton();
        cancelbtn = new javax.swing.JButton();
        exitbtn = new javax.swing.JButton();
        jLabel5 = new javax.swing.JLabel();

        setLayout(new java.awt.GridBagLayout());

        jPanel94.setLayout(new java.awt.GridBagLayout());

        jPanel95.setBorder(javax.swing.BorderFactory.createTitledBorder("IMPLANT STAFF"));
        jPanel95.setLayout(new java.awt.GridBagLayout());

        jLabel262.setText("SURGEON");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel95.add(jLabel262, gridBagConstraints);

        jTextField107.setText(NursingTheatre.surgeon);
        jTextField107.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jTextField107ActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel95.add(jTextField107, gridBagConstraints);

        jLabel263.setText("SCRUB NURSE");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel95.add(jLabel263, gridBagConstraints);

        jTextField108.setText(NursingTheatre.scrub_nurse);
        jTextField108.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jTextField108ActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel95.add(jTextField108, gridBagConstraints);

        jLabel264.setText("TSSU Staff In Theatre Sluice");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 4;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel95.add(jLabel264, gridBagConstraints);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 5;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel95.add(jTextField109, gridBagConstraints);

        jLabel265.setText("Receiving Staff in Theatre Sluice");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 4;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel95.add(jLabel265, gridBagConstraints);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 5;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel95.add(jTextField110, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.gridwidth = 5;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.weightx = 1.0;
        jPanel94.add(jPanel95, gridBagConstraints);

        jPanel96.setBorder(javax.swing.BorderFactory.createTitledBorder("ITEMS USED"));
        jPanel96.setLayout(new java.awt.GridBagLayout());

        jTable10.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {"Screw", null, null},
                {"Plates", null, null},
                {"Pins", null, null},
                {"Wires", null, null},
                {"Nails", null, null},
                {"Rods", null, null},
                {"Spinal Implants", null, null},
                {"Clamps", null, null},
                {"Sets Used", null, null},
                {"Drill Used", null, null}
            },
            new String [] {
                "Type", "Size", "No. Used"
            }
        ) {
            boolean[] canEdit = new boolean [] {
                false, true, true
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        jScrollPane36.setViewportView(jTable10);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.gridheight = 4;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel96.add(jScrollPane36, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.gridheight = 4;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel94.add(jPanel96, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        add(jPanel94, gridBagConstraints);

        jPanel3.setBorder(javax.swing.BorderFactory.createEtchedBorder());
        jPanel3.setLayout(new java.awt.GridBagLayout());

        postbtn.setMnemonic('s');
        postbtn.setText("Save");
        postbtn.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                postbtnActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel3.add(postbtn, gridBagConstraints);

        resetbtn.setText("Save & Print");
        resetbtn.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                resetbtnActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel3.add(resetbtn, gridBagConstraints);

        cancelbtn.setMnemonic('l');
        cancelbtn.setText("Clear");
        cancelbtn.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cancelbtnActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 3;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel3.add(cancelbtn, gridBagConstraints);

        exitbtn.setMnemonic('c');
        exitbtn.setText("Close");
        exitbtn.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                exitbtnActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 4;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel3.add(exitbtn, gridBagConstraints);

        jLabel5.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridwidth = 4;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        jPanel3.add(jLabel5, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 0.2;
        add(jPanel3, gridBagConstraints);
    }// </editor-fold>//GEN-END:initComponents

    private void jTextField107ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jTextField107ActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_jTextField107ActionPerformed

    private void jTextField108ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jTextField108ActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_jTextField108ActionPerformed

    private void postbtnActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_postbtnActionPerformed
        if(details.isEmpty()==false){

            try {

                connectDB.setAutoCommit(false);
                java.sql.PreparedStatement pstmt = connectDB.prepareStatement(""
                    + "INSERT INTO nursing.implant(" +
"            patient_no, visit_id, surgeon, scrub_nurse, tssu_staff, receiving_staff, " +
"            screwsize, no_screw, plates, no_plates, pins, no_pins, wires, " +
"            no_wires, nails, no_nails, rods, no_rods, spinal_implants, no_spinal_implants," +
"            clamps, no_clamps, sets_used, no_sets_used, drill_used, no_drill_used," +
"            date, user_name, time_entered,booking_no)" +
"    VALUES (?, ?, ?, ?, ?, ?,?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?::date, ?, ?::time,?);");
                pstmt.setObject(1, details.elementAt(0));
                pstmt.setObject(2,details.elementAt(1));
                pstmt.setObject(3, jTextField107.getText().toUpperCase());
                pstmt.setObject(4, jTextField109.getText().toUpperCase());
                pstmt.setObject(5,jTextField108.getText().toUpperCase());
                pstmt.setObject(6, jTextField110.getText().toUpperCase());
                pstmt.setObject(7,jTable10.getModel().getValueAt(0, 1));
                pstmt.setObject(8,jTable10.getModel().getValueAt(0, 2));
                pstmt.setObject(9, jTable10.getModel().getValueAt(1, 1));
                pstmt.setObject(10,jTable10.getModel().getValueAt(1, 2) );
                pstmt.setObject(11,jTable10.getModel().getValueAt(2, 1));
                pstmt.setObject(12,jTable10.getModel().getValueAt(2, 2));
                pstmt.setObject(13, jTable10.getModel().getValueAt(3, 1));
                pstmt.setObject(14,jTable10.getModel().getValueAt(3, 2));
                pstmt.setObject(15,jTable10.getModel().getValueAt(4, 1));
                 pstmt.setObject(16,jTable10.getModel().getValueAt(4, 2));
                  pstmt.setObject(17,jTable10.getModel().getValueAt(5, 1));
                 pstmt.setObject(18,jTable10.getModel().getValueAt(5, 2));
                  pstmt.setObject(19,jTable10.getModel().getValueAt(6, 1));
                 pstmt.setObject(20,jTable10.getModel().getValueAt(6, 2));
                  pstmt.setObject(21,jTable10.getModel().getValueAt(7, 1));
                 pstmt.setObject(22,jTable10.getModel().getValueAt(7, 2));
                  pstmt.setObject(23,jTable10.getModel().getValueAt(8, 1));
                 pstmt.setObject(24,jTable10.getModel().getValueAt(8, 2));
                  pstmt.setObject(25,jTable10.getModel().getValueAt(9, 1));
                 pstmt.setObject(26,jTable10.getModel().getValueAt(9, 2));
                  pstmt.setObject(27,details.elementAt(2));
                 pstmt.setObject(28,details.elementAt(3));
                  pstmt.setObject(29,details.elementAt(4));
                   pstmt.setObject(30,details.elementAt(5));
                
                pstmt.executeUpdate();
                 connectDB.commit();
                    connectDB.setAutoCommit(true);

                cancelbtn.doClick();

                JOptionPane.showMessageDialog(null,"Data Saved successfully.\n Nice Time.");

            }
            catch(Exception anaesthetic){
                 try {
                        connectDB.rollback();
                    } catch (java.sql.SQLException sql) {
                        javax.swing.JOptionPane.showMessageDialog(this, sql.getMessage(), "Error Message!", javax.swing.JOptionPane.ERROR_MESSAGE);
                    }
                java.util.logging.Logger.getLogger(Implantformpnl.class.getName()).log(Level.SEVERE,null,anaesthetic);
                JOptionPane.showMessageDialog(null,"Data not Saved .\nTry Again ");

            }
        }else
        {
            JOptionPane.showMessageDialog(null,"Please ensure yo select patient No and Date first.\n& CONTINUE");

        }

    }//GEN-LAST:event_postbtnActionPerformed

    private void resetbtnActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_resetbtnActionPerformed
        postbtn.doClick();
        cancelbtn.doClick();
    }//GEN-LAST:event_resetbtnActionPerformed

    private void cancelbtnActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cancelbtnActionPerformed
        jTextField107.setText(null);
        jTextField109.setText(null);
        jTextField108.setText(null);
        jTextField110.setText(null);
        for(int i=0;i<jTable10.getModel().getRowCount();i++){
            jTable10.getModel().setValueAt(null, i, 1);
             jTable10.getModel().setValueAt(null, i, 2);
        }
    }//GEN-LAST:event_cancelbtnActionPerformed

    private void exitbtnActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_exitbtnActionPerformed
       jpaneltoload1= new JPanel();
           jpaneltoload1 = (JPanel)new CancelTheatre();
              this.removeAll();
                this.setLayout(new java.awt.BorderLayout());
                this.add(jpaneltoload1, java.awt.BorderLayout.CENTER);
                  this.updateUI();
    }//GEN-LAST:event_exitbtnActionPerformed


    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton cancelbtn;
    public static javax.swing.JButton exitbtn;
    private javax.swing.JLabel jLabel262;
    private javax.swing.JLabel jLabel263;
    private javax.swing.JLabel jLabel264;
    private javax.swing.JLabel jLabel265;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JPanel jPanel94;
    private javax.swing.JPanel jPanel95;
    private javax.swing.JPanel jPanel96;
    private javax.swing.JScrollPane jScrollPane36;
    private javax.swing.JTable jTable10;
    private javax.swing.JTextField jTextField107;
    private javax.swing.JTextField jTextField108;
    private javax.swing.JTextField jTextField109;
    private javax.swing.JTextField jTextField110;
    private javax.swing.JButton postbtn;
    private javax.swing.JButton resetbtn;
    // End of variables declaration//GEN-END:variables
}
