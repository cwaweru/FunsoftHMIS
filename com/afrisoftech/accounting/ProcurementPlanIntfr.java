/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */
package com.afrisoftech.accounting;

import java.sql.SQLException;
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.Locale;
import java.util.logging.Level;
import java.util.logging.Logger;

/**
 *
 * @author SPL7
 */
public class ProcurementPlanIntfr extends javax.swing.JInternalFrame {

    java.sql.Connection connectDB = null;
    double totalSum = 0.00;

    /**
     * Creates new form ProcurementPlanIntfr
     */
    public ProcurementPlanIntfr(java.sql.Connection connDB) {

        connectDB = connDB;

        initComponents();
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {
        java.awt.GridBagConstraints gridBagConstraints;

        jSearchDialog4 = new javax.swing.JDialog();
        jSearchPanel4 = new javax.swing.JPanel();
        jTextField14 = new javax.swing.JTextField();
        jSearchScrollPane4 = new javax.swing.JScrollPane();
        jSearchTable4 = new com.afrisoftech.dbadmin.JTable();
        jButton10 = new javax.swing.JButton();
        actionsPanel = new javax.swing.JPanel();
        saveBtn = new javax.swing.JButton();
        editBtn = new javax.swing.JButton();
        removeRowBtn = new javax.swing.JButton();
        clearFormBtn = new javax.swing.JButton();
        spacerLbl = new javax.swing.JLabel();
        closeFormBtn = new javax.swing.JButton();
        mainPanel = new javax.swing.JPanel();
        headerPanel = new javax.swing.JPanel();
        financialPeriodlbl = new javax.swing.JLabel();
        departmentLbl = new javax.swing.JLabel();
        voteLbl = new javax.swing.JLabel();
        financialPeriodCmbx = new javax.swing.JComboBox();
        departmentCmbx = new javax.swing.JComboBox();
        voteCmbx = new javax.swing.JComboBox();
        voteAmountLbl = new javax.swing.JLabel();
        voteAmountTxt = new javax.swing.JTextField();
        bodyPanel = new javax.swing.JPanel();
        jScrollPane1 = new javax.swing.JScrollPane();
        procurementPlanTbl = new javax.swing.JTable();

        jSearchDialog4.setUndecorated(true);
        jSearchDialog4.getContentPane().setLayout(new java.awt.GridBagLayout());

        jSearchPanel4.setBorder(javax.swing.BorderFactory.createEtchedBorder());
        jSearchPanel4.setLayout(new java.awt.GridBagLayout());

        jTextField14.addCaretListener(new javax.swing.event.CaretListener() {
            public void caretUpdate(javax.swing.event.CaretEvent evt) {
                jTextField14CaretUpdate(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 10.0;
        gridBagConstraints.weighty = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 100);
        jSearchPanel4.add(jTextField14, gridBagConstraints);

        jSearchScrollPane4.setDoubleBuffered(true);

        jSearchTable4.setDoubleBuffered(true);
        jSearchTable4.setShowHorizontalLines(false);
        /*    try {
            searchRowSet.setCommand("select product,selling_price,gl_code FROM st_stock_prices WHERE department = 'Pharmacy' order by product");
            searchRowSet.setConnectionSource(pConnDB);

            searchRowSet.execute();

            // crset2.setExecuteOnLoad(true);
            jSearchTable.setModel(new org.netbeans.lib.sql.models.TableModel(searchRowSet, new org.netbeans.lib.sql.models.TableModel.Column[] {
                new org.netbeans.lib.sql.models.TableModel.Column("product", "Description", false),
                new org.netbeans.lib.sql.models.TableModel.Column("selling_price", "Amount", false),
                new org.netbeans.lib.sql.models.TableModel.Column("gl_code", "Gl_code", false)

            }));
            // jSearchScrollPane.setViewportView(jSearchTable);

        } catch(java.sql.SQLException sqlex){
            javax.swing.JOptionPane.showMessageDialog(this,sqlex.getMessage(),"Error Message!",javax.swing.JOptionPane.ERROR_MESSAGE);

            System.out.println(sqlex.getMessage());
        }
        */
        jSearchTable4.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                jSearchTable4MouseClicked(evt);
            }
        });
        jSearchScrollPane4.setViewportView(jSearchTable4);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.gridwidth = 2;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 20.0;
        jSearchPanel4.add(jSearchScrollPane4, gridBagConstraints);

        jButton10.setText("Dispose");
        jButton10.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton10ActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jSearchPanel4.add(jButton10, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jSearchDialog4.getContentPane().add(jSearchPanel4, gridBagConstraints);

        setClosable(true);
        setIconifiable(true);
        setMaximizable(true);
        setResizable(true);
        setTitle("Form for building the procurement plan");
        setVisible(true);
        getContentPane().setLayout(new java.awt.GridBagLayout());

        actionsPanel.setLayout(new java.awt.GridBagLayout());

        saveBtn.setText("Save procurement plan data");
        saveBtn.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                saveBtnActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        actionsPanel.add(saveBtn, gridBagConstraints);

        editBtn.setText("Edit data");
        editBtn.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                editBtnActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        actionsPanel.add(editBtn, gridBagConstraints);

        removeRowBtn.setText("Remove row");
        removeRowBtn.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                removeRowBtnActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 3;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        actionsPanel.add(removeRowBtn, gridBagConstraints);

        clearFormBtn.setText("Clear form");
        clearFormBtn.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                clearFormBtnActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 4;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        actionsPanel.add(clearFormBtn, gridBagConstraints);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 100.0;
        gridBagConstraints.weighty = 1.0;
        actionsPanel.add(spacerLbl, gridBagConstraints);

        closeFormBtn.setText("Close form");
        closeFormBtn.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                closeFormBtnActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 5;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        actionsPanel.add(closeFormBtn, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        getContentPane().add(actionsPanel, gridBagConstraints);

        mainPanel.setLayout(new java.awt.GridBagLayout());

        headerPanel.setLayout(new java.awt.GridBagLayout());

        financialPeriodlbl.setText("Financial Period");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        headerPanel.add(financialPeriodlbl, gridBagConstraints);

        departmentLbl.setText("Department");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        headerPanel.add(departmentLbl, gridBagConstraints);

        voteLbl.setText("Vote");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 4;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        headerPanel.add(voteLbl, gridBagConstraints);

        financialPeriodCmbx.setModel(com.afrisoftech.lib.ComboBoxModel.ComboBoxModel(connectDB, "select distinct financial_year FROM ac_aie_allocation ORDER BY 1 ASC"));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        headerPanel.add(financialPeriodCmbx, gridBagConstraints);

        departmentCmbx.setModel(com.afrisoftech.lib.ComboBoxModel.ComboBoxModel(connectDB, "SELECT department_desc FROM vote_departments order by department_desc"));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 3;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        headerPanel.add(departmentCmbx, gridBagConstraints);

        voteCmbx.setModel(com.afrisoftech.lib.ComboBoxModel.ComboBoxModel(connectDB, "SELECT subhead||'-'||subitem as vote FROM ac_aie_allocation order by vote"));
        voteCmbx.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                voteCmbxActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 5;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        headerPanel.add(voteCmbx, gridBagConstraints);

        voteAmountLbl.setText("Vote Amount");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        headerPanel.add(voteAmountLbl, gridBagConstraints);

        voteAmountTxt.setEditable(false);
        voteAmountTxt.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                voteAmountTxtActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        headerPanel.add(voteAmountTxt, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 20.0;
        mainPanel.add(headerPanel, gridBagConstraints);

        bodyPanel.setLayout(new java.awt.GridBagLayout());

        procurementPlanTbl.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null, null, null, null, null, null}
            },
            new String [] {
                "Item Description", "Qty", "Est. Unit Cost", "Est. Total Cost", "Proc. Method", "Bidding Doc Date", "Sale Bidding Doc", "Open Bids Date", "Bid Eval. Date", "Proc/Tender Cmte. Action Date", "Order Draw Date", "Contract Sign Date", "Comp. Delivery/Service Date"
            }
        ) {
            Class[] types = new Class [] {
                java.lang.Object.class, java.lang.Float.class, java.lang.Double.class, java.lang.Double.class, java.lang.Object.class, java.lang.Object.class, java.lang.Object.class, java.lang.Object.class, java.lang.Object.class, java.lang.Object.class, java.lang.Object.class, java.lang.Object.class, java.lang.Object.class
            };
            boolean[] canEdit = new boolean [] {
                true, true, true, false, true, true, true, true, true, true, true, true, true
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        this.procurementPlanTbl.getColumnModel().getColumn(4).setCellEditor(new javax.swing.DefaultCellEditor(new javax.swing.JComboBox(com.afrisoftech.lib.ComboBoxModel.ComboBoxModel(connectDB, "SELECT DISTINCT method_desc FROM st_procurement_method"))));
        for (int i = 5 ; i < 13; i++){
            javax.swing.table.TableColumn ccDateEditorw = procurementPlanTbl.getColumnModel().getColumn(i);
            com.afrisoftech.lib.DateCellEditor ccDateCellEditorw = new com.afrisoftech.lib.DateCellEditor(new com.afrisoftech.lib.DatePicker(), procurementPlanTbl);
            ccDateEditorw.setCellEditor(ccDateCellEditorw);
            //jTable1.setRowHeight(30);
            javax.swing.table.DefaultTableCellRenderer ccCellRendererw = new javax.swing.table.DefaultTableCellRenderer();
            ccCellRendererw.setHorizontalAlignment(ccCellRendererw.TRAILING);
            ccDateEditorw.setCellRenderer(ccCellRendererw);
            //this.procurementPlanTbl.getColumnModel().getColumn(i).setCellEditor(new javax.swing.DefaultCellEditor((javax.swing.JComboBox)new com.afrisoftech.lib.DatePicker()));
        }

        javax.swing.table.TableColumn column = null;
        for (int i = 0; i < 13; i++) {
            column = procurementPlanTbl.getColumnModel().getColumn(i);
            if (i == 0) {

                column.setPreferredWidth(500); //sport column is bigger
            } else {
                //if (i == 2) {
                    column.setPreferredWidth(200);
                    // }  else
                //column.setPreferredWidth(50);

            }
        }

        procurementPlanTbl.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                procurementPlanTblMouseClicked(evt);
            }
        });
        procurementPlanTbl.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                procurementPlanTblKeyReleased(evt);
            }
        });
        jScrollPane1.setViewportView(procurementPlanTbl);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.ipadx = 429;
        gridBagConstraints.ipady = 257;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        bodyPanel.add(jScrollPane1, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 500.0;
        mainPanel.add(bodyPanel, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 500.0;
        getContentPane().add(mainPanel, gridBagConstraints);

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void editBtnActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_editBtnActionPerformed
        saveBtn.setText("Update");
        procurementPlanTbl.setModel(com.afrisoftech.dbadmin.TableModel.createTableVectors(connectDB, "SELECT * FROM st_procurement_plan WHERE vote_no = '" + voteCmbx.getSelectedItem().toString() + "' AND financial_year = '" + financialPeriodCmbx.getSelectedItem().toString() + "'"));

        // TODO add your handling code here:
    }//GEN-LAST:event_editBtnActionPerformed

    private void closeFormBtnActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_closeFormBtnActionPerformed

        this.setVisible(false);

        // TODO add your handling code here:
    }//GEN-LAST:event_closeFormBtnActionPerformed

    private void clearFormBtnActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_clearFormBtnActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_clearFormBtnActionPerformed

    private void removeRowBtnActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_removeRowBtnActionPerformed

        javax.swing.table.DefaultTableModel procTable = (javax.swing.table.DefaultTableModel) procurementPlanTbl.getModel();

        procTable.removeRow(this.procurementPlanTbl.getSelectedRow());

        // TODO add your handling code here:
    }//GEN-LAST:event_removeRowBtnActionPerformed

    private void jTextField14CaretUpdate(javax.swing.event.CaretEvent evt) {//GEN-FIRST:event_jTextField14CaretUpdate

        if (jTextField14.getCaretPosition() < 1) {

            System.out.println("Nothing");
        } else {
            jSearchTable4.setModel(com.afrisoftech.dbadmin.TableModel.createTableVectors(connectDB, "SELECT DISTINCT item_code, description, sub_cat_code as category, department FROM st_stock_item where description ilike '%" + jTextField14.getText().toString() + "%' order by description"));

            // jSearchTable4.setModel(com.afrisoftech.dbadmin.TableModel.createTableVectors(connectDB,"SELECT service_type,rate as price,'"+jTextField7.getText()+"' as glcode FROM pb_operating_parameters WHERE service_type ILIKE '%"+jTextField14.getText().toString()+"%' AND gl_account ILIKE '%"+jTextField7.getText()+"%'"));

            System.out.println("Cannot sort out");

        }
        //  }

        //
// Add your handling code here:
    }//GEN-LAST:event_jTextField14CaretUpdate

    private void jSearchTable4MouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jSearchTable4MouseClicked

        procurementPlanTbl.setValueAt(jSearchTable4.getValueAt(jSearchTable4.getSelectedRow(), 1), procurementPlanTbl.getSelectedRow(), 0);

        jSearchDialog4.dispose();

        // Add your handling code here:
    }//GEN-LAST:event_jSearchTable4MouseClicked

    private void jButton10ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton10ActionPerformed
        jSearchDialog4.dispose();        // Add your handling code here:
    }//GEN-LAST:event_jButton10ActionPerformed

    private void procurementPlanTblMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_procurementPlanTblMouseClicked
        if (voteAmountTxt.getText().toCharArray().length > 0) {
            if (procurementPlanTbl.getSelectedColumn() == 0) {

                System.out.println("Showing dialog");
                java.awt.Point point = jScrollPane1.getLocationOnScreen();
                jSearchDialog4.setSize(700, 200);
                jSearchDialog4.setLocation(point);
                jSearchDialog4.setVisible(true);
            }
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_procurementPlanTblMouseClicked

    private void procurementPlanTblKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_procurementPlanTblKeyReleased
        //swap to know whether its an update or a new save
        switch (this.saveBtn.getText()) {
            case "Save procurement plan data":
                if (procurementPlanTbl.getValueAt(procurementPlanTbl.getSelectedRow(), 2) != null) {
                    float qty = java.lang.Float.parseFloat(procurementPlanTbl.getValueAt(procurementPlanTbl.getSelectedRow(), 1).toString());
                    float price = java.lang.Float.parseFloat(procurementPlanTbl.getValueAt(procurementPlanTbl.getSelectedRow(), 2).toString());
                    System.out.println("This is the price " + price);
                    float total = (qty * price);
                    procurementPlanTbl.setValueAt(total, procurementPlanTbl.getSelectedRow(), 3);
                    totalSum = com.afrisoftech.lib.TableColumnTotal.getTableColumnTotal(procurementPlanTbl, 3);
                    if (totalSum > Double.parseDouble(voteAmountTxt.getText())) {
                        javax.swing.JOptionPane.showMessageDialog(this, "CAUTION! You MUST ensure that your plan total is not more than allocated vote.");
                    }
                }
                break;

            case "Update":
                if (procurementPlanTbl.getValueAt(procurementPlanTbl.getSelectedRow(), 3) != null) {
                    float qty = java.lang.Float.parseFloat(procurementPlanTbl.getValueAt(procurementPlanTbl.getSelectedRow(), 2).toString());
                    float price = java.lang.Float.parseFloat(procurementPlanTbl.getValueAt(procurementPlanTbl.getSelectedRow(), 3).toString());
                    System.out.println("This is the price " + price);
                    double total = (qty * price);
                    procurementPlanTbl.setValueAt(total, procurementPlanTbl.getSelectedRow(), 4);
                    totalSum = com.afrisoftech.lib.TableColumnTotal.getTableColumnTotal(procurementPlanTbl, 4);
                    if (totalSum > Double.parseDouble(voteAmountTxt.getText())) {
                        javax.swing.JOptionPane.showMessageDialog(this, "CAUTION! You MUST ensure that your plan total is not more than allocated vote.");
                    }
                }
                break;
        }//End switch
    }//GEN-LAST:event_procurementPlanTblKeyReleased

    private void voteAmountTxtActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_voteAmountTxtActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_voteAmountTxtActionPerformed

    private void voteCmbxActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_voteCmbxActionPerformed
        try {

            java.sql.PreparedStatement pstmt = connectDB.prepareStatement("SELECT amount FROM ac_aie_allocation WHERE subhead||'-'||subitem = ? AND financial_year = ?");

            pstmt.setString(1, voteCmbx.getSelectedItem().toString());

            pstmt.setString(2, financialPeriodCmbx.getSelectedItem().toString());

            java.sql.ResultSet rset = pstmt.executeQuery();

            if (rset.next()) {
                voteAmountTxt.setText(rset.getString(1));
            }
        } catch (java.sql.SQLException ex) {
            ex.printStackTrace();
            javax.swing.JOptionPane.showMessageDialog(this, ex.getMessage());
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_voteCmbxActionPerformed

    private void saveBtnActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_saveBtnActionPerformed
//swap to know whether its an update or a new save
        if(procurementPlanTbl.isEditing()){
           procurementPlanTbl.getCellEditor().stopCellEditing();
        }
        if (totalSum <= Double.parseDouble(voteAmountTxt.getText())) {
            switch (this.saveBtn.getText()) {
                case "Save procurement plan data":
                    //Lets do a new save
                    saveNewProcurementPlan();
                    this.getContentPane().removeAll();
                    initComponents();
                    this.setSize(this.getParent().getSize());
                    this.validate();
                    break;
                case "Update":
                    updateProcurementPlan();
                    saveBtn.setText("Save procurement plan data");
                    this.getContentPane().removeAll();
                    initComponents();
                    this.setSize(this.getParent().getSize());
                    this.validate();
                    break;
            }
        } else {
            javax.swing.JOptionPane.showMessageDialog(this, "The total for the procurement plan MUST be less or equal to allocated vote amount.");

        }//End switch
    }//GEN-LAST:event_saveBtnActionPerformed
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JPanel actionsPanel;
    private javax.swing.JPanel bodyPanel;
    private javax.swing.JButton clearFormBtn;
    private javax.swing.JButton closeFormBtn;
    private javax.swing.JComboBox departmentCmbx;
    private javax.swing.JLabel departmentLbl;
    private javax.swing.JButton editBtn;
    private javax.swing.JComboBox financialPeriodCmbx;
    private javax.swing.JLabel financialPeriodlbl;
    private javax.swing.JPanel headerPanel;
    private javax.swing.JButton jButton10;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JDialog jSearchDialog4;
    private javax.swing.JPanel jSearchPanel4;
    private javax.swing.JScrollPane jSearchScrollPane4;
    private javax.swing.JTable jSearchTable4;
    private javax.swing.JTextField jTextField14;
    private javax.swing.JPanel mainPanel;
    private javax.swing.JTable procurementPlanTbl;
    private javax.swing.JButton removeRowBtn;
    private javax.swing.JButton saveBtn;
    private javax.swing.JLabel spacerLbl;
    private javax.swing.JLabel voteAmountLbl;
    private javax.swing.JTextField voteAmountTxt;
    private javax.swing.JComboBox voteCmbx;
    private javax.swing.JLabel voteLbl;
    // End of variables declaration//GEN-END:variables

    /**
     * Do a save for a new procurement plan *
     */
    private void saveNewProcurementPlan() {
        try {
            for (int i = 0; i < procurementPlanTbl.getRowCount(); i++) {
                if (procurementPlanTbl.getValueAt(i, 0) != null) {
                    java.sql.PreparedStatement pstmt = connectDB.prepareCall("INSERT INTO st_procurement_plan("
                            + "item_id, item_description, qty, estimated_unit_cost, estimated_total_cost,"
                            + "proc_method, prep_of_bidding_date, sale_of_bidding_doc_date, "
                            + "receipt_open_bids_date, bid_evaluation_date, proc_tender_committee_action_date,"
                            + "order_drawn_date, contract_sign_date, compliance_delivery_date, "
                            + "proc_department, financial_year, vote_no)"
                            + "VALUES (nextval('vote_no_seq'), ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)");

                    pstmt.setObject(1, procurementPlanTbl.getValueAt(i, 0));
                    pstmt.setDouble(2, Double.parseDouble(procurementPlanTbl.getValueAt(i, 1).toString()));
                    pstmt.setDouble(3, Double.parseDouble(procurementPlanTbl.getValueAt(i, 2).toString()));
                    pstmt.setDouble(4, Double.parseDouble(procurementPlanTbl.getValueAt(i, 3).toString()));
                    pstmt.setObject(5, procurementPlanTbl.getValueAt(i, 4).toString());
                    try {
                        pstmt.setDate(6, com.afrisoftech.lib.SQLDateFormat.getSQLDate(new SimpleDateFormat("MMMM d, yyyy", Locale.ENGLISH).parse(procurementPlanTbl.getValueAt(i, 5).toString())));
                        pstmt.setDate(7, com.afrisoftech.lib.SQLDateFormat.getSQLDate(new SimpleDateFormat("MMMM d, yyyy", Locale.ENGLISH).parse(procurementPlanTbl.getValueAt(i, 6).toString())));
                        pstmt.setDate(8, com.afrisoftech.lib.SQLDateFormat.getSQLDate(new SimpleDateFormat("MMMM d, yyyy", Locale.ENGLISH).parse(procurementPlanTbl.getValueAt(i, 7).toString())));
                        pstmt.setDate(9, com.afrisoftech.lib.SQLDateFormat.getSQLDate(new SimpleDateFormat("MMMM d, yyyy", Locale.ENGLISH).parse(procurementPlanTbl.getValueAt(i, 8).toString())));
                        pstmt.setDate(10, com.afrisoftech.lib.SQLDateFormat.getSQLDate(new SimpleDateFormat("MMMM d, yyyy", Locale.ENGLISH).parse(procurementPlanTbl.getValueAt(i, 9).toString())));
                        pstmt.setDate(11, com.afrisoftech.lib.SQLDateFormat.getSQLDate(new SimpleDateFormat("MMMM d, yyyy", Locale.ENGLISH).parse(procurementPlanTbl.getValueAt(i, 10).toString())));
                        pstmt.setDate(12, com.afrisoftech.lib.SQLDateFormat.getSQLDate(new SimpleDateFormat("MMMM d, yyyy", Locale.ENGLISH).parse(procurementPlanTbl.getValueAt(i, 11).toString())));
                        pstmt.setDate(13, com.afrisoftech.lib.SQLDateFormat.getSQLDate(new SimpleDateFormat("MMMM d, yyyy", Locale.ENGLISH).parse(procurementPlanTbl.getValueAt(i, 12).toString())));
                    } catch (ParseException ex) {
                        Logger.getLogger(ProcurementPlanIntfr.class.getName()).log(Level.SEVERE, null, ex);
                    }
                    pstmt.setObject(14, departmentCmbx.getSelectedItem().toString());
                    pstmt.setObject(15, financialPeriodCmbx.getSelectedItem().toString());
                    pstmt.setObject(16, voteCmbx.getSelectedItem().toString());

                    pstmt.execute();
                    // saveBtn.setEnabled(false);
                    javax.swing.JOptionPane.showMessageDialog(this, "Procurement plan data saved successfully.");
                }
            }
        } catch (java.sql.SQLException sqEx) {
            sqEx.printStackTrace();
            javax.swing.JOptionPane.showMessageDialog(this, sqEx.getMessage());
        }
    }//End method saveNewProcurementPlan

    /**
     * update an existing procurement plan *
     */
    private void updateProcurementPlan() {
        try {
            for (int i = 0; i < procurementPlanTbl.getRowCount(); i++) {
                if (procurementPlanTbl.getValueAt(i, 0) != null) {
                    //java.sql.PreparedStatement pstmt = connectDB.prepareCall("UPDATE st_procurement_plan SET qty=?, estimated_unit_cost=?,estimated_total_cost=?, proc_method=?, prep_of_bidding_date=?,sale_of_bidding_doc_date=?, receipt_open_bids_date=?, bid_evaluation_date=?,proc_tender_committee_action_date=?, order_drawn_date=?, contract_sign_date=?,compliance_delivery_date=?, proc_department=?, financial_year=?,vote_no=? WHERE item_id=" + procurementPlanTbl.getValueAt(procurementPlanTbl.getSelectedRow(), 0) + ";");
                    java.sql.PreparedStatement pstmt = connectDB.prepareCall("UPDATE st_procurement_plan SET qty=?, estimated_unit_cost=?,estimated_total_cost=?, proc_method=?, prep_of_bidding_date=?,sale_of_bidding_doc_date=?, receipt_open_bids_date=?, bid_evaluation_date=?,proc_tender_committee_action_date=?, order_drawn_date=?, contract_sign_date=?,compliance_delivery_date=?, proc_department=?, financial_year=?,vote_no=? WHERE item_id='" + procurementPlanTbl.getValueAt(i, 0).toString() + "'");
                    pstmt.setDouble(1, Double.parseDouble(procurementPlanTbl.getValueAt(i, 2).toString()));
                    pstmt.setDouble(2, Double.parseDouble(procurementPlanTbl.getValueAt(i, 3).toString()));
                    pstmt.setDouble(3, Double.parseDouble(procurementPlanTbl.getValueAt(i, 4).toString()));
                    pstmt.setString(4, procurementPlanTbl.getValueAt(i, 5).toString());
                    try {
                        pstmt.setDate(5, com.afrisoftech.lib.SQLDateFormat.getSQLDate(new SimpleDateFormat("yyyy-MM-d", Locale.ENGLISH).parse(procurementPlanTbl.getValueAt(i, 6).toString())));
                        pstmt.setDate(6, com.afrisoftech.lib.SQLDateFormat.getSQLDate(new SimpleDateFormat("yyyy-MM-d", Locale.ENGLISH).parse(procurementPlanTbl.getValueAt(i, 7).toString())));
                        pstmt.setDate(7, com.afrisoftech.lib.SQLDateFormat.getSQLDate(new SimpleDateFormat("yyyy-MM-d", Locale.ENGLISH).parse(procurementPlanTbl.getValueAt(i, 8).toString())));
                        pstmt.setDate(8, com.afrisoftech.lib.SQLDateFormat.getSQLDate(new SimpleDateFormat("yyyy-MM-d", Locale.ENGLISH).parse(procurementPlanTbl.getValueAt(i, 9).toString())));
                        pstmt.setDate(9, com.afrisoftech.lib.SQLDateFormat.getSQLDate(new SimpleDateFormat("yyyy-MM-d", Locale.ENGLISH).parse(procurementPlanTbl.getValueAt(i, 10).toString())));
                        pstmt.setDate(10, com.afrisoftech.lib.SQLDateFormat.getSQLDate(new SimpleDateFormat("yyyy-MM-d", Locale.ENGLISH).parse(procurementPlanTbl.getValueAt(i, 11).toString())));
                        pstmt.setDate(11, com.afrisoftech.lib.SQLDateFormat.getSQLDate(new SimpleDateFormat("yyyy-MM-d", Locale.ENGLISH).parse(procurementPlanTbl.getValueAt(i, 12).toString())));
                        pstmt.setDate(12, com.afrisoftech.lib.SQLDateFormat.getSQLDate(new SimpleDateFormat("yyyy-MM-d", Locale.ENGLISH).parse(procurementPlanTbl.getValueAt(i, 13).toString())));
                    } catch (ParseException ex) {
                        Logger.getLogger(ProcurementPlanIntfr.class.getName()).log(Level.SEVERE, null, ex);
                    }
                    pstmt.setObject(13, departmentCmbx.getSelectedItem().toString());
                    pstmt.setObject(14, financialPeriodCmbx.getSelectedItem().toString());
                    pstmt.setObject(15, voteCmbx.getSelectedItem().toString());

                    pstmt.execute();
                    javax.swing.JOptionPane.showMessageDialog(this, "Procurement plan data updated successfully.");
                }

            }
        } catch (java.sql.SQLException sqEx) {
            sqEx.printStackTrace();
            javax.swing.JOptionPane.showMessageDialog(this, sqEx.getMessage());
        }
        return;
    }//End method updateProcurementPlan
}
