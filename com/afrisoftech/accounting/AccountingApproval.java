/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */

package com.afrisoftech.accounting;

//SELECT DISTINCT dealer as Imprest_Holder,final_voucher_no as voucher_no FROM ac_bills union select distinct payee as Imprest_Holder, requisition_no as voucher_no from ac_petty_cash_requisition WHERE approved = false AND cancelled=false AND examination=false and commited=true and accountant=false and finance_head=false
import static com.afrisoftech.accounting.VoucherApprintfr.requNo;

import javax.swing.JComboBox;
import javax.swing.JOptionPane;

/**
 *
 * @author System Partners
 */
public class AccountingApproval extends javax.swing.JInternalFrame {
JComboBox cmboxs3 = new javax.swing.JComboBox();    /**
     * Creates new form SuppliesGuyApprovalintfr
     */

    /**
     * Creates new form SuppliesGuyApprovalintfr
     */
    java.sql.Connection connectDB = null;
    org.netbeans.lib.sql.pool.PooledConnectionSource pConnDB = null;
      String voucherNo=null, voucherDate=null, vochno=null,decision=null,lpoNo=null;
    private boolean yes;
    private boolean yesI;
    public AccountingApproval(java.sql.Connection connDb, org.netbeans.lib.sql.pool.PooledConnectionSource pconnDB) {

        connectDB = connDb;

        pConnDB = pconnDB;
        initComponents();
        cmboxs3.setModel(com.afrisoftech.lib.ComboBoxModel.ComboBoxModel(connectDB,"SELECT DISTINCT subhead FROM subheads ORDER BY 1"));
jButton10.setEnabled(false);
printVoucherBtn.setEnabled(false);
jButton13.setEnabled(false);
jButton12.setEnabled(false);
//         
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {
        java.awt.GridBagConstraints gridBagConstraints;

        jSearchDialog11 = new javax.swing.JDialog();
        jSearchPanel11 = new javax.swing.JPanel();
        jTextField11111 = new javax.swing.JTextField();
        jSearchScrollPane11 = new javax.swing.JScrollPane();
        jSearchTable11 = new com.afrisoftech.dbadmin.JTable();
        jButton9 = new javax.swing.JButton();
        jPanel4 = new javax.swing.JPanel();
        Save = new javax.swing.JButton();
        resetbtn = new javax.swing.JButton();
        cancelbtn = new javax.swing.JButton();
        jButton1 = new javax.swing.JButton();
        cancelbtn1 = new javax.swing.JButton();
        jLabel5 = new javax.swing.JLabel();
        totalApprovalTxt = new javax.swing.JTextField();
        jButton10 = new javax.swing.JButton();
        printVoucherBtn = new javax.swing.JButton();
        jButton12 = new javax.swing.JButton();
        jButton13 = new javax.swing.JButton();
        jPanel3 = new javax.swing.JPanel();
        jPanel1 = new javax.swing.JPanel();
        jPanel2 = new javax.swing.JPanel();
        jScrollPane1 = new javax.swing.JScrollPane();
        loadItemsTable = new com.afrisoftech.dbadmin.JTable(){
            Class[] types = new Class [] {
                java.lang.Object.class, java.lang.Object.class, java.lang.Object.class, java.lang.Object.class, java.lang.Double.class, java.lang.Double.class, java.lang.Boolean.class, java.lang.Object.class
            };
            boolean[] canEdit = new boolean [] {
                false, false, false, false, false, false, true, true
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        };
        jLabel1 = new javax.swing.JLabel();
        dealerNameTxt = new javax.swing.JTextField();
        jPanel5 = new javax.swing.JPanel();
        jPanel7 = new javax.swing.JPanel();
        ApprovalTblscr = new javax.swing.JScrollPane();
        staffPaymentTable = new com.afrisoftech.dbadmin.JTable();
        jLabel76 = new javax.swing.JLabel();
        staffVoucherNoTxt = new javax.swing.JTextField();
        jPanel8 = new javax.swing.JPanel();
        ApprovalTblscr1 = new javax.swing.JScrollPane();
        AppTableAie = new com.afrisoftech.dbadmin.JTable();
        jLabel75 = new javax.swing.JLabel();
        jTextField45 = new javax.swing.JTextField();
        jLabel2 = new javax.swing.JLabel();

        jSearchDialog11.setModal(true);
        jSearchDialog11.setUndecorated(true);
        jSearchDialog11.getContentPane().setLayout(new java.awt.GridBagLayout());

        jSearchPanel11.setBorder(javax.swing.BorderFactory.createEtchedBorder());
        jSearchPanel11.setLayout(new java.awt.GridBagLayout());

        jTextField11111.addCaretListener(new javax.swing.event.CaretListener() {
            public void caretUpdate(javax.swing.event.CaretEvent evt) {
                jTextField11111CaretUpdate(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 10.0;
        gridBagConstraints.weighty = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 100);
        jSearchPanel11.add(jTextField11111, gridBagConstraints);

        jSearchTable11.setShowHorizontalLines(false);
        /*    try {
            searchRowSet.setCommand("select product,selling_price,gl_code FROM st_stock_prices WHERE department = 'Pharmacy' order by product");
            searchRowSet.setConnectionSource(pConnDB);

            searchRowSet.execute();

            // crset2.setExecuteOnLoad(true);
            jSearchTable.setModel(new org.netbeans.lib.sql.models.TableModel(searchRowSet, new org.netbeans.lib.sql.models.TableModel.Column[] {
                new org.netbeans.lib.sql.models.TableModel.Column("product", "Description", false),
                new org.netbeans.lib.sql.models.TableModel.Column("selling_price", "Amount", false),
                new org.netbeans.lib.sql.models.TableModel.Column("gl_code", "Gl_code", false)

            }));
            // jSearchScrollPane.setViewportView(jSearchTable);

        } catch(java.sql.SQLException sqlex){
            javax.swing.JOptionPane.showMessageDialog(this,sqlex.getMessage(),"Error Message!",javax.swing.JOptionPane.ERROR_MESSAGE);

            System.out.println(sqlex.getMessage());
        }
        */
        jSearchTable11.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                jSearchTable11MouseClicked(evt);
            }
        });
        jSearchScrollPane11.setViewportView(jSearchTable11);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.gridwidth = 2;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 20.0;
        jSearchPanel11.add(jSearchScrollPane11, gridBagConstraints);

        jButton9.setText("Dispose");
        jButton9.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton9ActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jSearchPanel11.add(jButton9, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jSearchDialog11.getContentPane().add(jSearchPanel11, gridBagConstraints);

        setClosable(true);
        setIconifiable(true);
        setMaximizable(true);
        setResizable(true);
        setTitle("AIE Holder");
        setToolTipText("");
        setPreferredSize(new java.awt.Dimension(806, 536));
        setVisible(true);
        addInternalFrameListener(new javax.swing.event.InternalFrameListener() {
            public void internalFrameActivated(javax.swing.event.InternalFrameEvent evt) {
                formInternalFrameActivated(evt);
            }
            public void internalFrameClosed(javax.swing.event.InternalFrameEvent evt) {
            }
            public void internalFrameClosing(javax.swing.event.InternalFrameEvent evt) {
            }
            public void internalFrameDeactivated(javax.swing.event.InternalFrameEvent evt) {
            }
            public void internalFrameDeiconified(javax.swing.event.InternalFrameEvent evt) {
            }
            public void internalFrameIconified(javax.swing.event.InternalFrameEvent evt) {
            }
            public void internalFrameOpened(javax.swing.event.InternalFrameEvent evt) {
                formInternalFrameOpened(evt);
            }
        });
        getContentPane().setLayout(new java.awt.GridBagLayout());

        jPanel4.setBorder(javax.swing.BorderFactory.createEtchedBorder());
        jPanel4.setMinimumSize(new java.awt.Dimension(250, 27));
        jPanel4.setPreferredSize(new java.awt.Dimension(250, 27));
        jPanel4.setLayout(new java.awt.GridBagLayout());

        Save.setMnemonic('s');
        Save.setText("Approve");
        Save.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                SaveActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel4.add(Save, gridBagConstraints);

        resetbtn.setText("Remove Row");
        resetbtn.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                resetbtnActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel4.add(resetbtn, gridBagConstraints);

        cancelbtn.setMnemonic('l');
        cancelbtn.setText("Clear");
        cancelbtn.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cancelbtnActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 3;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel4.add(cancelbtn, gridBagConstraints);

        jButton1.setText("Refresh");
        jButton1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton1ActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 1;
        jPanel4.add(jButton1, gridBagConstraints);

        cancelbtn1.setMnemonic('l');
        cancelbtn1.setText("Reject");
        cancelbtn1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cancelbtn1ActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 4;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel4.add(cancelbtn1, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 8;
        gridBagConstraints.gridwidth = 12;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 1.0;
        getContentPane().add(jPanel4, gridBagConstraints);

        jLabel5.setText("Total Approvals");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 4;
        gridBagConstraints.gridy = 6;
        getContentPane().add(jLabel5, gridBagConstraints);

        totalApprovalTxt.setEditable(false);
        totalApprovalTxt.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        totalApprovalTxt.setForeground(new java.awt.Color(204, 0, 0));
        totalApprovalTxt.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        totalApprovalTxt.setText("0.00");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 5;
        gridBagConstraints.gridy = 6;
        gridBagConstraints.gridwidth = 3;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        getContentPane().add(totalApprovalTxt, gridBagConstraints);

        jButton10.setBackground(new java.awt.Color(153, 255, 255));
        jButton10.setForeground(new java.awt.Color(0, 102, 102));
        jButton10.setText("GRN");
        jButton10.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton10ActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 7;
        getContentPane().add(jButton10, gridBagConstraints);

        printVoucherBtn.setBackground(new java.awt.Color(153, 255, 255));
        printVoucherBtn.setForeground(new java.awt.Color(0, 102, 102));
        printVoucherBtn.setText("Payment Voucher");
        printVoucherBtn.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                printVoucherBtnActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 5;
        gridBagConstraints.gridy = 7;
        getContentPane().add(printVoucherBtn, gridBagConstraints);

        jButton12.setBackground(new java.awt.Color(153, 255, 255));
        jButton12.setForeground(new java.awt.Color(0, 102, 102));
        jButton12.setText("Acceptance Form");
        jButton12.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton12ActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 3;
        gridBagConstraints.gridy = 7;
        getContentPane().add(jButton12, gridBagConstraints);

        jButton13.setBackground(new java.awt.Color(153, 255, 255));
        jButton13.setForeground(new java.awt.Color(0, 102, 102));
        jButton13.setText("Imprest Form");
        jButton13.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton13ActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 7;
        gridBagConstraints.gridy = 7;
        getContentPane().add(jButton13, gridBagConstraints);

        jPanel3.setLayout(new java.awt.GridBagLayout());

        /*        javax.swing.SpinnerDateModel spinerDate = new javax.swing.SpinnerDateModel();
        dateSpinner = new javax.swing.JSpinner(spinerDate);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 3;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 30);
        jPanel1.add(dateSpinner, gridBagConstraints);

        */
        jPanel1.setBorder(javax.swing.BorderFactory.createEtchedBorder());
        jPanel1.setLayout(new java.awt.GridBagLayout());

        jPanel2.setBorder(javax.swing.BorderFactory.createTitledBorder(""));
        jPanel2.setLayout(new java.awt.GridBagLayout());

        /*     tableModel = loadItemsTable.getModel();

        tableModel.addTableModelListener(new javax.swing.event.TableModelListener() {

            public void tableChanged(javax.swing.event.TableModelEvent evt) {

                tableModelTableChanged(evt);

            }

        });
        */
        loadItemsTable.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null, null}
            },
            new String [] {
                "Date Due", "Invoice/Imprest No.", "Transaction Type", "Item", "Amount", "Amt Approved", "Approve ?", "Invoice/Imprest No."
            }
        ) {
            Class[] types = new Class [] {
                java.lang.Object.class, java.lang.Object.class, java.lang.Object.class, java.lang.Object.class, java.lang.Double.class, java.lang.Double.class, java.lang.Boolean.class, java.lang.Object.class
            };
            boolean[] canEdit = new boolean [] {
                false, false, false, false, false, false, true, true
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        loadItemsTable.setShowHorizontalLines(false);
        loadItemsTable.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                loadItemsTableMouseClicked(evt);
            }
        });
        jScrollPane1.setViewportView(loadItemsTable);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 200.0;
        jPanel2.add(jScrollPane1, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.gridwidth = 7;
        gridBagConstraints.gridheight = 4;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 250.0;
        gridBagConstraints.insets = new java.awt.Insets(1, 1, 1, 1);
        jPanel1.add(jPanel2, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 2;
        gridBagConstraints.gridwidth = 9;
        gridBagConstraints.gridheight = 4;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 9.0;
        gridBagConstraints.weighty = 5.0;
        jPanel3.add(jPanel1, gridBagConstraints);

        jLabel1.setFont(new java.awt.Font("Times New Roman", 1, 30)); // NOI18N
        jLabel1.setForeground(new java.awt.Color(255, 51, 51));
        jLabel1.setText("AIE Holder Approval");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.gridwidth = 9;
        gridBagConstraints.weightx = 1.0;
        jPanel3.add(jLabel1, gridBagConstraints);

        dealerNameTxt.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
        dealerNameTxt.setForeground(new java.awt.Color(255, 0, 0));
        dealerNameTxt.setHorizontalAlignment(javax.swing.JTextField.CENTER);
        dealerNameTxt.setEnabled(false);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.gridwidth = 9;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        jPanel3.add(dealerNameTxt, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 3;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.gridwidth = 9;
        gridBagConstraints.gridheight = 6;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 7.0;
        gridBagConstraints.weighty = 5.0;
        getContentPane().add(jPanel3, gridBagConstraints);

        jPanel5.setLayout(new java.awt.GridBagLayout());

        jPanel7.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Staff Payment/ Refunds", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Dialog", 1, 11), new java.awt.Color(0, 0, 204))); // NOI18N
        jPanel7.setMinimumSize(new java.awt.Dimension(100, 250));
        jPanel7.setPreferredSize(new java.awt.Dimension(100, 250));
        jPanel7.setLayout(new java.awt.GridBagLayout());

        staffPaymentTable.setModel(com.afrisoftech.dbadmin.TableModel.createTableVectors(connectDB,"SELECT DISTINCT dealer as Imprest_Holder,final_voucher_no as voucher_no FROM ac_bills  WHERE final_voucher_no != '' and approved = false AND cancelled=false AND examination=false and commited=true and accountant=false and finance_head=false group by 1,2 having sum(credit-debit)>0 union select distinct payee as Imprest_Holder, final_voucher_no as voucher_no from ac_petty_cash_requisition WHERE final_voucher_no != '' and approved = false AND cancelled=false and commited=true AND examination=false and accountant=false and finance_head=false group by 1,2 having sum(credit-debit)>0"));
        staffPaymentTable.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                staffPaymentTableMouseClicked(evt);
            }
        });
        ApprovalTblscr.setViewportView(staffPaymentTable);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.gridwidth = 3;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 500.0;
        jPanel7.add(ApprovalTblscr, gridBagConstraints);

        jLabel76.setText("Voucher no:");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel7.add(jLabel76, gridBagConstraints);

        staffVoucherNoTxt.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                staffVoucherNoTxtKeyPressed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.gridwidth = 2;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 4.0;
        gridBagConstraints.weighty = 1.0;
        jPanel7.add(staffVoucherNoTxt, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 3;
        gridBagConstraints.gridwidth = 3;
        gridBagConstraints.gridheight = 3;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel5.add(jPanel7, gridBagConstraints);

        jPanel8.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Select Voucher here", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Dialog", 1, 11), new java.awt.Color(0, 0, 204))); // NOI18N
        jPanel8.setMinimumSize(new java.awt.Dimension(100, 250));
        jPanel8.setPreferredSize(new java.awt.Dimension(100, 250));
        jPanel8.setLayout(new java.awt.GridBagLayout());

        AppTableAie.setModel(com.afrisoftech.dbadmin.TableModel.createTableVectors(connectDB,"select DISTINCT dealer as Supplier,voucher_no FROM ac_accounts_payable where approved=false and voucher_no!='' and examination=false and accountant=false and finance_head=false and voucher_no in (select voucher_no from ac_accounts_payable group by voucher_no having sum(credit-debit)>0  and sum(credit-debit) !=0 ) group by 1,2 order by dealer"));
        AppTableAie.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                AppTableAieMouseClicked(evt);
            }
        });
        ApprovalTblscr1.setViewportView(AppTableAie);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.gridwidth = 3;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 500.0;
        jPanel8.add(ApprovalTblscr1, gridBagConstraints);

        jLabel75.setText("PV no:");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel8.add(jLabel75, gridBagConstraints);

        jTextField45.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                jTextField45KeyPressed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.gridwidth = 2;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 4.0;
        gridBagConstraints.weighty = 1.0;
        jPanel8.add(jTextField45, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.gridwidth = 3;
        gridBagConstraints.gridheight = 3;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel5.add(jPanel8, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.gridwidth = 3;
        gridBagConstraints.gridheight = 6;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 3.0;
        gridBagConstraints.weighty = 5.0;
        getContentPane().add(jPanel5, gridBagConstraints);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 8;
        gridBagConstraints.gridy = 6;
        gridBagConstraints.gridwidth = 4;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        getContentPane().add(jLabel2, gridBagConstraints);

        pack();
    }// </editor-fold>//GEN-END:initComponents
 
    private void formInternalFrameActivated(javax.swing.event.InternalFrameEvent evt) {//GEN-FIRST:event_formInternalFrameActivated
        // TODO add your handling code here:
    }//GEN-LAST:event_formInternalFrameActivated

    private void formInternalFrameOpened(javax.swing.event.InternalFrameEvent evt) {//GEN-FIRST:event_formInternalFrameOpened
        // TODO add your handling code here:
        
    }//GEN-LAST:event_formInternalFrameOpened
   
    private void jTextField11111CaretUpdate(javax.swing.event.CaretEvent evt) {//GEN-FIRST:event_jTextField11111CaretUpdate


        // Add your handling code here:
    }//GEN-LAST:event_jTextField11111CaretUpdate

    private void jSearchTable11MouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jSearchTable11MouseClicked

        // Add your handling code here:
    }//GEN-LAST:event_jSearchTable11MouseClicked

    private void jButton9ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton9ActionPerformed
       
        // Add your handling code here:
    }//GEN-LAST:event_jButton9ActionPerformed

    private void staffPaymentTableMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_staffPaymentTableMouseClicked
        jButton10.setEnabled(false);
        printVoucherBtn.setEnabled(false);
        jButton12.setEnabled(false);
        jButton13.setEnabled(true);
        
        decision="two";
        try{    
          int ik= staffPaymentTable.getSelectedRow();
            if(yesI==true){
          staffPaymentTable.setModel(com.afrisoftech.dbadmin.TableModel.createTableVectors(connectDB,"SELECT DISTINCT dealer as Imprest_Holder,final_voucher_no FROM ac_bills WHERE approved = false AND (final_voucher_no ILIKE '%"+staffVoucherNoTxt.getText()+"%' and final_voucher_no !='') AND cancelled=false AND examination=false and commited=true and accountant=false and finance_head=false union select distinct payee as Imprest_Holder, final_voucher_no as voucher_no from ac_petty_cash_requisition WHERE final_voucher_no != '' and commited=true and approved = false AND cancelled=false AND examination=false and accountant=false and finance_head=false and final_voucher_no ILIKE '%"+staffVoucherNoTxt.getText()+"%'"));
        yesI=false;
    }else if(yesI!=true){ 
        
          staffPaymentTable.setModel(com.afrisoftech.dbadmin.TableModel.createTableVectors(connectDB,"SELECT DISTINCT dealer as Imprest_Holder,final_voucher_no as voucher_no FROM ac_bills  WHERE approved = false AND final_voucher_no !='' and cancelled=false AND examination=false and commited=true and accountant=false and finance_head=false group by 1,2 having sum(credit-debit)>0 union select distinct payee as Imprest_Holder, final_voucher_no as voucher_no from ac_petty_cash_requisition WHERE final_voucher_no != '' and commited=true and approved = false AND cancelled=false AND examination=false and accountant=false and finance_head=false group by 1,2 having sum(credit-debit)>0"));
      
    }
            voucherNo=staffPaymentTable.getValueAt(ik, 1).toString();
            System.out.println("voucher 1 "+voucherNo);
        String correct_name=staffPaymentTable.getValueAt(ik, 0).toString();
                      if(correct_name.contains("'")){
                            correct_name=  staffPaymentTable.getValueAt(ik, 0).toString().substring(0, staffPaymentTable.getValueAt(ik, 0).toString().indexOf("'"));
                      }
                      else if(!correct_name.contains("'")){
                            correct_name=staffPaymentTable.getValueAt(ik, 0).toString();
                      }
                      
                       
                   
                    System.out.println("The correct name is "+correct_name);
//ApprovalTbl.getValueAt(ik, 1).toString().contains("IMP")||ApprovalTbl.getValueAt(ik, 1).toString().contains("PRN")||ApprovalTbl.getValueAt(ik, 1).toString().contains("SAL_ADV") ||ApprovalTbl.getValueAt(ik, 1).toString().contains("VCKIN") ||ApprovalTbl.getValueAt(ik, 1).toString().contains("VCBOD")
if(staffPaymentTable.getValueAt(ik, 1).toString().contains("PETT")){
    
    System.out.println("here jkij");
    loadItemsTable.setModel(com.afrisoftech.dbadmin.TableModel.createTableVectors(connectDB, "SELECT date_due as Invoice_date, final_voucher_no as imprest_no, reason, description, credit as amount, 0.00 as approved_amount, false as approve, requisition_no"
            + " FROM ac_petty_cash_requisition WHERE final_voucher_no != '' and commited=true and approved = false AND cancelled=false AND examination=false and accountant=false and final_voucher_no  = '" +staffPaymentTable.getValueAt(ik, 1)+ "' order by 2"));
}else{
   System.out.println("here");
 loadItemsTable.setModel(com.afrisoftech.dbadmin.TableModel.createTableVectors(connectDB, "(SELECT date_deu as date_due,voucher_no as imprest_no,description,reason,credit as amount, 0.00 as approved_amount, false as approve,final_voucher_no " +
" FROM ac_bills WHERE approved = false AND cancelled=false AND examination=false and accountant=false and  final_voucher_no  = '" +staffPaymentTable.getValueAt(ik, 1)+ "' order by 2)" +
" union" +
" (SELECT date_due as Invoice_date, final_voucher_no as imprest_no, reason, description, credit as amount, 0.00 as approved_amount, false as approve, requisition_no " +
" FROM ac_petty_cash_requisition WHERE requisition_no ilike '%PERS_REQ%' and final_voucher_no != '' and commited=true and approved = false AND cancelled=false AND examination=false and accountant=false and final_voucher_no  = '" +staffPaymentTable.getValueAt(ik, 1)+ "' order by 2)")); 
}

dealerNameTxt.setText(staffPaymentTable.getValueAt(ik, 0).toString());
        }catch(Exception r){
            r.printStackTrace();
        }
    }//GEN-LAST:event_staffPaymentTableMouseClicked

    private void SaveActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_SaveActionPerformed
        boolean sam = true;
        try{
            connectDB.setAutoCommit(false);
            
                for (int i = 0; i < loadItemsTable.getRowCount(); i++) {
                            if (loadItemsTable.getModel().getValueAt(i, 6) != null) {
                                if (loadItemsTable.getModel().getValueAt(i, 6).toString().equals("true")) {
                                    System.out.println("Value 1 " + loadItemsTable.getModel().getValueAt(i, 4));
                                    System.out.println("Value 2 " + loadItemsTable.getModel().getValueAt(i, 3));
                                    if (decision=="one") {
                                        requNo=loadItemsTable.getModel().getValueAt(i, 7).toString();
                                        java.sql.PreparedStatement pstmt = connectDB.prepareStatement("UPDATE ac_accounts_payable set finance_head=true,finance_head_officer=current_user,finance_head_time=now(), accountant = true, accountant_officer=current_user,accountant_time=now(),journal_no='" + loadItemsTable.getModel().getValueAt(i, 1) + "' WHERE voucher_no = '" + requNo + "' and invoice_no = '" + loadItemsTable.getModel().getValueAt(i, 1).toString() + "' and dealer ILIKE '" + com.afrisoftech.lib.VoteBook.RemoveAppostroph(this.dealerNameTxt.getText()) + "'");

                                        pstmt.executeUpdate();
                                        
                                        
                                         
                                           Boolean inTracker=false;
                                             java.sql.Statement stmtf2 = connectDB.createStatement();
                                        java.sql.ResultSet rsetf2 = stmtf2.executeQuery("select * from ac_dashboard where supplier='"+com.afrisoftech.lib.VoteBook.RemoveAppostroph(dealerNameTxt.getText())+"' and invoice_no='"+loadItemsTable.getValueAt(i, 1).toString()+"'");
                                        if (rsetf2.getFetchSize()>0) {
                                            inTracker=true;
                                        }
                                        //start
                                String rectifyDate = "1900-01-01 00:00:00.000"; 
                                java.util.Date realDate = null;
                                        java.sql.Statement stmtr = connectDB.createStatement();
                                        java.sql.ResultSet rsetr = stmtr.executeQuery("select '"+rectifyDate+"'::date");
                                        while(rsetr.next()){
                                        realDate = rsetr.getDate(1);
                                        }
                                            if(inTracker==true){ 
                                                System.err.println("hapa befoer");
                                                    java.sql.PreparedStatement pstmt91 = connectDB.prepareStatement("UPDATE ac_dashboard SET finance_head=now(),finance_head_officer=current_user,accountant=now(), accountant_name=current_user where voucher_no = '" + requNo + "'  and supplier ILIKE '"+com.afrisoftech.lib.VoteBook.RemoveAppostroph(this.dealerNameTxt.getText())+"'");
                                            pstmt91.executeUpdate();
                                            }else{
                                                System.err.println("hapa after");
               java.sql.PreparedStatement pstmt7 = connectDB.prepareStatement("insert into ac_dashboard (supplier,invoice_no,creditor_created,creditor_created_by,accountant,accountant_name,finance_head ,finance_head_officer) "
                       + "values(?,?,?,?,now(),current_user,now(),current_user)");
                pstmt7.setString(1, dealerNameTxt.getText().toString());
                pstmt7.setObject(2, loadItemsTable.getValueAt(i, 1));
                pstmt7.setDate(3,com.afrisoftech.lib.SQLDateFormat.getSQLDate(realDate));
                pstmt7.setObject(4, "");
                pstmt7.executeUpdate();
                                            }
                          
                                            
                                            
                                    } else if (decision=="two") {
                                         requNo=loadItemsTable.getModel().getValueAt(i, 7).toString();
                                         //jTable1.getModel().getValueAt(i, 7).toString().contains("IMP") || jTable1.getModel().getValueAt(i, 7).toString().contains("PRN")|| jTable1.getModel().getValueAt(i, 7).toString().contains("SAL_ADV") || jTable1.getValueAt(i, 7).toString().contains("VCKIN") ||jTable1.getValueAt(i, 7).toString().contains("VCBOD")
                                     if(loadItemsTable.getModel().getValueAt(i, 7).toString().contains("PETT") || loadItemsTable.getModel().getValueAt(i, 7).toString().contains("PERS_REQ")){
                                           java.sql.PreparedStatement pstmt = connectDB.prepareStatement("UPDATE ac_petty_cash_requisition SET examination= true  WHERE"
                                            + " final_voucher_no = '" + loadItemsTable.getModel().getValueAt(i, 1).toString() + "' and payee ILIKE '" + this.dealerNameTxt.getText() + "'");

                                        pstmt.executeUpdate();
                                        sam = true;
                                        //former query :UPDATE ac_dashboard SET finance_head=now(),finance_head=true,accountant=now(), accountant_name=current_user where voucher_no = '" + jTable1.getModel().getValueAt(i, 1).toString() + "' and supplier ILIKE '"+this.jTextField2.getText()+"'
                                        java.sql.PreparedStatement pstmt91 = connectDB.prepareStatement("UPDATE ac_dashboard SET finance_head=now(),accountant=now(), accountant_name=current_user where voucher_no = '" + loadItemsTable.getModel().getValueAt(i, 1).toString() + "' and supplier ILIKE '"+com.afrisoftech.lib.VoteBook.RemoveAppostroph(this.dealerNameTxt.getText())+"'");
                                            pstmt91.executeUpdate(); //finance_head_officer
                                      
                                         }else{
                                         java.sql.PreparedStatement pstmt = connectDB.prepareStatement("UPDATE ac_bills set finance_head=true,finance_head_officer=current_user,finance_head_time=now(),accountant = true, accountant_officer=current_user,accountant_time=now() WHERE"
                                        + " voucher_no = '" + loadItemsTable.getModel().getValueAt(i, 1).toString() + "' and final_voucher_no = '" + loadItemsTable.getModel().getValueAt(i, 7).toString() + "' and dealer ILIKE '" + com.afrisoftech.lib.VoteBook.RemoveAppostroph(this.dealerNameTxt.getText()) + "'");
                                        sam = true;
                                        pstmt.executeUpdate();
                                        
                                        java.sql.PreparedStatement pstmt91 = connectDB.prepareStatement("UPDATE ac_dashboard SET finance_head=now(),accountant=now(), accountant_name=current_user where voucher_no = '" + loadItemsTable.getModel().getValueAt(i, 1).toString() + "' and supplier ILIKE '"+com.afrisoftech.lib.VoteBook.RemoveAppostroph(this.dealerNameTxt.getText())+"'");
                                            pstmt91.executeUpdate();
                                         
                                         }
                                    }else{
                                        sam = false;
                                    javax.swing.JOptionPane.showMessageDialog(this, "AIE Approval UNSUCCESSFULL ", "ERROR Message!", javax.swing.JOptionPane.INFORMATION_MESSAGE);    
                                    }
                                }
                            }

                        }
                        connectDB.commit();
                        connectDB.setAutoCommit(true);
                        if(sam==true){
                        javax.swing.JOptionPane.showMessageDialog(this, "AIE Approval Successfull ", "Confirmation Message!", javax.swing.JOptionPane.INFORMATION_MESSAGE);
                        }
                        AppTableAie.setModel(com.afrisoftech.dbadmin.TableModel.createTableVectors(connectDB,"select DISTINCT dealer as Supplier,voucher_no FROM ac_accounts_payable where approved=false and voucher_no!='' and examination=false and accountant=false and finance_head=false and voucher_no in (select voucher_no from ac_accounts_payable group by voucher_no having sum(credit-debit)>0  and sum(credit-debit) !=0 ) group by 1,2 order by dealer"));
                        staffPaymentTable.setModel(com.afrisoftech.dbadmin.TableModel.createTableVectors(connectDB,"SELECT DISTINCT dealer as Imprest_Holder,final_voucher_no as voucher_no FROM ac_bills  WHERE final_voucher_no != '' and approved = false AND cancelled=false AND examination=false and commited=true and accountant=false and finance_head=false group by 1,2 having sum(credit-debit)>0 union select distinct payee as Imprest_Holder, final_voucher_no as voucher_no from ac_petty_cash_requisition WHERE final_voucher_no != '' and commited=true and approved = false AND cancelled=false  AND examination=false and accountant=false and finance_head=false group by 1,2 having sum(credit-debit)>0"));
                        jButton1.doClick();
        }catch(Exception r){
            sam = false;
             javax.swing.JOptionPane.showMessageDialog(this, r.getMessage(), "Error Message!", javax.swing.JOptionPane.ERROR_MESSAGE);
            
            r.printStackTrace();
            
        }
    }//GEN-LAST:event_SaveActionPerformed

    private void resetbtnActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_resetbtnActionPerformed
          int rows2Delete = loadItemsTable.getSelectedRowCount();

        int[] selectedRows = loadItemsTable.getSelectedRows();

        if (rows2Delete < 1) {

            java.awt.Toolkit.getDefaultToolkit().beep();

            javax.swing.JOptionPane.showMessageDialog(this, "There are no selected rows to delete!");

        } else {

            if (rows2Delete > 1) {

                for (int i = 0; i < selectedRows.length; i++) {



                    javax.swing.table.DefaultTableModel defTableModel = (javax.swing.table.DefaultTableModel) loadItemsTable.getModel();

                    defTableModel.removeRow(selectedRows[i]);

                }



            } else {

                javax.swing.table.DefaultTableModel defTableModel = (javax.swing.table.DefaultTableModel) loadItemsTable.getModel();

                defTableModel.removeRow(loadItemsTable.getSelectedRow());
            }
        } 

    }//GEN-LAST:event_resetbtnActionPerformed

    private void cancelbtnActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cancelbtnActionPerformed
         for (int k = 0; k < loadItemsTable.getRowCount(); k++) {
                for (int r = 0; r < loadItemsTable.getColumnCount(); r++) {
                    loadItemsTable.getModel().setValueAt(null, k, r);
                }
        }
         totalApprovalTxt.setText("0.00");
         jTextField45.setText("");
         staffVoucherNoTxt.setText("");
        jButton10.setEnabled(false);
        printVoucherBtn.setEnabled(false);
        jButton12.setEnabled(false);
        jButton13.setEnabled(false);
         dealerNameTxt.setText("");
    }//GEN-LAST:event_cancelbtnActionPerformed

    private void AppTableAieMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_AppTableAieMouseClicked
        // TODO add your handling code here:
        jButton10.setEnabled(true);
        printVoucherBtn.setEnabled(true);
        jButton12.setEnabled(true);
        jButton13.setEnabled(false);
        decision="one";
        int iu=AppTableAie.getSelectedRow();
        
   
       try{
             if(yes==true){
  AppTableAie.setModel(com.afrisoftech.dbadmin.TableModel.createTableVectors(connectDB,"select DISTINCT dealer as Supplier,voucher_no FROM ac_accounts_payable where approved=false and voucher_no ilike '%"+jTextField45.getText()+"%' and examination=false and accountant=false and finance_head=false and voucher_no in (select voucher_no from ac_accounts_payable group by voucher_no having sum(credit-debit)>0  and sum(credit-debit) !=0 ) group by 1,2 order by dealer"));
        yes=false;
    }else if(yes!=true){ 
  AppTableAie.setModel(com.afrisoftech.dbadmin.TableModel.createTableVectors(connectDB,"select DISTINCT dealer as Supplier,voucher_no FROM ac_accounts_payable where approved=false and voucher_no!='' and examination=false and accountant=false and finance_head=false and voucher_no in (select voucher_no from ac_accounts_payable group by voucher_no having sum(credit-debit)>0  and sum(credit-debit) !=0 ) group by 1,2 order by dealer"));
       } 
  
  
  
  voucherNo=AppTableAie.getValueAt(iu, 1).toString();
        java.sql.Statement  st119= connectDB.createStatement();
            java.sql.ResultSet ress19= st119.executeQuery("select refno from ac_aie_commitment where voucher_no='"+AppTableAie.getValueAt(iu, 1)+"'");
            while(ress19.next()){
                lpoNo=ress19.getString(1);
            }
           
//       jTable1.setModel(com.afrisoftech.dbadmin.TableModel.createTableVectors(connectDB, "select date_due,invoice_no,transaction_type,item,"
//                    + "(credit-debit) AS AMOUNT, 0.00 as approved_amount, false as approve,voucher_no FROM "
//                    + "ac_accounts_payable where approved=false and examination=false and committed=true and dealer ='" + ApprovalTbl1.getValueAt(iu, 0) + "' and invoice_no in (select invoice_no from ac_accounts_payable group by invoice_no having sum(credit-debit) != 0 ) order by invoice_no"));
loadItemsTable.setModel(com.afrisoftech.dbadmin.TableModel.createTableVectors(connectDB, "select date_due,invoice_no,transaction_type,item,(credit-debit) AS AMOUNT, 0.00 as approved_amount, false as approve,voucher_no FROM ac_accounts_payable where approved=false and examination=false and committed=true and dealer ='"+com.afrisoftech.lib.VoteBook.RemoveAppostroph(AppTableAie.getValueAt(iu, 0).toString())+"' and voucher_no='"+AppTableAie.getValueAt(iu, 1)+"' and invoice_no in (select invoice_no from ac_accounts_payable group by invoice_no having sum(credit-debit) != 0) order by invoice_no"));

                dealerNameTxt.setText(AppTableAie.getValueAt(iu, 0).toString());
                iu=0;
       }catch(Exception e){
           e.printStackTrace();
       }
    }//GEN-LAST:event_AppTableAieMouseClicked

    private void loadItemsTableMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_loadItemsTableMouseClicked

        /*
        if (jTable1.getSelectedColumn() == 0) {

            this.cmboxMouseClicked();
        }else{
            */
            //if (jTable1.getSelectedColumn() == 4) {
                //   this.cmboxMouseClicked();
                System.out.println("Check here");
                if (loadItemsTable.getValueAt(loadItemsTable.getSelectedRow(), 2) != null) {
                    double floatCol2 = java.lang.Double.parseDouble(loadItemsTable.getValueAt(loadItemsTable.getSelectedRow(), 4).toString());

                    // if (jTable1.getValueAt(jTable1.getSelectedRow(), 2) != null){
                        //if (jTable1.getModel().getValueAt(jTable1.getSelectedRow(),4).equals(true)){
                            /// if (Boolean.valueOf(jTable1.getModel().getValueAt(jTable1.getSelectedRow(), 6).toString()) == java.lang.Boolean.TRUE) {
                                if (loadItemsTable.getModel().getValueAt(loadItemsTable.getSelectedRow(), 6).toString().equalsIgnoreCase("true")) {

                                    loadItemsTable.setValueAt(new java.lang.Float(floatCol2), loadItemsTable.getSelectedRow(), 5);
                                    double totalSum = com.afrisoftech.lib.TableColumnTotal.getTableColumnTotal(loadItemsTable, 5);
                                    this.totalApprovalTxt.setText(com.afrisoftech.lib.CurrencyFormatter.getFormattedDouble(totalSum));
                                   

                            } else {
                                System.out.println("Check here");
                                // if (jTable1.getModel().getValueAt(jTable1.getSelectedRow(),4).equals(false)){
                                    if (Boolean.valueOf(loadItemsTable.getModel().getValueAt(loadItemsTable.getSelectedRow(), 6).toString()) == java.lang.Boolean.FALSE) {
                                        System.out.println("Check here too");
                                        loadItemsTable.setValueAt(new java.lang.Float(0.00), loadItemsTable.getSelectedRow(), 5);
                                        double totalSum = com.afrisoftech.lib.TableColumnTotal.getTableColumnTotal(loadItemsTable, 5);
                                        this.totalApprovalTxt.setText(com.afrisoftech.lib.CurrencyFormatter.getFormattedDouble(totalSum));
                                       
                                }
                            }
                        }
                        // }
                    // }
                // Add your handling code here:
    }//GEN-LAST:event_loadItemsTableMouseClicked

    private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton1ActionPerformed
        // TODO add your handling code here:
        cancelbtn.doClick();
        AppTableAie.setModel(com.afrisoftech.dbadmin.TableModel.createTableVectors(connectDB,"select DISTINCT dealer as Supplier,voucher_no FROM ac_accounts_payable where approved=false and voucher_no!='' and examination=false and accountant=false and finance_head=false and voucher_no in (select voucher_no from ac_accounts_payable group by voucher_no having sum(credit-debit)>0  and sum(credit-debit) !=0 ) group by 1,2 order by dealer"));
        staffPaymentTable.setModel(com.afrisoftech.dbadmin.TableModel.createTableVectors(connectDB,"SELECT DISTINCT dealer as Imprest_Holder,final_voucher_no as voucher_no FROM ac_bills  WHERE final_voucher_no != '' and approved = false AND cancelled=false AND examination=false and commited=true and accountant=false and finance_head=false group by 1,2 having sum(credit-debit)>0 union select distinct payee as Imprest_Holder, final_voucher_no as voucher_no from ac_petty_cash_requisition WHERE final_voucher_no != '' and commited=true and approved = false and commited=true AND cancelled=false AND examination=false and accountant=false and finance_head=false group by 1,2 having sum(credit-debit)>0"));
                      
//        
//        ApprovalTbl1.setModel(com.afrisoftech.dbadmin.TableModel.createTableVectors(connectDB,"select dealer as Supplier FROM "
//    + "ac_accounts_payable where approved=false and voucher_no!='' and examination=false and invoice_no in (select invoice_no from ac_accounts_payable group by invoice_no having sum(credit-debit) != 0 ) order by invoice_no"));
//ApprovalTbl.setModel(com.afrisoftech.dbadmin.TableModel.createTableVectors(connectDB,"SELECT dealer as Imprest_Holder FROM ac_bills WHERE approved = false AND examination=false and commited=true"));
//
//        
    }//GEN-LAST:event_jButton1ActionPerformed

    private void jButton10ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton10ActionPerformed
        // TODO add your handling code here:
        try{
            java.sql.Statement  st119= connectDB.createStatement();
            java.sql.ResultSet ress19= st119.executeQuery("select grn_no from st_stock_cardex where order_no= '"+lpoNo+"'");
            while(ress19.next()){
                com.afrisoftech.hospinventory.mtrhreports.MtrhSthirteenPdf policy1 = new com.afrisoftech.hospinventory.mtrhreports.MtrhSthirteenPdf();
                policy1.MtrhSthirteenPdf(connectDB,lpoNo,dealerNameTxt.getText(),ress19.getString(1));

            }
        }catch(Exception t){
            t.printStackTrace();
        }
    }//GEN-LAST:event_jButton10ActionPerformed

    private void printVoucherBtnActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_printVoucherBtnActionPerformed
        // TODO add your handling code here:
       System.out.println("voucher 2 testing");
        System.out.println("voucher 2 "+voucherNo);
                com.afrisoftech.votebook.BillVoucherMtrhPdfs policy = new com.afrisoftech.votebook.BillVoucherMtrhPdfs();
         policy.VoucherMtrhPdf(connectDB,voucherNo);

            
       
    }//GEN-LAST:event_printVoucherBtnActionPerformed

    private void jButton12ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton12ActionPerformed
        // TODO add your handling code here:
           // TODO add your handling code here:
        try{
            java.sql.Statement  st119= connectDB.createStatement();
            java.sql.ResultSet ress19= st119.executeQuery("select cert_no from st_certificate where lpo= '"+lpoNo+"'");
            while(ress19.next()){

                com.afrisoftech.hospinventory.ComplianceCertificatePdf policy = new com.afrisoftech.hospinventory.ComplianceCertificatePdf();
                policy.ComplianceCertificatePdf(connectDB,ress19.getString(1),lpoNo);

            }
        }catch(Exception t){
            t.printStackTrace();
        }
    }//GEN-LAST:event_jButton12ActionPerformed

    private void jButton13ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton13ActionPerformed
        // TODO add your handling code here:
        com.afrisoftech.votebook.PettyCashVoucherPdf policy = new com.afrisoftech.votebook.PettyCashVoucherPdf();

         policy.PettyCashVoucherPdf(connectDB, voucherNo);  
    }//GEN-LAST:event_jButton13ActionPerformed

    private void cancelbtn1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cancelbtn1ActionPerformed
        // TODO add your handling code here:
        String reason= JOptionPane.showInputDialog(null,"Input Reason for Rejecting ","Reject",JOptionPane.OK_CANCEL_OPTION);
        if(JOptionPane.OK_OPTION==0){
            
        }
    }//GEN-LAST:event_cancelbtn1ActionPerformed

    private void jTextField45KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jTextField45KeyPressed
        // TODO add your handling code here:
       yes=true;
       // ApprovalTbl1.setModel(com.afrisoftech.dbadmin.TableModel.createTableVectors(connectDB,"select distinct dealer,invoice_no from ac_accounts_payable where transaction_type='Raise Invoice' and invoice_no not like '%FDBT%' and approved=false and committed=false and invoice_no in (select invoice_no from ac_accounts_payable group by invoice_no having sum(credit-debit) !=0 ) and invoice_no ilike '%"+jTextField45.getText()+"%' union select distinct dealer,'DIR_PUR' from ac_accounts_payable where transaction_type='Stock Delivery' and approved=false and order_no ilike '%"+jTextField45.getText()+"%'  and committed=false"));
        AppTableAie.setModel(com.afrisoftech.dbadmin.TableModel.createTableVectors(connectDB,"select DISTINCT dealer as Supplier,voucher_no FROM ac_accounts_payable where approved=false and (voucher_no ilike '%"+jTextField45.getText()+"%' and voucher_no!='') and examination=false and accountant=false and finance_head=false and voucher_no in (select voucher_no from ac_accounts_payable group by voucher_no having sum(credit-debit)>0  and sum(credit-debit) !=0 ) group by 1,2 order by dealer"));
    }//GEN-LAST:event_jTextField45KeyPressed

    private void staffVoucherNoTxtKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_staffVoucherNoTxtKeyPressed
        // TODO add your handling code here:
        yesI=true;
        
        //ApprovalTbl1.setModel(com.afrisoftech.dbadmin.TableModel.createTableVectors(connectDB,"select distinct dealer,invoice_no from ac_accounts_payable where transaction_type='Raise Invoice' and invoice_no not like '%FDBT%' and approved=false and committed=false and invoice_no in (select invoice_no from ac_accounts_payable group by invoice_no having sum(credit-debit) !=0 ) and invoice_no ilike '%"+jTextField45.getText()+"%' union select distinct dealer,'DIR_PUR' from ac_accounts_payable where transaction_type='Stock Delivery' and approved=false and order_no ilike '%"+jTextField45.getText()+"%'  and committed=false"));
         staffPaymentTable.setModel(com.afrisoftech.dbadmin.TableModel.createTableVectors(connectDB,"SELECT DISTINCT dealer as Imprest_Holder,final_voucher_no as voucher_no FROM ac_bills  "
         + "WHERE (final_voucher_no ILIKE '%"+staffVoucherNoTxt.getText()+"%' and final_voucher_no !='') and approved = false AND cancelled=false AND examination=false and commited=true "
         + "and accountant=false and finance_head=false group by 1,2 having sum(credit-debit)>0 union select distinct payee as Imprest_Holder, final_voucher_no as voucher_no "
         + "from ac_petty_cash_requisition WHERE final_voucher_no ILIKE '%"+staffVoucherNoTxt.getText()+"%' and commited=true and approved = false AND cancelled=false AND examination=false and accountant=false and finance_head=false group by 1,2 having sum(credit-debit)>0"));
    }//GEN-LAST:event_staffVoucherNoTxtKeyPressed


    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JTable AppTableAie;
    private javax.swing.JScrollPane ApprovalTblscr;
    private javax.swing.JScrollPane ApprovalTblscr1;
    private javax.swing.JButton Save;
    private javax.swing.JButton cancelbtn;
    private javax.swing.JButton cancelbtn1;
    private javax.swing.JTextField dealerNameTxt;
    private javax.swing.JButton jButton1;
    private javax.swing.JButton jButton10;
    private javax.swing.JButton jButton12;
    private javax.swing.JButton jButton13;
    private javax.swing.JButton jButton9;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel75;
    private javax.swing.JLabel jLabel76;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JPanel jPanel4;
    private javax.swing.JPanel jPanel5;
    private javax.swing.JPanel jPanel7;
    private javax.swing.JPanel jPanel8;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JDialog jSearchDialog11;
    private javax.swing.JPanel jSearchPanel11;
    private javax.swing.JScrollPane jSearchScrollPane11;
    private javax.swing.JTable jSearchTable11;
    private javax.swing.JTextField jTextField11111;
    private javax.swing.JTextField jTextField45;
    private javax.swing.JTable loadItemsTable;
    private javax.swing.JButton printVoucherBtn;
    private javax.swing.JButton resetbtn;
    private javax.swing.JTable staffPaymentTable;
    private javax.swing.JTextField staffVoucherNoTxt;
    private javax.swing.JTextField totalApprovalTxt;
    // End of variables declaration//GEN-END:variables
}
