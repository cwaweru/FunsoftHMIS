/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */

package com.afrisoftech.hospinventory;

import java.awt.Color;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.logging.Level;
import java.util.logging.Logger;

/**
 *
 * @author sytem partners
 */
public class SSOGeneralEvaluaton extends javax.swing.JPanel {

    /**
     * Creates new form SSOGeneralEvaluaton
     */
    java.sql.Connection connectDB = null;
    org.netbeans.lib.sql.pool.PooledConnectionSource pConnDB = null;
    public SSOGeneralEvaluaton(java.sql.Connection connDb, org.netbeans.lib.sql.pool.PooledConnectionSource pconnDB) {
       connectDB = connDb;
       

        pConnDB = pconnDB;
        
        initComponents();
        jLabel1.setVisible(false);

    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {
        java.awt.GridBagConstraints gridBagConstraints;

        searchtendert = new javax.swing.JDialog();
        tenderrecordspnlt = new javax.swing.JPanel();
        tenderrecordstxtt = new javax.swing.JTextField();
        tenderrecordsspnlt = new javax.swing.JScrollPane();
        tenderrecordstblt = new com.afrisoftech.dbadmin.JTable();
        closebtnt = new javax.swing.JButton();
        ReportHeaderPane = new javax.swing.JPanel();
        jPanel1 = new javax.swing.JPanel();
        jLabel21 = new javax.swing.JLabel();
        jPanel45 = new javax.swing.JPanel();
        tendernotxt1 = new javax.swing.JTextField();
        searchButton1 = new javax.swing.JButton();
        jPanel4 = new javax.swing.JPanel();
        jPanel5 = new javax.swing.JPanel();
        jCheckBox1 = new javax.swing.JCheckBox();
        jLabel1 = new javax.swing.JLabel();
        jComboBox1 = new javax.swing.JComboBox();
        jLabel2 = new javax.swing.JLabel();
        GeneralKeyTxtAreaPane = new javax.swing.JPanel();
        jSplitPane1 = new javax.swing.JSplitPane();
        jPanel2 = new javax.swing.JPanel();
        jScrollPane3 = new javax.swing.JScrollPane();
        jTable2 = new com.afrisoftech.dbadmin.JTable()
        ;
        jPanel6 = new javax.swing.JPanel();
        jScrollPane4 = new javax.swing.JScrollPane();
        jTextArea2 = new javax.swing.JTextArea();
        jPanel3 = new javax.swing.JPanel();
        jScrollPane1 = new javax.swing.JScrollPane();
        jTable1 = new com.afrisoftech.dbadmin.JTable()
        ;
        jScrollPane2 = new javax.swing.JScrollPane();
        jTextArea1 = new javax.swing.JTextArea();
        jPanel25 = new javax.swing.JPanel();
        jButton3 = new javax.swing.JButton();
        jButton4 = new javax.swing.JButton();
        jButton5 = new javax.swing.JButton();

        searchtendert.setModal(true);
        searchtendert.setUndecorated(true);
        searchtendert.getContentPane().setLayout(new java.awt.GridBagLayout());

        tenderrecordspnlt.setBorder(javax.swing.BorderFactory.createEtchedBorder());
        tenderrecordspnlt.setLayout(new java.awt.GridBagLayout());

        tenderrecordstxtt.addCaretListener(new javax.swing.event.CaretListener() {
            public void caretUpdate(javax.swing.event.CaretEvent evt) {
                tenderrecordstxttCaretUpdate(evt);
            }
        });
        tenderrecordstxtt.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                tenderrecordstxttActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 300.0;
        gridBagConstraints.weighty = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 5);
        tenderrecordspnlt.add(tenderrecordstxtt, gridBagConstraints);

        tenderrecordstblt.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {

            }
        ));
        tenderrecordstblt.setToolTipText("Click on the target row to select the patient from the search.");
        tenderrecordstblt.setShowHorizontalLines(false);
        /*javax.swing.table.TableColumn column = null;

        for (int i = 0; i < 4; i++) {

            column = jSearchTable.getColumnModel().getColumn(i);

            if (i == 1) {

                column.setPreferredWidth(400);
                //sport column is bigger
            } else {

                column.setPreferredWidth(200);

            }
        }
        */
        tenderrecordstblt.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                tenderrecordstbltMouseClicked(evt);
            }
        });
        tenderrecordsspnlt.setViewportView(tenderrecordstblt);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.gridwidth = 3;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 20.0;
        tenderrecordspnlt.add(tenderrecordsspnlt, gridBagConstraints);

        closebtnt.setText("Close");
        closebtnt.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                closebtntActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        tenderrecordspnlt.add(closebtnt, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        searchtendert.getContentPane().add(tenderrecordspnlt, gridBagConstraints);

        setLayout(new java.awt.GridBagLayout());

        ReportHeaderPane.setBorder(new javax.swing.border.LineBorder(new java.awt.Color(204, 204, 204), 1, true));
        ReportHeaderPane.setLayout(new java.awt.GridBagLayout());

        jPanel1.setLayout(new java.awt.GridBagLayout());

        jLabel21.setText("Tender Number");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel1.add(jLabel21, gridBagConstraints);

        jPanel45.setBorder(javax.swing.BorderFactory.createEtchedBorder());
        jPanel45.setLayout(new java.awt.GridBagLayout());

        tendernotxt1.setEditable(false);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 2;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel45.add(tendernotxt1, gridBagConstraints);

        searchButton1.setIcon(new javax.swing.ImageIcon(getClass().getResource("/kiwi/images/date.gif"))); // NOI18N
        searchButton1.setToolTipText("Search");
        searchButton1.setHorizontalAlignment(javax.swing.SwingConstants.TRAILING);
        searchButton1.setMaximumSize(new java.awt.Dimension(74, 53));
        searchButton1.setMinimumSize(new java.awt.Dimension(74, 53));
        searchButton1.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
        searchButton1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                searchButton1ActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 2;
        jPanel45.add(searchButton1, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 40);
        jPanel1.add(jPanel45, gridBagConstraints);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 1;
        jPanel1.add(jPanel4, gridBagConstraints);

        jCheckBox1.setText("Approve");
        jPanel5.add(jCheckBox1);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.gridheight = 2;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel1.add(jPanel5, gridBagConstraints);

        jLabel1.setText("jLabel1");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 2;
        gridBagConstraints.gridwidth = 2;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel1.add(jLabel1, gridBagConstraints);

        jComboBox1.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "-" }));
        jComboBox1.setEnabled(false);
        jComboBox1.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                jComboBox1ItemStateChanged(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 40);
        jPanel1.add(jComboBox1, gridBagConstraints);

        jLabel2.setText("Item Description");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        jPanel1.add(jLabel2, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.gridwidth = 2;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 2.0;
        gridBagConstraints.weighty = 1.0;
        ReportHeaderPane.add(jPanel1, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.gridwidth = 3;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        add(ReportHeaderPane, gridBagConstraints);

        GeneralKeyTxtAreaPane.setLayout(new java.awt.GridBagLayout());

        jSplitPane1.setDividerLocation(250);

        jPanel2.setLayout(new java.awt.GridBagLayout());

        jTable2.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null},
                {null, null, null},
                {null, null, null},
                {null, null, null}
            },
            new String [] {
                "Days to Deliver", "Brand", "Country"
            }
        ));
        jTable2.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                jTable2MouseClicked(evt);
            }
        });
        jScrollPane3.setViewportView(jTable2);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 2.0;
        gridBagConstraints.weighty = 1.0;
        jPanel2.add(jScrollPane3, gridBagConstraints);

        jPanel6.setLayout(new java.awt.GridBagLayout());

        jScrollPane4.setBorder(javax.swing.BorderFactory.createTitledBorder("Evaluation Criteria"));

        jTextArea2.setEditable(false);
        jTextArea2.setBackground(new java.awt.Color(204, 204, 255));
        jTextArea2.setColumns(20);
        jTextArea2.setFont(new java.awt.Font("Purisa", 0, 12)); // NOI18N
        jTextArea2.setRows(5);
        jScrollPane4.setViewportView(jTextArea2);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(0, 10, 0, 10);
        jPanel6.add(jScrollPane4, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel2.add(jPanel6, gridBagConstraints);

        jSplitPane1.setRightComponent(jPanel2);

        jPanel3.setBackground(new java.awt.Color(204, 204, 255));
        jPanel3.setLayout(new java.awt.GridBagLayout());

        jTable1.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null},
                {null},
                {null},
                {null},
                {null},
                {null},
                {null},
                {null},
                {null},
                {null},
                {null},
                {null},
                {null},
                {null},
                {null},
                {null},
                {null},
                {null},
                {null},
                {null},
                {null},
                {null},
                {null},
                {null},
                {null},
                {null},
                {null},
                {null},
                {null},
                {null},
                {null},
                {null},
                {null},
                {null},
                {null}
            },
            new String [] {
                "Supplier"
            }
        ));
        jTable1.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                jTable1MouseClicked(evt);
            }
        });
        jScrollPane1.setViewportView(jTable1);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 2.0;
        gridBagConstraints.weighty = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(15, 0, 0, 0);
        jPanel3.add(jScrollPane1, gridBagConstraints);

        jScrollPane2.setBorder(javax.swing.BorderFactory.createTitledBorder("Comment Here"));

        jTextArea1.setColumns(20);
        jTextArea1.setRows(5);
        jScrollPane2.setViewportView(jTextArea1);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel3.add(jScrollPane2, gridBagConstraints);

        jSplitPane1.setLeftComponent(jPanel3);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 2.0;
        gridBagConstraints.weighty = 1.0;
        GeneralKeyTxtAreaPane.add(jSplitPane1, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 2.0;
        gridBagConstraints.weighty = 9.0;
        add(GeneralKeyTxtAreaPane, gridBagConstraints);

        jPanel25.setBorder(new javax.swing.border.LineBorder(new java.awt.Color(204, 204, 204), 1, true));
        jPanel25.setLayout(new java.awt.GridBagLayout());

        jButton3.setText("SAVE");
        jButton3.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton3ActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(0, 20, 0, 20);
        jPanel25.add(jButton3, gridBagConstraints);

        jButton4.setText("CLEAR");
        jButton4.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton4ActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(0, 20, 0, 20);
        jPanel25.add(jButton4, gridBagConstraints);

        jButton5.setText("HELP");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(0, 20, 0, 20);
        jPanel25.add(jButton5, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 2;
        gridBagConstraints.gridwidth = 3;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        add(jPanel25, gridBagConstraints);
    }// </editor-fold>//GEN-END:initComponents
private void searchtenders(){
//searchtendert
    java.awt.Point point = this.tendernotxt1.getLocationOnScreen();
        searchtendert.setSize(400, 200);
        searchtendert.setLocation(point);
        searchtendert.setVisible(true); 

}
    private void searchButton1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_searchButton1ActionPerformed
       
        searchtenders();

    }//GEN-LAST:event_searchButton1ActionPerformed

    private void tenderrecordstxttCaretUpdate(javax.swing.event.CaretEvent evt) {//GEN-FIRST:event_tenderrecordstxttCaretUpdate
        // TODO add your handling code here:
        if (this.tenderrecordstxtt.getCaretPosition() < 1) {
            System.out.print("Nothing");

        } else

        {
        tenderrecordstblt.setModel(com.afrisoftech.dbadmin.TableModel.createTableVectors(connectDB, " SELECT distinct a.quotation_no from st_floated_quotations a, st_floated_quotation_docs b where a.quotation_no = b.tender_no and b.tax_cert is not null and b.bid_bond is not null "));
        //nb: cert_of_incorp is not null
        tenderrecordstblt.setShowHorizontalLines(false);

        tenderrecordsspnlt.setViewportView( tenderrecordstblt);

        //            int n=0, m=0;
        //            if(tenderrecordstbl3.getValueAt(n, m)==null){
            //            java.awt.Point p = tenderrecordsspnl3.getLocationOnScreen();
            //            jLabel9.setVisible(true);
            //            jLabel9.setLocation(p);
            //            }

        }

    }//GEN-LAST:event_tenderrecordstxttCaretUpdate

    private void tenderrecordstxttActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_tenderrecordstxttActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_tenderrecordstxttActionPerformed

    private void tenderrecordstbltMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tenderrecordstbltMouseClicked
        // TODO add your handling code here:
       tendernotxt1.setText(tenderrecordstblt.getValueAt(tenderrecordstblt.getSelectedRow(), 0).toString());
       
       for (int k = 0; k < jTable1.getModel().getRowCount(); k++) {
                             for (int r = 0; r < jTable1.getModel().getColumnCount(); r++) {
                                         jTable1.getModel().setValueAt(null, k, r);
                                                 }
                                          }
       
       
       
       try {
                  java.sql.PreparedStatement cde = connectDB.prepareStatement("SELECT  distinct b.code  , a.supplier FROM st_floated_quotations a, st_suppliers b where a.supplier=b.supplier_name and a.quotation_no = '"+tendernotxt1.getText().toString()+"';");
                  
                   ResultSet a = cde.executeQuery();
                   int i= 0;
                   while (a.next()){
                   jTable1.setValueAt(a.getObject(1).toString(), i, 0);
                   
                   i++;
                   
                   
                   }

            jLabel1.setText("this form has only bidders who passed the preliminary evaluation; ONLY "+i+ "  bidders are visible for technical evaluation");
            jLabel1.setForeground(Color.red);
            jLabel1.setVisible(true);
       
            
            this.closebtnt.doClick();
                      }        
        
                  catch (Exception ex) {                         
                  ex.printStackTrace();
                  
                  }

    }//GEN-LAST:event_tenderrecordstbltMouseClicked

    private void closebtntActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_closebtntActionPerformed
        // TODO add your handling code here:
        searchtendert.dispose();
    }//GEN-LAST:event_closebtntActionPerformed

    private void jTable1MouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jTable1MouseClicked
               
        jComboBox1.setEnabled(true);
        
        try {
           
            java.sql.PreparedStatement items = connectDB.prepareStatement("SELECT    a.supplier  FROM st_floated_quotations a, st_suppliers b WHERE a.supplier=b.supplier_name AND a.quotation_no = '"+tendernotxt1.getText().toString()+"' AND  b.code= '"+jTable1.getModel().getValueAt(jTable1.getSelectedRow(), 0).toString()+"';");
         
            ResultSet populate = items.executeQuery();
            
            while (populate.next()){
            java.lang.String n = populate.getObject(1).toString();
            
            System.out.println("we are evaluating items for  ["+n+"]");
            
            
            //SELECT  distinct b.code ,a.supplier   FROM st_floated_quotations a, st_suppliers b where a.supplier=b.supplier_name and a.quotation_no ilike 'T13';
            
           // jTable2.setModel(com.afrisoftech.dbadmin.TableModel.createTableVectors(connectDB,"select  item_code CODE,item_description ITEM_DESC, days_to_deliver, brand, country_origin FROM st_floated_quotations where quotation_no ilike '"+tendernotxt1.getText().toString()+"' and supplier ilike '"+n+"' and  days_to_deliver is not null and brand is not null and country_origin is not null;"));
           
            
            jComboBox1.setModel(com.afrisoftech.lib.ComboBoxModel.ComboBoxModel(connectDB, "select distinct item_description FROM st_floated_quotations where quotation_no ilike '"+tendernotxt1.getText().toString()+"' and supplier ilike '"+n+"' "));
            }
            } 
        
        
            catch (SQLException ex) {
           ex.printStackTrace();
        }
    }//GEN-LAST:event_jTable1MouseClicked

    private void jButton4ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton4ActionPerformed
        // TODO add your handling code here:
        
         for (int k = 0; k < jTable1.getModel().getRowCount(); k++) {
                             for (int r = 0; r < jTable1.getModel().getColumnCount(); r++) {
                                         jTable1.getModel().setValueAt(null, k, r);
                                                 }
                                          }
          for (int k = 0; k < jTable2.getModel().getRowCount(); k++) {
                             for (int r = 0; r < jTable2.getModel().getColumnCount(); r++) {
                                         jTable2.getModel().setValueAt(null, k, r);
                                                 }
                                          }
          
          
          tendernotxt1.setText(null);
          jLabel1.setVisible(false);
    }//GEN-LAST:event_jButton4ActionPerformed

    private void jTable2MouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jTable2MouseClicked
        // TODO add your handling code here:
        jTextArea2.setText("Item Desc: ["+jTable2.getModel().getValueAt(jTable2.getSelectedRow(), 1).toString()+"]\n ITEM SPECS:- \n \n >>loading.Please Wait...");
    }//GEN-LAST:event_jTable2MouseClicked

    private void jButton3ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton3ActionPerformed
        try {
            // TODO add your handling code here:
            java.sql.Statement cd = connectDB.createStatement();
            ResultSet cditm = cd.executeQuery("select current_user, supplier_name from st_suppliers where code = '"+jTable1.getModel().getValueAt(jTable1.getSelectedRow(), 0)+"'");
             String name= null;
             String user =null;
             int i=0;
             
            while (cditm.next()){
            
           user = cditm.getObject(1).toString();
           name = cditm.getObject(2).toString();
           
            
            }
            
            if(jCheckBox1.isSelected()){
            
            javax.swing.JOptionPane.showMessageDialog(this , "You are approving " +jTable1.getModel().getValueAt(jTable1.getSelectedRow(), 0)+ " for Tender No: " +tendernotxt1.getText().toString()+"\n Are You Sure?");
            
            
            java.sql.PreparedStatement insert = connectDB.prepareStatement("INSERT INTO st_technical_evaluation"
             + " (quotation_no, supplier, item_desc, brand, country_orign,"
                    + " days_to_deliver, entered_by,approved)\n" +
            "VALUES (?, ?, ?, ?, ?, ?, ?,?);");
            insert.setObject(1, tendernotxt1.getText().toString());
            insert.setObject(2, name);
            insert.setObject(3, jTable2.getModel().getValueAt(i, 1));
            insert.setObject(4, jTable2.getModel().getValueAt(i, 3));
            insert.setObject(5, jTable2.getModel().getValueAt(i, 4));
            insert.setObject(6, jTable2.getModel().getValueAt(i, 2));
            
            insert.setObject(7, user);
            insert.setObject(8, true);
    
            insert.executeUpdate();
                      
            connectDB.commit();
            javax.swing.JOptionPane.showMessageDialog(this, "insert successful");
            jButton4.doClick();
        } 
            else{
                java.sql.PreparedStatement insert = connectDB.prepareStatement("INSERT INTO st_technical_evaluation"
             + " (quotation_no, supplier, item_desc, brand, country_orign,"
                    + " days_to_deliver, entered_by)\n" +
            "VALUES (?, ?, ?, ?, ?, ?, ?);");
            insert.setObject(1, tendernotxt1.getText().toString());
            insert.setObject(2, name);
            insert.setObject(3, jTable2.getModel().getValueAt(i, 1));
            insert.setObject(4, jTable2.getModel().getValueAt(i, 3));
            insert.setObject(5, jTable2.getModel().getValueAt(i, 4));
            insert.setObject(6, jTable2.getModel().getValueAt(i, 2));
            
            insert.setObject(7, user);
            
            insert.executeUpdate();
                      
            connectDB.commit();
            javax.swing.JOptionPane.showMessageDialog(this, "insert successful");
                    
             jButton4.doClick();
            }
        
        
        }
        
        
        catch (SQLException ex) {
            try {
                //Logger.getLogger(SSOGeneralEvaluaton.class.getName()).log(Level.SEVERE, null, ex);
             ex.printStackTrace();
             connectDB.rollback();
            } catch (SQLException ex1) {
                Logger.getLogger(SSOGeneralEvaluaton.class.getName()).log(Level.SEVERE, null, ex1);
            }
        }
        
        
    }//GEN-LAST:event_jButton3ActionPerformed

    private void jComboBox1ItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_jComboBox1ItemStateChanged
        try {
            int i=0;
            // TODO add your handling code here:
             java.sql.PreparedStatement items = connectDB.prepareStatement("SELECT    a.supplier  FROM st_floated_quotations a, st_suppliers b WHERE a.supplier=b.supplier_name AND a.quotation_no = '"+tendernotxt1.getText().toString()+"' AND  b.code= '"+jTable1.getModel().getValueAt(jTable1.getSelectedRow(), 0).toString()+"';");
         
            ResultSet populate = items.executeQuery();
            
            while (populate.next()){
            java.lang.String n = populate.getObject(1).toString();
            
            System.out.println("we are evaluating items for  ["+n+"]");
            
            java.sql.PreparedStatement populate1 = connectDB.prepareStatement("select days_to_deliver , brand, country_orign where quotation_no='"+tendernotxt1.getText()+"' and supplier = '"+n+"' ");
            java.sql.ResultSet rset = populate1.executeQuery();
               while(rset.next()){
               jTable2.setValueAt(rset.getObject(1), i, 0);
                jTable2.setValueAt(rset.getObject(2), i, 1);
                 jTable2.setValueAt(rset.getObject(3), i, 2);
               }
            
            
            }    
        } catch (SQLException ex) {
            Logger.getLogger(SSOGeneralEvaluaton.class.getName()).log(Level.SEVERE, null, ex);
        }
        
        
        
        
        
    }//GEN-LAST:event_jComboBox1ItemStateChanged


    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JPanel GeneralKeyTxtAreaPane;
    private javax.swing.JPanel ReportHeaderPane;
    private javax.swing.JButton closebtnt;
    private javax.swing.JButton jButton3;
    private javax.swing.JButton jButton4;
    private javax.swing.JButton jButton5;
    private javax.swing.JCheckBox jCheckBox1;
    private javax.swing.JComboBox jComboBox1;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel21;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel25;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JPanel jPanel4;
    private javax.swing.JPanel jPanel45;
    private javax.swing.JPanel jPanel5;
    private javax.swing.JPanel jPanel6;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JScrollPane jScrollPane2;
    private javax.swing.JScrollPane jScrollPane3;
    private javax.swing.JScrollPane jScrollPane4;
    private javax.swing.JSplitPane jSplitPane1;
    private javax.swing.JTable jTable1;
    private javax.swing.JTable jTable2;
    private javax.swing.JTextArea jTextArea1;
    private javax.swing.JTextArea jTextArea2;
    private javax.swing.JButton searchButton1;
    private javax.swing.JDialog searchtendert;
    private javax.swing.JTextField tendernotxt1;
    private javax.swing.JPanel tenderrecordspnlt;
    private javax.swing.JScrollPane tenderrecordsspnlt;
    private javax.swing.JTable tenderrecordstblt;
    private javax.swing.JTextField tenderrecordstxtt;
    // End of variables declaration//GEN-END:variables
}
