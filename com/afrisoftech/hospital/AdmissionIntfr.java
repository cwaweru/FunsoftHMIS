/*
 * companyprflintfr.java
 *
 * Created on August 13, 2002, 11:36 AM
 */
package com.afrisoftech.hospital;

import java.sql.SQLException;
import java.text.ParseException;
import java.util.logging.Level;
import java.util.logging.Logger;
import com.afrisoftech.lib.DBObject;
import java.beans.PropertyChangeEvent;
import java.sql.Date;

/**
 *
 * @author Charles Waweru Francis King'oi Peter Ndung'u
 */
public class AdmissionIntfr extends javax.swing.JInternalFrame {

    java.sql.Connection connectDB = null;
    com.afrisoftech.lib.DBObject dbObject;//= new com.afrisoftech.lib.DBObject();
    org.netbeans.lib.sql.pool.PooledConnectionSource pConnDB = null;
    com.afrisoftech.timeseries.YearyAgeing ageingSeries = null;
    private boolean autonumber;
    String selectedStatus = null;
    String dateOfBirth = null;
    double ageYrs = 0.00;

    //  private double rse11x = 0.00;
    public AdmissionIntfr(java.sql.Connection connDb, org.netbeans.lib.sql.pool.PooledConnectionSource pconnDB) {

        dbObject = new com.afrisoftech.lib.DBObject();

        connectDB = connDb;

        pConnDB = pconnDB;

        initComponents();

        this.setSize(com.afrisoftech.hospital.HospitalMain.saccopn.getSize());
        com.afrisoftech.dbadmin.JTable predicateTable = (com.afrisoftech.dbadmin.JTable) occupationTable;
        predicateTable.setHighlighterPipeline(predicateTable, new org.jdesktop.swing.decorator.PatternHighlighter[]{
            new org.jdesktop.swing.decorator.PatternHighlighter(java.awt.Color.YELLOW, java.awt.Color.BLACK, "HDU", 3, 4),
            new org.jdesktop.swing.decorator.PatternHighlighter(java.awt.Color.RED, java.awt.Color.BLACK, "ACUTE ROOM", 1, 4),
            new org.jdesktop.swing.decorator.PatternHighlighter(java.awt.Color.GREEN, java.awt.Color.BLACK, "General Bed", 2, 4),
            new org.jdesktop.swing.decorator.PatternHighlighter(java.awt.Color.PINK, java.awt.Color.BLACK, "ICU", 3, 4),
            new org.jdesktop.swing.decorator.PatternHighlighter(java.awt.Color.CYAN, java.awt.Color.BLACK, "E WARD", 3, 4),
            new org.jdesktop.swing.decorator.PatternHighlighter(java.awt.Color.ORANGE, java.awt.Color.BLACK, "0", 3, 8, 8),
            new org.jdesktop.swing.decorator.PatternHighlighter(java.awt.Color.MAGENTA, java.awt.Color.BLACK, ".>0.00", 3, 8, 8)
        });
        // }
        //     System.out.println("Connection Password : "+crset1.getPasswordInfo().getPassword());
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {
        java.awt.GridBagConstraints gridBagConstraints;

        jDialog2 = new javax.swing.JDialog();
        jDialog2.setSize(600,400);
        jPanel11 = new javax.swing.JPanel();
        jLabel5822 = new javax.swing.JLabel();
        jLabel661 = new javax.swing.JLabel();
        jTextField141 = new javax.swing.JTextField();
        jTextField31 = new javax.swing.JTextField();
        jLabel58211 = new javax.swing.JLabel();
        jLabel57211 = new javax.swing.JLabel();
        jTextField58211 = new javax.swing.JTextField();
        jLabel31 = new javax.swing.JLabel();
        jTextField151 = new javax.swing.JTextField();
        jLabel41 = new javax.swing.JLabel();
        jTextField41 = new javax.swing.JTextField();
        jLabel51 = new javax.swing.JLabel();
        jTextField51 = new javax.swing.JTextField();
        jPanel41 = new javax.swing.JPanel();
        jCheckBox11 = new javax.swing.JCheckBox();
        jCheckBox21 = new javax.swing.JCheckBox();
        jTextField161 = new javax.swing.JTextField();
        jPanel4 = new javax.swing.JPanel();
        jLabel32 = new javax.swing.JLabel();
        jLabel13 = new javax.swing.JLabel();
        jTextField21 = new javax.swing.JTextField();
        jButton3011 = new javax.swing.JButton();
        jButton1521 = new javax.swing.JButton();
        jButton2021 = new javax.swing.JButton();
        jButton2521 = new javax.swing.JButton();
        jButton11 = new javax.swing.JButton();
        jSeparator711 = new javax.swing.JSeparator();
        jLabel62 = new javax.swing.JLabel();
        buttonGroup1 = new javax.swing.ButtonGroup();
        ipSearchDialog = new javax.swing.JDialog();
        ipSearchPanel = new javax.swing.JPanel();
        ipSearchTxt = new javax.swing.JTextField();
        ipSearchScrollPane = new javax.swing.JScrollPane();
        ipSearchTable = new com.afrisoftech.dbadmin.JTable();
        jButton41 = new javax.swing.JButton();
        jButton51 = new javax.swing.JButton();
        opSearchDialog = new javax.swing.JDialog();
        opSearchPanel = new javax.swing.JPanel();
        opSearchFieldTxt = new javax.swing.JTextField();
        opSearchScrollPane1 = new javax.swing.JScrollPane();
        opSearchTable = new com.afrisoftech.dbadmin.JTable();
        jButton411 = new javax.swing.JButton();
        jButton511 = new javax.swing.JButton();
        jSearchDialog11 = new javax.swing.JDialog();
        jSearchPanel11 = new javax.swing.JPanel();
        jTextField1112 = new javax.swing.JTextField();
        jSearchScrollPane11 = new javax.swing.JScrollPane();
        jSearchTable11 = new com.afrisoftech.dbadmin.JTable();
        select1 = new javax.swing.JButton();
        dispose1 = new javax.swing.JButton();
        schemeSearchDialog = new javax.swing.JDialog();
        schemeSearchPanel = new javax.swing.JPanel();
        schemeSearchTxt = new javax.swing.JTextField();
        schemeSearchScrollPane = new javax.swing.JScrollPane();
        schemeSearchTable = new com.afrisoftech.dbadmin.JTable();
        schemeSearchBtn = new javax.swing.JButton();
        buttonGroup2 = new javax.swing.ButtonGroup();
        buttonGroup3 = new javax.swing.ButtonGroup();
        buttonGroup4 = new javax.swing.ButtonGroup();
        buttonGroup5 = new javax.swing.ButtonGroup();
        jSearchDialog21 = new javax.swing.JDialog();
        jSearchPanel21 = new javax.swing.JPanel();
        jTextField11131 = new javax.swing.JTextField();
        jSearchScrollPane21 = new javax.swing.JScrollPane();
        jSearchTable21 = new com.afrisoftech.dbadmin.JTable();
        jButton5121 = new javax.swing.JButton();
        previousVisitIDDialog = new javax.swing.JDialog();
        jSearchPanel3 = new javax.swing.JPanel();
        jTextField1114 = new javax.swing.JTextField();
        jSearchScrollPane3 = new javax.swing.JScrollPane();
        jSearchTable3 = new com.afrisoftech.dbadmin.JTable();
        jButton513 = new javax.swing.JButton();
        buttonGroup6 = new javax.swing.ButtonGroup();
        jSearchDialog4 = new javax.swing.JDialog();
        jSearchPanel5 = new javax.swing.JPanel();
        jTextField28 = new javax.swing.JTextField();
        jSearchScrollPane4 = new javax.swing.JScrollPane();
        jSearchTable4 = new com.afrisoftech.dbadmin.JXTable();
        disposeBtn = new javax.swing.JButton();
        ageTxt = new javax.swing.JTextField();
        jSeparator1 = new javax.swing.JSeparator();
        jLabel12 = new javax.swing.JLabel();
        admissionPanel = new javax.swing.JPanel();
        urgencyPanel = new javax.swing.JPanel();
        hospitalCategoryChkbx = new javax.swing.JCheckBox();
        privateCategoryChkbx = new javax.swing.JCheckBox();
        patientUrgencyCMBX = new javax.swing.JComboBox();
        admissionHeaderDetailPanel = new javax.swing.JPanel();
        newAdimissionRbtn = new javax.swing.JRadioButton();
        reAdmissionRbtn = new javax.swing.JRadioButton();
        createManualNumbersRbtn = new javax.swing.JRadioButton();
        searchModelPanel = new javax.swing.JPanel();
        searchbyPatientNameChkbx = new javax.swing.JCheckBox();
        searchbyPatientNumberChkbx = new javax.swing.JCheckBox();
        actionsPanel = new javax.swing.JPanel();
        admitBtn = new javax.swing.JButton();
        jButton2 = new javax.swing.JButton();
        jButton3 = new javax.swing.JButton();
        jButton4 = new javax.swing.JButton();
        jButton9 = new javax.swing.JButton();
        jButton5 = new javax.swing.JButton();
        admitPrintBtn = new javax.swing.JButton();
        reprintFileBtn = new javax.swing.JButton();
        editReprintBtn = new javax.swing.JRadioButton();
        admissionsReportBtn = new javax.swing.JButton();
        jLabel33 = new javax.swing.JLabel();
        admissionsTabbedPane = new javax.swing.JTabbedPane();
        admissionsMainPanel = new javax.swing.JPanel();
        bioDataPanel = new javax.swing.JPanel();
        diagnosisScrollPane = new javax.swing.JScrollPane();
        diagnosisTextPane = new javax.swing.JTextPane();
        demographicsPanel = new javax.swing.JPanel();
        religionLbl = new javax.swing.JLabel();
        religionCmbx = new javax.swing.JComboBox();
        placeofBirthLbl = new javax.swing.JLabel();
        districtCmbx = new javax.swing.JComboBox();
        locationLbl = new javax.swing.JLabel();
        locationTxt = new javax.swing.JTextField();
        nameofChiefLbl = new javax.swing.JLabel();
        nameofChiefTxt = new javax.swing.JTextField();
        nationalityLbl = new javax.swing.JLabel();
        nationalityCmbx = new javax.swing.JComboBox();
        residencelbl = new javax.swing.JLabel();
        currentResidence = new javax.swing.JTextField();
        biodataSubPanel = new javax.swing.JPanel();
        birthDatePanel = new javax.swing.JPanel();
        birthDateLbl = new javax.swing.JLabel();
        datePickerYOB = new com.afrisoftech.lib.DatePicker();
        patientAgeLbl = new javax.swing.JLabel();
        agelabel = new javax.swing.JLabel();
        patientAgeInputLbl = new javax.swing.JLabel();
        ageYrsTxt = new javax.swing.JTextField();
        opdNoLbl = new javax.swing.JLabel();
        opdNoPanel = new javax.swing.JPanel();
        opdNoTxt = new javax.swing.JTextField();
        opdSearchButton = new javax.swing.JButton();
        admissionNoPanel = new javax.swing.JPanel();
        admissionNumberTxt = new javax.swing.JTextField();
        searchButton = new javax.swing.JButton();
        admissionNolbl = new javax.swing.JLabel();
        surNameLbl = new javax.swing.JLabel();
        surNameTxt = new javax.swing.JTextField();
        otherNamesLbl = new javax.swing.JLabel();
        firstNameTxt = new javax.swing.JTextField();
        genderLbl = new javax.swing.JLabel();
        genderpanel = new javax.swing.JPanel();
        maleChkbx = new javax.swing.JCheckBox();
        femaleChkbx = new javax.swing.JCheckBox();
        maritalStatusPanel = new javax.swing.JPanel();
        singleMaritalChkbx = new javax.swing.JCheckBox();
        marriedMaritalChkbx = new javax.swing.JCheckBox();
        divorcedMaritalChkbx = new javax.swing.JCheckBox();
        widowedMaritalChkbx = new javax.swing.JCheckBox();
        maritalStatusLbl = new javax.swing.JLabel();
        admissionInstancePanel = new javax.swing.JPanel();
        wardLbl = new javax.swing.JLabel();
        admissionWardCmbx = new javax.swing.JComboBox();
        wardCodeLbl = new javax.swing.JLabel();
        wardCodeTxt = new javax.swing.JTextField();
        bedNoLbl = new javax.swing.JLabel();
        bedNumberCmbx = new javax.swing.JComboBox();
        bedCategoryLbl = new javax.swing.JLabel();
        bedCategoryCmbx = new javax.swing.JComboBox();
        bedRateLbl = new javax.swing.JLabel();
        bedRateTxt = new javax.swing.JTextField();
        admittedByPanel = new javax.swing.JPanel();
        admittedByTxt = new javax.swing.JTextField();
        admittedByBtn = new javax.swing.JButton();
        admittedByLbl = new javax.swing.JLabel();
        specialityLbl = new javax.swing.JLabel();
        specialtyClinicCmbx = new javax.swing.JComboBox();
        referredFromLbl = new javax.swing.JLabel();
        wardAdmittedLbl = new javax.swing.JLabel();
        wardAdmittedTxt = new javax.swing.JTextField();
        bedOccupiedLbl = new javax.swing.JLabel();
        bedoccupiedTxt = new javax.swing.JTextField();
        previousDischargeDateLbl = new javax.swing.JLabel();
        previousDischargeDateTxt = new javax.swing.JTextField();
        admissionDateLbl = new javax.swing.JLabel();
        admissionDatePicker = new com.afrisoftech.lib.DatePicker();
        previousVisitIDLbl = new javax.swing.JLabel();
        previousVisitIDPanel = new javax.swing.JPanel();
        previousVisitIDTxt = new javax.swing.JTextField();
        previousVisitSearchButton = new javax.swing.JButton();
        previousAdmissionDateTxt = new javax.swing.JTextField();
        previousAdmissionDateLbl = new javax.swing.JLabel();
        registrationPointLbl = new javax.swing.JLabel();
        registrationPointCmbx = new javax.swing.JComboBox();
        previousAdmissionsLbl = new javax.swing.JLabel();
        disabilityStatusLbl = new javax.swing.JLabel();
        patientDisabilityCmbx = new javax.swing.JComboBox();
        patientDebtTxt = new javax.swing.JTextField();
        referredcombo = new javax.swing.JComboBox();
        otherDetailsPanel = new javax.swing.JPanel();
        oldFileNumberLbl = new javax.swing.JLabel();
        unitNumberTxt = new javax.swing.JTextField();
        occupationLbl = new javax.swing.JLabel();
        occupationCmbx = new javax.swing.JComboBox();
        idNumberLbl = new javax.swing.JLabel();
        idPassportTxt = new javax.swing.JTextField();
        telephoneNoLbl = new javax.swing.JLabel();
        nokTelephoneTxt = new javax.swing.JTextField();
        jPanel14 = new javax.swing.JPanel();
        jPanel2 = new javax.swing.JPanel();
        nokNameLbl = new javax.swing.JLabel();
        nokNameTxt = new javax.swing.JTextField();
        postalAddressLbl = new javax.swing.JLabel();
        postalAddressTxt = new javax.swing.JTextField();
        modeofPaymentLbl = new javax.swing.JLabel();
        billPayerTxt = new javax.swing.JTextField();
        billPayerLbl = new javax.swing.JLabel();
        paymentModeCmbx = new javax.swing.JComboBox();
        nhifChbx = new javax.swing.JCheckBox();
        patientStatusPanel = new javax.swing.JPanel();
        admittedChbx = new javax.swing.JCheckBox();
        dischargedChkbx = new javax.swing.JCheckBox();
        hasInterimBillChkbx = new javax.swing.JCheckBox();
        suspendBillChkbx = new javax.swing.JCheckBox();
        mergeOPBillChkbx = new javax.swing.JCheckBox();
        cardMaturityDateLbl = new javax.swing.JLabel();
        cardMaturityDatePicker = new com.afrisoftech.lib.DatePicker();
        nokRelationLbl = new javax.swing.JLabel();
        nokRelationShipCmbx = new javax.swing.JComboBox();
        nokResidenceLbl = new javax.swing.JLabel();
        nokResidenceTxt = new javax.swing.JTextField();
        clinicNumberLbl = new javax.swing.JLabel();
        clinicFileNumberTxt = new javax.swing.JTextField();
        nhifReferenceNoLbl = new javax.swing.JLabel();
        nhifClaimNumberTxt = new javax.swing.JTextField();
        countyofBirthLbl = new javax.swing.JLabel();
        countyofResidenceLbl = new javax.swing.JLabel();
        countyofBirthCmbx = new javax.swing.JComboBox();
        countyofResidenceCmbx = new javax.swing.JComboBox();
        employerNameLbl = new javax.swing.JLabel();
        employerTxt = new javax.swing.JTextField();
        employerTelLbl = new javax.swing.JLabel();
        employerTelTxt = new javax.swing.JTextField();
        chargeSheetNoLbl = new javax.swing.JLabel();
        cSheetNoTxt = new javax.swing.JTextField();
        educationLevelLbl = new javax.swing.JLabel();
        educationLevelCmbx = new javax.swing.JComboBox();
        nhifCardNoLbl = new javax.swing.JLabel();
        nhifCardMemberNumberTxt = new javax.swing.JTextField();
        nokTelLbl = new javax.swing.JLabel();
        nokteltxt = new javax.swing.JTextField();
        bankCardsPanel = new javax.swing.JPanel();
        bankCardsPanel.setVisible(false);
        cardNameLbl = new javax.swing.JLabel();
        cardNameCmbx = new javax.swing.JComboBox();
        cardIssurerTxt = new javax.swing.JTextField();
        cardUssurerLbl = new javax.swing.JLabel();
        cardNoLbl = new javax.swing.JLabel();
        cardNumberTxt = new javax.swing.JTextField();
        cardExpiryDateLbl = new javax.swing.JLabel();
        cardExpiryDatePicker = new com.afrisoftech.lib.DatePicker();
        schemePanel = new javax.swing.JPanel();
        schemePanel.setVisible(false);
        memberNameLbl = new javax.swing.JLabel();
        memberNoLbl = new javax.swing.JLabel();
        schemeExpiryDateLbl = new javax.swing.JLabel();
        schemeManagerLbl = new javax.swing.JLabel();
        schemeMangerTxt = new javax.swing.JTextField();
        schemeNameLbl = new javax.swing.JLabel();
        schemeMemberNamePanel = new javax.swing.JPanel();
        memberNameTxt = new javax.swing.JTextField();
        memberNameSearchButton = new javax.swing.JButton();
        memberNumberTxt = new javax.swing.JTextField();
        schemeSearchNamePanel = new javax.swing.JPanel();
        schemeNameTxt = new javax.swing.JTextField();
        schemeSearchButton = new javax.swing.JButton();
        schemeAccNoLbl = new javax.swing.JLabel();
        schemeAccNoTxt = new javax.swing.JTextField();
        memberBalanceLbl = new javax.swing.JLabel();
        memberBalanceTxt = new javax.swing.JTextField();
        schemeExpiryDatePicker = new com.afrisoftech.lib.DatePicker();
        admissionListingPanel = new javax.swing.JPanel();
        refreshScrollPane = new javax.swing.JScrollPane();
        admissionListingTable = new com.afrisoftech.dbadmin.JTable();
        startDateLbl = new javax.swing.JLabel();
        endDateLbl = new javax.swing.JLabel();
        startDatePicker = new com.afrisoftech.lib.DatePicker();
        endDatePicker = new com.afrisoftech.lib.DatePicker();
        refreshBtn = new javax.swing.JButton();
        reportTypeChooserCmbx = new javax.swing.JComboBox();
        spacerLabel = new javax.swing.JLabel();
        admissionAnalysisPanel = new javax.swing.JPanel();
        admissionScrollPane = new javax.swing.JScrollPane();
        admissionAnalysisTable = new com.afrisoftech.dbadmin.JTable();
        startDateLbl1 = new javax.swing.JLabel();
        endDateLbl1 = new javax.swing.JLabel();
        startDatePicker1 = new com.afrisoftech.lib.DatePicker();
        endDatePicker1 = new com.afrisoftech.lib.DatePicker();
        refreshBtn1 = new javax.swing.JButton();
        reportTypeChooserCmbx1 = new javax.swing.JComboBox();
        spacerLabel1 = new javax.swing.JLabel();
        occupancyReportPanel = new javax.swing.JPanel();
        occupationsHeaderTable = new javax.swing.JPanel();
        wardNameCmbx = new javax.swing.JComboBox();
        jLabel49 = new javax.swing.JLabel();
        patientNumber = new javax.swing.JTextField();
        searchFileBtn = new javax.swing.JButton();
        occupationsPanel = new javax.swing.JPanel();
        occupationJScrl = new javax.swing.JScrollPane();
        occupationTable = new com.afrisoftech.dbadmin.JTable(){
            Class[] types = new Class [] {
                java.lang.Object.class, java.lang.Object.class, java.lang.Object.class, java.lang.Object.class, java.lang.Object.class, java.lang.Object.class, java.lang.Boolean.class, java.lang.Object.class, java.lang.Double.class
            };
            boolean[] canEdit = new boolean [] {
                false, false, false, false, false, false, true, true, false
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        };
        occupationButtonPanel = new javax.swing.JPanel();
        jButton7 = new javax.swing.JButton();
        jButton8 = new javax.swing.JButton();
        jButton10 = new javax.swing.JButton();
        totalsLabel = new javax.swing.JLabel();
        previousPanel = new javax.swing.JPanel();
        previousVisitsScrollPane = new javax.swing.JScrollPane();
        previousVisitsTable = new com.afrisoftech.dbadmin.JXTable();

        jDialog2.setTitle("New Patient Registar");
        jDialog2.setModal(true);
        jDialog2.getContentPane().setLayout(new java.awt.GridBagLayout());

        jPanel11.setBorder(javax.swing.BorderFactory.createTitledBorder("Enter patient details here"));
        jPanel11.setLayout(new java.awt.GridBagLayout());

        jLabel5822.setText("Surname");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 2;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel11.add(jLabel5822, gridBagConstraints);

        jLabel661.setText("Year of Birth");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 3;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel11.add(jLabel661, gridBagConstraints);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 3;
        gridBagConstraints.gridy = 3;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 10);
        jPanel11.add(jTextField141, gridBagConstraints);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 3;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 3.0;
        gridBagConstraints.weighty = 1.0;
        jPanel11.add(jTextField31, gridBagConstraints);

        jLabel58211.setText("Other Names");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 3;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel11.add(jLabel58211, gridBagConstraints);

        jLabel57211.setText("Address");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 5;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel11.add(jLabel57211, gridBagConstraints);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 3;
        gridBagConstraints.gridy = 4;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 10);
        jPanel11.add(jTextField58211, gridBagConstraints);

        jLabel31.setText("Residence");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 2;
        jPanel11.add(jLabel31, gridBagConstraints);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 4;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel11.add(jTextField151, gridBagConstraints);

        jLabel41.setText("Next of kin");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 4;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel11.add(jLabel41, gridBagConstraints);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 3;
        gridBagConstraints.gridy = 2;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 10);
        jPanel11.add(jTextField41, gridBagConstraints);

        jLabel51.setText("Telephone");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 4;
        jPanel11.add(jLabel51, gridBagConstraints);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 5;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 10);
        jPanel11.add(jTextField51, gridBagConstraints);

        jPanel41.setBorder(javax.swing.BorderFactory.createTitledBorder("Gender"));
        jPanel41.setLayout(new java.awt.GridBagLayout());

        buttonGroup1.add(jCheckBox11);
        jCheckBox11.setText("Male ");
        jCheckBox11.setHorizontalTextPosition(javax.swing.SwingConstants.LEADING);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 7;
        jPanel41.add(jCheckBox11, gridBagConstraints);

        buttonGroup1.add(jCheckBox21);
        jCheckBox21.setText("Female ");
        jCheckBox21.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jCheckBox21.setHorizontalTextPosition(javax.swing.SwingConstants.LEADING);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 3;
        gridBagConstraints.gridy = 7;
        jPanel41.add(jCheckBox21, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 3;
        gridBagConstraints.gridy = 5;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(10, 0, 10, 10);
        jPanel11.add(jPanel41, gridBagConstraints);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 2;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel11.add(jTextField161, gridBagConstraints);

        jPanel4.setLayout(new java.awt.GridBagLayout());
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 5;
        jPanel11.add(jPanel4, gridBagConstraints);

        jLabel32.setText("O/P No.");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.weightx = 1.0;
        jPanel11.add(jLabel32, gridBagConstraints);

        jLabel13.setText("Admission No.");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 1;
        jPanel11.add(jLabel13, gridBagConstraints);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 3;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 10);
        jPanel11.add(jTextField21, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.gridwidth = 5;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTH;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 10.0;
        gridBagConstraints.insets = new java.awt.Insets(10, 10, 10, 10);
        jDialog2.getContentPane().add(jPanel11, gridBagConstraints);

        jButton3011.setMnemonic('O');
        jButton3011.setText("Ok");
        jButton3011.setToolTipText("Click here to enter data");
        jButton3011.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton3011ActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 10;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jDialog2.getContentPane().add(jButton3011, gridBagConstraints);

        jButton1521.setMnemonic('E');
        jButton1521.setText("Edit");
        jButton1521.setToolTipText("Click here to edit data");
        jButton1521.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton1521ActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 10;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jDialog2.getContentPane().add(jButton1521, gridBagConstraints);

        jButton2021.setMnemonic('n');
        jButton2021.setText("Clear");
        jButton2021.setToolTipText("Click here to clear fields");
        jButton2021.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton2021ActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 10;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jDialog2.getContentPane().add(jButton2021, gridBagConstraints);

        jButton2521.setMnemonic('c');
        jButton2521.setText("Close");
        jButton2521.setToolTipText("Click here to close window");
        jButton2521.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton2521ActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 3;
        gridBagConstraints.gridy = 10;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jDialog2.getContentPane().add(jButton2521, gridBagConstraints);

        jButton11.setMnemonic('h');
        jButton11.setText("Help");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 4;
        gridBagConstraints.gridy = 10;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jDialog2.getContentPane().add(jButton11, gridBagConstraints);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 8;
        gridBagConstraints.gridwidth = 5;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        jDialog2.getContentPane().add(jSeparator711, gridBagConstraints);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 9;
        gridBagConstraints.gridwidth = 3;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        jDialog2.getContentPane().add(jLabel62, gridBagConstraints);

        ipSearchDialog.setModal(true);
        ipSearchDialog.setUndecorated(true);
        ipSearchDialog.getContentPane().setLayout(new java.awt.GridBagLayout());

        ipSearchPanel.setBorder(javax.swing.BorderFactory.createEtchedBorder());
        ipSearchPanel.setLayout(new java.awt.GridBagLayout());

        ipSearchTxt.addCaretListener(new javax.swing.event.CaretListener() {
            public void caretUpdate(javax.swing.event.CaretEvent evt) {
                ipSearchTxtCaretUpdate(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 300.0;
        gridBagConstraints.weighty = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 5);
        ipSearchPanel.add(ipSearchTxt, gridBagConstraints);

        ipSearchTable.setToolTipText("Click on the target row to select the patient from the search.");
        ipSearchTable.setShowHorizontalLines(false);
        /*javax.swing.table.TableColumn column = null;

        for (int i = 0; i < 4; i++) {

            column = ipSearchTable.getColumnModel().getColumn(i);

            if (i == 1) {

                column.setPreferredWidth(400);
                //sport column is bigger
            } else {

                column.setPreferredWidth(200);

            }
        }
        */
        ipSearchTable.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                ipSearchTableMouseClicked(evt);
            }
        });
        ipSearchScrollPane.setViewportView(ipSearchTable);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.gridwidth = 3;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 20.0;
        ipSearchPanel.add(ipSearchScrollPane, gridBagConstraints);

        jButton41.setText("Select");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        ipSearchPanel.add(jButton41, gridBagConstraints);

        jButton51.setText("Close");
        jButton51.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton51ActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        ipSearchPanel.add(jButton51, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        ipSearchDialog.getContentPane().add(ipSearchPanel, gridBagConstraints);

        opSearchDialog.setModal(true);
        opSearchDialog.setUndecorated(true);
        opSearchDialog.getContentPane().setLayout(new java.awt.GridBagLayout());

        opSearchPanel.setBorder(javax.swing.BorderFactory.createEtchedBorder());
        opSearchPanel.setLayout(new java.awt.GridBagLayout());

        opSearchFieldTxt.addCaretListener(new javax.swing.event.CaretListener() {
            public void caretUpdate(javax.swing.event.CaretEvent evt) {
                opSearchFieldTxtCaretUpdate(evt);
            }
        });
        opSearchFieldTxt.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                opSearchFieldTxtActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 300.0;
        gridBagConstraints.weighty = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 5);
        opSearchPanel.add(opSearchFieldTxt, gridBagConstraints);

        opSearchTable.setToolTipText("Click on the target row to select the patient from the search.");
        opSearchTable.setShowHorizontalLines(false);
        /*javax.swing.table.TableColumn column = null;

        for (int i = 0; i < 4; i++) {

            column = ipSearchTable.getColumnModel().getColumn(i);

            if (i == 1) {

                column.setPreferredWidth(400);
                //sport column is bigger
            } else {

                column.setPreferredWidth(200);

            }
        }
        */
        opSearchTable.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                opSearchTableMouseClicked(evt);
            }
        });
        opSearchScrollPane1.setViewportView(opSearchTable);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.gridwidth = 3;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 20.0;
        opSearchPanel.add(opSearchScrollPane1, gridBagConstraints);

        jButton411.setText("Select");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        opSearchPanel.add(jButton411, gridBagConstraints);

        jButton511.setText("Close");
        jButton511.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton511ActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        opSearchPanel.add(jButton511, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        opSearchDialog.getContentPane().add(opSearchPanel, gridBagConstraints);

        jSearchDialog11.setUndecorated(true);
        jSearchDialog11.getContentPane().setLayout(new java.awt.GridBagLayout());

        jSearchPanel11.setBorder(javax.swing.BorderFactory.createEtchedBorder());
        jSearchPanel11.setLayout(new java.awt.GridBagLayout());

        jTextField1112.addCaretListener(new javax.swing.event.CaretListener() {
            public void caretUpdate(javax.swing.event.CaretEvent evt) {
                jTextField1112CaretUpdate(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 300.0;
        gridBagConstraints.weighty = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 5);
        jSearchPanel11.add(jTextField1112, gridBagConstraints);

        jSearchTable11.setToolTipText("Click on the target row to select the patient from the search.");
        jSearchTable11.setShowHorizontalLines(false);
        /*int rowsNo = 0;
        //try {

            crset1.setCommand("SELECT patient_no, (upper(first_name||' '||second_name||' '||last_name)) as name, year_of_birth, residence from hp_patient_register order by name");

            crset1.setConnectionSource(pConnDB);

            // try {
                //crset1.execute();

                // crset2.setExecuteOnLoad(true);
                ipSearchTable.setModel(new org.netbeans.lib.sql.models.TableModel(crset1, new org.netbeans.lib.sql.models.TableModel.Column[] {
                    new org.netbeans.lib.sql.models.TableModel.Column("patient_no", "Patient No.", false),
                    new org.netbeans.lib.sql.models.TableModel.Column("name", "Name", false),

                    new org.netbeans.lib.sql.models.TableModel.Column("year_of_birth", "Birth date", true),
                    new org.netbeans.lib.sql.models.TableModel.Column("residence", "Residence", true)

                }));

                tableModel = ipSearchTable.getModel();

                ipSearchScrollPane.setViewportView(ipSearchTable);

                /*   }catch(java.sql.SQLException sqlex){
                javax.swing.JOptionPane.showMessageDialog(this,sqlex.getMessage(),"Error Message!",javax.swing.JOptionPane.ERROR_MESSAGE);

                System.out.println(sqlex.getMessage());

            }

            javax.swing.table.TableColumn column = null;

            for (int i = 0; i < 4; i++) {

                column = ipSearchTable.getColumnModel().getColumn(i);

                if (i == 1) {

                    column.setPreferredWidth(400);
                    //sport column is bigger
                } else {

                    column.setPreferredWidth(200);

                }
            }*/
            jSearchTable11.addMouseListener(new java.awt.event.MouseAdapter() {
                public void mouseClicked(java.awt.event.MouseEvent evt) {
                    jSearchTable11MouseClicked(evt);
                }
            });
            jSearchScrollPane11.setViewportView(jSearchTable11);

            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 1;
            gridBagConstraints.gridwidth = 3;
            gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 20.0;
            jSearchPanel11.add(jSearchScrollPane11, gridBagConstraints);

            select1.setText("Select");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 1;
            gridBagConstraints.gridy = 0;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            jSearchPanel11.add(select1, gridBagConstraints);

            dispose1.setMnemonic('l');
            dispose1.setText("Close");
            dispose1.addActionListener(new java.awt.event.ActionListener() {
                public void actionPerformed(java.awt.event.ActionEvent evt) {
                    dispose1ActionPerformed(evt);
                }
            });
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 2;
            gridBagConstraints.gridy = 0;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            jSearchPanel11.add(dispose1, gridBagConstraints);

            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 1;
            gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            jSearchDialog11.getContentPane().add(jSearchPanel11, gridBagConstraints);

            schemeSearchDialog.setModal(true);
            schemeSearchDialog.setUndecorated(true);
            schemeSearchDialog.getContentPane().setLayout(new java.awt.GridBagLayout());

            schemeSearchPanel.setBorder(javax.swing.BorderFactory.createEtchedBorder());
            schemeSearchPanel.setLayout(new java.awt.GridBagLayout());

            schemeSearchTxt.addCaretListener(new javax.swing.event.CaretListener() {
                public void caretUpdate(javax.swing.event.CaretEvent evt) {
                    schemeSearchTxtCaretUpdate(evt);
                }
            });
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 0;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 300.0;
            gridBagConstraints.weighty = 1.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 5);
            schemeSearchPanel.add(schemeSearchTxt, gridBagConstraints);

            schemeSearchTable.setToolTipText("Click on the target row to select the patient from the search.");
            schemeSearchTable.setShowHorizontalLines(false);
            /*javax.swing.table.TableColumn column = null;

            for (int i = 0; i < 4; i++) {

                column = ipSearchTable.getColumnModel().getColumn(i);

                if (i == 1) {

                    column.setPreferredWidth(400);
                    //sport column is bigger
                } else {

                    column.setPreferredWidth(200);

                }
            }
            */
            schemeSearchTable.addMouseListener(new java.awt.event.MouseAdapter() {
                public void mouseClicked(java.awt.event.MouseEvent evt) {
                    schemeSearchTableMouseClicked(evt);
                }
            });
            schemeSearchScrollPane.setViewportView(schemeSearchTable);

            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 1;
            gridBagConstraints.gridwidth = 3;
            gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 20.0;
            schemeSearchPanel.add(schemeSearchScrollPane, gridBagConstraints);

            schemeSearchBtn.setText("Close");
            schemeSearchBtn.addActionListener(new java.awt.event.ActionListener() {
                public void actionPerformed(java.awt.event.ActionEvent evt) {
                    schemeSearchBtnActionPerformed(evt);
                }
            });
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 2;
            gridBagConstraints.gridy = 0;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            schemeSearchPanel.add(schemeSearchBtn, gridBagConstraints);

            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 1;
            gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            schemeSearchDialog.getContentPane().add(schemeSearchPanel, gridBagConstraints);

            jSearchDialog21.setModal(true);
            jSearchDialog21.setUndecorated(true);
            jSearchDialog21.getContentPane().setLayout(new java.awt.GridBagLayout());

            jSearchPanel21.setBorder(javax.swing.BorderFactory.createEtchedBorder());
            jSearchPanel21.setLayout(new java.awt.GridBagLayout());

            jTextField11131.addCaretListener(new javax.swing.event.CaretListener() {
                public void caretUpdate(javax.swing.event.CaretEvent evt) {
                    jTextField11131CaretUpdate(evt);
                }
            });
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 1;
            gridBagConstraints.gridy = 0;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 300.0;
            gridBagConstraints.weighty = 1.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 5);
            jSearchPanel21.add(jTextField11131, gridBagConstraints);

            jSearchTable21.setToolTipText("Click on the target row to select the patient from the search.");
            jSearchTable21.setShowHorizontalLines(false);
            /*javax.swing.table.TableColumn column = null;

            for (int i = 0; i < 4; i++) {

                column = ipSearchTable.getColumnModel().getColumn(i);

                if (i == 1) {

                    column.setPreferredWidth(400);
                    //sport column is bigger
                } else {

                    column.setPreferredWidth(200);

                }
            }
            */
            jSearchTable21.addMouseListener(new java.awt.event.MouseAdapter() {
                public void mouseClicked(java.awt.event.MouseEvent evt) {
                    jSearchTable21MouseClicked(evt);
                }
            });
            jSearchScrollPane21.setViewportView(jSearchTable21);

            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 1;
            gridBagConstraints.gridwidth = 3;
            gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 20.0;
            jSearchPanel21.add(jSearchScrollPane21, gridBagConstraints);

            jButton5121.setText("Close");
            jButton5121.addActionListener(new java.awt.event.ActionListener() {
                public void actionPerformed(java.awt.event.ActionEvent evt) {
                    jButton5121ActionPerformed(evt);
                }
            });
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 2;
            gridBagConstraints.gridy = 0;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            jSearchPanel21.add(jButton5121, gridBagConstraints);

            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 1;
            gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            jSearchDialog21.getContentPane().add(jSearchPanel21, gridBagConstraints);

            previousVisitIDDialog.setModal(true);
            previousVisitIDDialog.setUndecorated(true);
            previousVisitIDDialog.getContentPane().setLayout(new java.awt.GridBagLayout());

            jSearchPanel3.setBorder(javax.swing.BorderFactory.createEtchedBorder());
            jSearchPanel3.setLayout(new java.awt.GridBagLayout());

            jTextField1114.addCaretListener(new javax.swing.event.CaretListener() {
                public void caretUpdate(javax.swing.event.CaretEvent evt) {
                    jTextField1114CaretUpdate(evt);
                }
            });
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 1;
            gridBagConstraints.gridy = 0;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 300.0;
            gridBagConstraints.weighty = 1.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 5);
            jSearchPanel3.add(jTextField1114, gridBagConstraints);

            jSearchTable3.setToolTipText("Click on the target row to select the patient from the search.");
            jSearchTable3.setShowHorizontalLines(false);
            /*javax.swing.table.TableColumn column = null;

            for (int i = 0; i < 4; i++) {

                column = ipSearchTable.getColumnModel().getColumn(i);

                if (i == 1) {

                    column.setPreferredWidth(400);
                    //sport column is bigger
                } else {

                    column.setPreferredWidth(200);

                }
            }
            */
            jSearchTable3.addMouseListener(new java.awt.event.MouseAdapter() {
                public void mouseClicked(java.awt.event.MouseEvent evt) {
                    jSearchTable3MouseClicked(evt);
                }
            });
            jSearchScrollPane3.setViewportView(jSearchTable3);

            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 1;
            gridBagConstraints.gridwidth = 4;
            gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 20.0;
            jSearchPanel3.add(jSearchScrollPane3, gridBagConstraints);

            jButton513.setText("Close");
            jButton513.addActionListener(new java.awt.event.ActionListener() {
                public void actionPerformed(java.awt.event.ActionEvent evt) {
                    jButton513ActionPerformed(evt);
                }
            });
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 0;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            jSearchPanel3.add(jButton513, gridBagConstraints);

            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 1;
            gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            previousVisitIDDialog.getContentPane().add(jSearchPanel3, gridBagConstraints);

            jSearchDialog4.setAutoRequestFocus(false);
            jSearchDialog4.setFocusable(false);
            jSearchDialog4.setFocusableWindowState(false);
            jSearchDialog4.setUndecorated(true);
            jSearchDialog4.setResizable(false);
            jSearchDialog4.getContentPane().setLayout(new java.awt.GridBagLayout());

            jSearchPanel5.setLayout(new java.awt.GridBagLayout());

            jTextField28.setEditable(false);
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
            gridBagConstraints.weightx = 100.0;
            gridBagConstraints.weighty = 1.0;
            jSearchPanel5.add(jTextField28, gridBagConstraints);

            jSearchTable4.setModel(new javax.swing.table.DefaultTableModel(
                new Object [][] {

                },
                new String [] {

                }
            ));
            jSearchScrollPane4.setViewportView(jSearchTable4);

            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 1;
            gridBagConstraints.gridwidth = 2;
            gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 300.0;
            jSearchPanel5.add(jSearchScrollPane4, gridBagConstraints);

            disposeBtn.setText("Cancel");
            disposeBtn.addActionListener(new java.awt.event.ActionListener() {
                public void actionPerformed(java.awt.event.ActionEvent evt) {
                    disposeBtnActionPerformed(evt);
                }
            });
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 1;
            gridBagConstraints.gridy = 0;
            gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            jSearchPanel5.add(disposeBtn, gridBagConstraints);

            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 1;
            gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 100.0;
            jSearchDialog4.getContentPane().add(jSearchPanel5, gridBagConstraints);

            ageTxt.setToolTipText("Enter age of patient here");
            ageTxt.setBorder(javax.swing.BorderFactory.createEtchedBorder());
            ageTxt.addCaretListener(new javax.swing.event.CaretListener() {
                public void caretUpdate(javax.swing.event.CaretEvent evt) {
                    ageTxtCaretUpdate(evt);
                }
            });

            setClosable(true);
            setDefaultCloseOperation(javax.swing.WindowConstants.HIDE_ON_CLOSE);
            setIconifiable(true);
            setMaximizable(true);
            setResizable(true);
            setTitle("Patient Admission File - Form 301");
            setToolTipText("Company profile form");
            setVisible(true);
            getContentPane().setLayout(new java.awt.GridBagLayout());
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 4;
            gridBagConstraints.gridwidth = 5;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            getContentPane().add(jSeparator1, gridBagConstraints);

            jLabel12.setFont(new java.awt.Font("Utopia", 3, 18)); // NOI18N
            jLabel12.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 6;
            gridBagConstraints.gridwidth = 5;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            getContentPane().add(jLabel12, gridBagConstraints);

            admissionPanel.setBackground(new java.awt.Color(255, 239, 255));
            admissionPanel.setBorder(javax.swing.BorderFactory.createTitledBorder(""));
            admissionPanel.setLayout(new java.awt.GridBagLayout());

            urgencyPanel.setBackground(new java.awt.Color(255, 239, 255));
            urgencyPanel.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Category", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Dialog", 0, 10), new java.awt.Color(255, 0, 255))); // NOI18N
            urgencyPanel.setLayout(new java.awt.GridBagLayout());

            hospitalCategoryChkbx.setBackground(new java.awt.Color(255, 239, 255));
            buttonGroup3.add(hospitalCategoryChkbx);
            hospitalCategoryChkbx.setSelected(true);
            hospitalCategoryChkbx.setText("Hospital");
            hospitalCategoryChkbx.setHorizontalTextPosition(javax.swing.SwingConstants.LEADING);
            hospitalCategoryChkbx.setIconTextGap(0);
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 0;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            urgencyPanel.add(hospitalCategoryChkbx, gridBagConstraints);

            privateCategoryChkbx.setBackground(new java.awt.Color(255, 239, 255));
            buttonGroup3.add(privateCategoryChkbx);
            privateCategoryChkbx.setText("Private");
            privateCategoryChkbx.setHorizontalTextPosition(javax.swing.SwingConstants.LEADING);
            privateCategoryChkbx.setIconTextGap(0);
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 2;
            gridBagConstraints.gridy = 0;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            urgencyPanel.add(privateCategoryChkbx, gridBagConstraints);

            patientUrgencyCMBX.setFont(new java.awt.Font("Tahoma", 1, 12)); // NOI18N
            patientUrgencyCMBX.setForeground(new java.awt.Color(255, 0, 51));
            patientUrgencyCMBX.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "Select Patient Urgency", "Emergency", "Normal" }));
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 3;
            gridBagConstraints.gridy = 0;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            urgencyPanel.add(patientUrgencyCMBX, gridBagConstraints);

            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 5;
            gridBagConstraints.gridy = 0;
            gridBagConstraints.weightx = 1.0;
            admissionPanel.add(urgencyPanel, gridBagConstraints);

            admissionHeaderDetailPanel.setBackground(new java.awt.Color(255, 239, 255));
            admissionHeaderDetailPanel.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Tick where appropriate", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Dialog", 0, 10))); // NOI18N
            admissionHeaderDetailPanel.setLayout(new java.awt.GridBagLayout());

            newAdimissionRbtn.setBackground(new java.awt.Color(255, 239, 255));
            buttonGroup5.add(newAdimissionRbtn);
            newAdimissionRbtn.setText("New Admission File");
            newAdimissionRbtn.setHorizontalTextPosition(javax.swing.SwingConstants.LEADING);
            newAdimissionRbtn.setIconTextGap(1);
            newAdimissionRbtn.addActionListener(new java.awt.event.ActionListener() {
                public void actionPerformed(java.awt.event.ActionEvent evt) {
                    newAdimissionRbtnActionPerformed(evt);
                }
            });
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 0;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            admissionHeaderDetailPanel.add(newAdimissionRbtn, gridBagConstraints);

            reAdmissionRbtn.setBackground(new java.awt.Color(255, 239, 255));
            buttonGroup5.add(reAdmissionRbtn);
            reAdmissionRbtn.setText("Re-Admission");
            reAdmissionRbtn.setHorizontalTextPosition(javax.swing.SwingConstants.LEADING);
            reAdmissionRbtn.setIconTextGap(0);
            reAdmissionRbtn.addActionListener(new java.awt.event.ActionListener() {
                public void actionPerformed(java.awt.event.ActionEvent evt) {
                    reAdmissionRbtnActionPerformed(evt);
                }
            });
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 3;
            gridBagConstraints.gridy = 0;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            admissionHeaderDetailPanel.add(reAdmissionRbtn, gridBagConstraints);

            createManualNumbersRbtn.setVisible(false);
            createManualNumbersRbtn.setBackground(new java.awt.Color(204, 204, 204));
            buttonGroup5.add(createManualNumbersRbtn);
            createManualNumbersRbtn.setForeground(new java.awt.Color(51, 51, 255));
            createManualNumbersRbtn.setSelected(true);
            createManualNumbersRbtn.setText("Create Old Patient File");
            createManualNumbersRbtn.setEnabled(false);
            createManualNumbersRbtn.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
            createManualNumbersRbtn.setHorizontalTextPosition(javax.swing.SwingConstants.LEADING);
            createManualNumbersRbtn.addActionListener(new java.awt.event.ActionListener() {
                public void actionPerformed(java.awt.event.ActionEvent evt) {
                    createManualNumbersRbtnActionPerformed(evt);
                }
            });
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 1;
            gridBagConstraints.gridy = 0;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            admissionHeaderDetailPanel.add(createManualNumbersRbtn, gridBagConstraints);

            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 0;
            gridBagConstraints.gridwidth = 2;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            admissionPanel.add(admissionHeaderDetailPanel, gridBagConstraints);

            searchModelPanel.setBackground(new java.awt.Color(255, 239, 255));
            searchModelPanel.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Search By", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Dialog", 0, 10), new java.awt.Color(0, 0, 255))); // NOI18N
            searchModelPanel.setLayout(new java.awt.GridBagLayout());

            searchbyPatientNameChkbx.setBackground(new java.awt.Color(255, 239, 255));
            buttonGroup2.add(searchbyPatientNameChkbx);
            searchbyPatientNameChkbx.setText("Name");
            searchbyPatientNameChkbx.setHorizontalTextPosition(javax.swing.SwingConstants.LEADING);
            searchbyPatientNameChkbx.setIconTextGap(0);
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 1;
            gridBagConstraints.gridy = 1;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            searchModelPanel.add(searchbyPatientNameChkbx, gridBagConstraints);

            searchbyPatientNumberChkbx.setBackground(new java.awt.Color(255, 239, 255));
            buttonGroup2.add(searchbyPatientNumberChkbx);
            searchbyPatientNumberChkbx.setSelected(true);
            searchbyPatientNumberChkbx.setText("Patient No.");
            searchbyPatientNumberChkbx.setHorizontalTextPosition(javax.swing.SwingConstants.LEADING);
            searchbyPatientNumberChkbx.setIconTextGap(0);
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 1;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            searchModelPanel.add(searchbyPatientNumberChkbx, gridBagConstraints);

            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 3;
            gridBagConstraints.gridy = 0;
            gridBagConstraints.weightx = 1.0;
            admissionPanel.add(searchModelPanel, gridBagConstraints);

            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 1;
            gridBagConstraints.gridwidth = 5;
            gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
            gridBagConstraints.weightx = 1.0;
            getContentPane().add(admissionPanel, gridBagConstraints);

            actionsPanel.setBackground(new java.awt.Color(255, 204, 204));
            actionsPanel.setBorder(javax.swing.BorderFactory.createTitledBorder(""));
            actionsPanel.setLayout(new java.awt.GridBagLayout());

            admitBtn.setMnemonic('A');
            admitBtn.setText("Admit");
            admitBtn.setToolTipText("click to store data");
            admitBtn.setEnabled(false);
            admitBtn.addActionListener(new java.awt.event.ActionListener() {
                public void actionPerformed(java.awt.event.ActionEvent evt) {
                    admitBtnActionPerformed(evt);
                }
            });
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 1;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            actionsPanel.add(admitBtn, gridBagConstraints);

            jButton2.setMnemonic('E');
            jButton2.setText("Edit");
            jButton2.setToolTipText("click to edit&update");
            jButton2.setEnabled(false);
            jButton2.addActionListener(new java.awt.event.ActionListener() {
                public void actionPerformed(java.awt.event.ActionEvent evt) {
                    jButton2ActionPerformed(evt);
                }
            });
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 6;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            actionsPanel.add(jButton2, gridBagConstraints);

            jButton3.setMnemonic('n');
            jButton3.setText("Cancel");
            jButton3.setToolTipText("click to clear fields");
            jButton3.addActionListener(new java.awt.event.ActionListener() {
                public void actionPerformed(java.awt.event.ActionEvent evt) {
                    jButton3ActionPerformed(evt);
                }
            });
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 8;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            actionsPanel.add(jButton3, gridBagConstraints);

            jButton4.setMnemonic('C');
            jButton4.setText("Close");
            jButton4.setToolTipText("Click to close");
            jButton4.setSelected(true);
            jButton4.addActionListener(new java.awt.event.ActionListener() {
                public void actionPerformed(java.awt.event.ActionEvent evt) {
                    jButton4ActionPerformed(evt);
                }
            });
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 9;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            actionsPanel.add(jButton4, gridBagConstraints);

            jButton9.setText("Help");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 10;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            actionsPanel.add(jButton9, gridBagConstraints);

            jButton5.setMnemonic('S');
            jButton5.setText("Read Smart Card");
            jButton5.setToolTipText("Click to read smart card data");
            jButton5.setEnabled(false);
            jButton5.addActionListener(new java.awt.event.ActionListener() {
                public void actionPerformed(java.awt.event.ActionEvent evt) {
                    jButton5ActionPerformed(evt);
                }
            });
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 7;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            actionsPanel.add(jButton5, gridBagConstraints);

            admitPrintBtn.setText("Admit & Print");
            admitPrintBtn.addActionListener(new java.awt.event.ActionListener() {
                public void actionPerformed(java.awt.event.ActionEvent evt) {
                    admitPrintBtnActionPerformed(evt);
                }
            });
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 0;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            actionsPanel.add(admitPrintBtn, gridBagConstraints);

            reprintFileBtn.setText("Reprint File");
            reprintFileBtn.addActionListener(new java.awt.event.ActionListener() {
                public void actionPerformed(java.awt.event.ActionEvent evt) {
                    reprintFileBtnActionPerformed(evt);
                }
            });
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 2;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            actionsPanel.add(reprintFileBtn, gridBagConstraints);

            buttonGroup5.add(editReprintBtn);
            editReprintBtn.setText("Edit / Reprint File");
            editReprintBtn.setHorizontalAlignment(javax.swing.SwingConstants.TRAILING);
            editReprintBtn.setHorizontalTextPosition(javax.swing.SwingConstants.LEADING);
            editReprintBtn.addActionListener(new java.awt.event.ActionListener() {
                public void actionPerformed(java.awt.event.ActionEvent evt) {
                    editReprintBtnActionPerformed(evt);
                }
            });
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 3;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            actionsPanel.add(editReprintBtn, gridBagConstraints);

            admissionsReportBtn.setText("Admissions Report");
            admissionsReportBtn.addActionListener(new java.awt.event.ActionListener() {
                public void actionPerformed(java.awt.event.ActionEvent evt) {
                    admissionsReportBtnActionPerformed(evt);
                }
            });
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 5;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            actionsPanel.add(admissionsReportBtn, gridBagConstraints);

            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 5;
            gridBagConstraints.gridy = 1;
            gridBagConstraints.gridheight = 6;
            gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
            gridBagConstraints.weightx = 1.0;
            getContentPane().add(actionsPanel, gridBagConstraints);

            jLabel33.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 7;
            gridBagConstraints.gridwidth = 5;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            getContentPane().add(jLabel33, gridBagConstraints);

            admissionsMainPanel.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Enter patient details (You can search by Admission/Patient number, ID number, Telephone Number or Next of Kin details)", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Dialog", 1, 12), new java.awt.Color(0, 0, 255))); // NOI18N
            admissionsMainPanel.setForeground(new java.awt.Color(0, 255, 204));
            admissionsMainPanel.setLayout(new java.awt.GridBagLayout());

            bioDataPanel.setLayout(new java.awt.GridBagLayout());

            diagnosisScrollPane.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Provisional Diagnosis", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Dialog", 0, 10), new java.awt.Color(255, 51, 153))); // NOI18N

            diagnosisTextPane.setText("N/A");
            diagnosisScrollPane.setViewportView(diagnosisTextPane);

            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 14;
            gridBagConstraints.gridwidth = 2;
            gridBagConstraints.gridheight = 2;
            gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 0.3;
            gridBagConstraints.insets = new java.awt.Insets(0, 15, 0, 0);
            bioDataPanel.add(diagnosisScrollPane, gridBagConstraints);

            demographicsPanel.setBackground(new java.awt.Color(204, 255, 204));
            demographicsPanel.setLayout(new java.awt.GridBagLayout());

            religionLbl.setText("Religion");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 1;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 20, 0, 0);
            demographicsPanel.add(religionLbl, gridBagConstraints);

            religionCmbx.setModel(com.afrisoftech.lib.ComboBoxModel.ComboBoxModel(connectDB, "SELECT religion_name FROM pb_religion union select '-' as religion_name ORDER BY religion_name"));
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 1;
            gridBagConstraints.gridy = 1;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 10);
            demographicsPanel.add(religionCmbx, gridBagConstraints);

            placeofBirthLbl.setText("Place of Birth");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 4;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.insets = new java.awt.Insets(0, 20, 0, 0);
            demographicsPanel.add(placeofBirthLbl, gridBagConstraints);

            districtCmbx.setEditable(true);
            districtCmbx.setModel(com.afrisoftech.lib.ComboBoxModel.ComboBoxModel(connectDB, "SELECT DISTINCT district_name FROM pb_district ORDER BY district_name"));
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 1;
            gridBagConstraints.gridy = 4;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 10);
            demographicsPanel.add(districtCmbx, gridBagConstraints);

            locationLbl.setText("Location");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 5;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.insets = new java.awt.Insets(0, 20, 0, 0);
            demographicsPanel.add(locationLbl, gridBagConstraints);
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 1;
            gridBagConstraints.gridy = 5;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 10);
            demographicsPanel.add(locationTxt, gridBagConstraints);

            nameofChiefLbl.setText("Name of Chief");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 6;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.insets = new java.awt.Insets(0, 20, 0, 0);
            demographicsPanel.add(nameofChiefLbl, gridBagConstraints);
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 1;
            gridBagConstraints.gridy = 6;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 10);
            demographicsPanel.add(nameofChiefTxt, gridBagConstraints);

            nationalityLbl.setForeground(new java.awt.Color(255, 51, 153));
            nationalityLbl.setText("Nationality");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 2;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 0.3;
            gridBagConstraints.insets = new java.awt.Insets(0, 20, 0, 0);
            demographicsPanel.add(nationalityLbl, gridBagConstraints);

            nationalityCmbx.setModel(com.afrisoftech.lib.ComboBoxModel.ComboBoxModel(connectDB, "SELECT DISTINCT country_name FROM pb_country ORDER BY 1"));
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 1;
            gridBagConstraints.gridy = 2;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 0.3;
            gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 10);
            demographicsPanel.add(nationalityCmbx, gridBagConstraints);

            residencelbl.setForeground(new java.awt.Color(255, 51, 153));
            residencelbl.setText("Residence (Village)");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 0;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 20, 0, 0);
            demographicsPanel.add(residencelbl, gridBagConstraints);

            currentResidence.addActionListener(new java.awt.event.ActionListener() {
                public void actionPerformed(java.awt.event.ActionEvent evt) {
                    currentResidenceActionPerformed(evt);
                }
            });
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 1;
            gridBagConstraints.gridy = 0;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.8;
            gridBagConstraints.weighty = 1.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 10);
            demographicsPanel.add(currentResidence, gridBagConstraints);

            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 2;
            gridBagConstraints.gridwidth = 2;
            gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
            gridBagConstraints.weighty = 1.0;
            bioDataPanel.add(demographicsPanel, gridBagConstraints);

            biodataSubPanel.setBackground(new java.awt.Color(204, 255, 204));
            biodataSubPanel.addMouseMotionListener(new java.awt.event.MouseMotionAdapter() {
                public void mouseMoved(java.awt.event.MouseEvent evt) {
                    biodataSubPanelMouseMoved(evt);
                }
            });
            biodataSubPanel.setLayout(new java.awt.GridBagLayout());

            birthDatePanel.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Enter date of birth or patient Age here ", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Dialog", 1, 12), new java.awt.Color(255, 51, 153))); // NOI18N
            birthDatePanel.setLayout(new java.awt.GridBagLayout());

            birthDateLbl.setText("Date of Birth");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 0;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 20, 0, 0);
            birthDatePanel.add(birthDateLbl, gridBagConstraints);

            this.datePickerYOB.getDateEditor().addPropertyChangeListener(new java.beans.PropertyChangeListener() {

                @Override
                public void propertyChange(PropertyChangeEvent evt) {
                    changeDate();
                }
            });

            datePickerYOB.addInputMethodListener(new java.awt.event.InputMethodListener() {
                public void inputMethodTextChanged(java.awt.event.InputMethodEvent evt) {
                    datePickerYOBInputMethodTextChanged(evt);
                }
                public void caretPositionChanged(java.awt.event.InputMethodEvent evt) {
                }
            });
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 1;
            gridBagConstraints.gridy = 0;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 30);
            birthDatePanel.add(datePickerYOB, gridBagConstraints);

            patientAgeLbl.setText("Patient Real Age");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 1;
            birthDatePanel.add(patientAgeLbl, gridBagConstraints);
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 1;
            gridBagConstraints.gridy = 1;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            birthDatePanel.add(agelabel, gridBagConstraints);

            patientAgeInputLbl.setText("Patient Age (Years)");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 2;
            gridBagConstraints.gridy = 1;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            birthDatePanel.add(patientAgeInputLbl, gridBagConstraints);

            ageYrsTxt.addCaretListener(new javax.swing.event.CaretListener() {
                public void caretUpdate(javax.swing.event.CaretEvent evt) {
                    ageYrsTxtCaretUpdate(evt);
                }
            });
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 3;
            gridBagConstraints.gridy = 1;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            birthDatePanel.add(ageYrsTxt, gridBagConstraints);

            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 7;
            gridBagConstraints.gridwidth = 2;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 5.0;
            biodataSubPanel.add(birthDatePanel, gridBagConstraints);

            opdNoLbl.setText("Out Patient No.");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 1;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 0.3;
            gridBagConstraints.insets = new java.awt.Insets(0, 15, 0, 0);
            biodataSubPanel.add(opdNoLbl, gridBagConstraints);

            opdNoPanel.setBorder(javax.swing.BorderFactory.createEtchedBorder());
            opdNoPanel.setPreferredSize(new java.awt.Dimension(48, 24));
            opdNoPanel.setLayout(new java.awt.GridBagLayout());

            opdNoTxt.setEditable(false);
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            opdNoPanel.add(opdNoTxt, gridBagConstraints);

            opdSearchButton.setToolTipText("Search");
            opdSearchButton.setHorizontalAlignment(javax.swing.SwingConstants.TRAILING);
            opdSearchButton.setMaximumSize(new java.awt.Dimension(40, 25));
            opdSearchButton.setMinimumSize(new java.awt.Dimension(40, 25));
            opdSearchButton.setPreferredSize(new java.awt.Dimension(30, 22));
            opdSearchButton.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
            opdSearchButton.addActionListener(new java.awt.event.ActionListener() {
                public void actionPerformed(java.awt.event.ActionEvent evt) {
                    opdSearchButtonActionPerformed(evt);
                }
            });
            opdNoPanel.add(opdSearchButton, new java.awt.GridBagConstraints());

            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 1;
            gridBagConstraints.gridy = 1;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 0.3;
            gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 10);
            biodataSubPanel.add(opdNoPanel, gridBagConstraints);

            admissionNoPanel.setBorder(javax.swing.BorderFactory.createEtchedBorder());
            admissionNoPanel.setPreferredSize(new java.awt.Dimension(48, 24));
            admissionNoPanel.setLayout(new java.awt.GridBagLayout());

            admissionNumberTxt.setEditable(false);
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 1;
            gridBagConstraints.gridy = 0;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            admissionNoPanel.add(admissionNumberTxt, gridBagConstraints);

            searchButton.setToolTipText("Search");
            searchButton.setHorizontalAlignment(javax.swing.SwingConstants.TRAILING);
            searchButton.setMaximumSize(new java.awt.Dimension(40, 25));
            searchButton.setMinimumSize(new java.awt.Dimension(40, 25));
            searchButton.setPreferredSize(new java.awt.Dimension(30, 22));
            searchButton.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
            searchButton.addActionListener(new java.awt.event.ActionListener() {
                public void actionPerformed(java.awt.event.ActionEvent evt) {
                    searchButtonActionPerformed(evt);
                }
            });
            admissionNoPanel.add(searchButton, new java.awt.GridBagConstraints());

            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 1;
            gridBagConstraints.gridy = 2;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.ipadx = 10;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 0.3;
            gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 10);
            biodataSubPanel.add(admissionNoPanel, gridBagConstraints);

            admissionNolbl.setForeground(new java.awt.Color(255, 51, 153));
            admissionNolbl.setText("Admission No.");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 2;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 0.3;
            gridBagConstraints.insets = new java.awt.Insets(0, 15, 0, 0);
            biodataSubPanel.add(admissionNolbl, gridBagConstraints);

            surNameLbl.setForeground(new java.awt.Color(255, 51, 153));
            surNameLbl.setText("Surname Name");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 3;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 0.3;
            gridBagConstraints.insets = new java.awt.Insets(0, 15, 0, 0);
            biodataSubPanel.add(surNameLbl, gridBagConstraints);

            surNameTxt.setEditable(false);
            surNameTxt.addCaretListener(new javax.swing.event.CaretListener() {
                public void caretUpdate(javax.swing.event.CaretEvent evt) {
                    surNameTxtCaretUpdate(evt);
                }
            });
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 1;
            gridBagConstraints.gridy = 3;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 0.3;
            gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 10);
            biodataSubPanel.add(surNameTxt, gridBagConstraints);

            otherNamesLbl.setForeground(new java.awt.Color(255, 51, 153));
            otherNamesLbl.setText("Other Name(s)");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 4;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 0.3;
            gridBagConstraints.insets = new java.awt.Insets(0, 15, 0, 0);
            biodataSubPanel.add(otherNamesLbl, gridBagConstraints);

            firstNameTxt.setEditable(false);
            firstNameTxt.addCaretListener(new javax.swing.event.CaretListener() {
                public void caretUpdate(javax.swing.event.CaretEvent evt) {
                    firstNameTxtCaretUpdate(evt);
                }
            });
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 1;
            gridBagConstraints.gridy = 4;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 10);
            biodataSubPanel.add(firstNameTxt, gridBagConstraints);

            genderLbl.setForeground(new java.awt.Color(255, 51, 153));
            genderLbl.setText("Gender");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 5;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 0.3;
            gridBagConstraints.insets = new java.awt.Insets(0, 15, 0, 0);
            biodataSubPanel.add(genderLbl, gridBagConstraints);

            genderpanel.setLayout(new java.awt.GridBagLayout());

            buttonGroup4.add(maleChkbx);
            maleChkbx.setText("Male");
            maleChkbx.setHorizontalTextPosition(javax.swing.SwingConstants.LEADING);
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 0;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.weightx = 1.0;
            genderpanel.add(maleChkbx, gridBagConstraints);

            buttonGroup4.add(femaleChkbx);
            femaleChkbx.setText("Female");
            femaleChkbx.setHorizontalTextPosition(javax.swing.SwingConstants.LEADING);
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 2;
            gridBagConstraints.gridy = 0;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.weightx = 1.0;
            genderpanel.add(femaleChkbx, gridBagConstraints);

            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 1;
            gridBagConstraints.gridy = 5;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 10);
            biodataSubPanel.add(genderpanel, gridBagConstraints);

            maritalStatusPanel.setLayout(new java.awt.GridBagLayout());

            buttonGroup6.add(singleMaritalChkbx);
            singleMaritalChkbx.setSelected(true);
            singleMaritalChkbx.setText("Single");
            singleMaritalChkbx.setHorizontalTextPosition(javax.swing.SwingConstants.LEFT);
            singleMaritalChkbx.setVerticalTextPosition(javax.swing.SwingConstants.TOP);
            singleMaritalChkbx.addActionListener(new java.awt.event.ActionListener() {
                public void actionPerformed(java.awt.event.ActionEvent evt) {
                    singleMaritalChkbxActionPerformed(evt);
                }
            });
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 2;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.weightx = 1.0;
            maritalStatusPanel.add(singleMaritalChkbx, gridBagConstraints);

            buttonGroup6.add(marriedMaritalChkbx);
            marriedMaritalChkbx.setText("Married");
            marriedMaritalChkbx.setAlignmentY(0.0F);
            marriedMaritalChkbx.setHorizontalAlignment(javax.swing.SwingConstants.LEFT);
            marriedMaritalChkbx.setHorizontalTextPosition(javax.swing.SwingConstants.LEADING);
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 1;
            gridBagConstraints.gridy = 2;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.weightx = 1.0;
            maritalStatusPanel.add(marriedMaritalChkbx, gridBagConstraints);

            buttonGroup6.add(divorcedMaritalChkbx);
            divorcedMaritalChkbx.setText("Divorced");
            divorcedMaritalChkbx.setBorder(javax.swing.BorderFactory.createEmptyBorder(0, 0, 0, 0));
            divorcedMaritalChkbx.setHorizontalTextPosition(javax.swing.SwingConstants.LEFT);
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 3;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.weightx = 1.0;
            maritalStatusPanel.add(divorcedMaritalChkbx, gridBagConstraints);

            buttonGroup6.add(widowedMaritalChkbx);
            widowedMaritalChkbx.setText("Widowed");
            widowedMaritalChkbx.setBorder(javax.swing.BorderFactory.createEmptyBorder(0, 0, 0, 0));
            widowedMaritalChkbx.setHorizontalAlignment(javax.swing.SwingConstants.LEFT);
            widowedMaritalChkbx.setHorizontalTextPosition(javax.swing.SwingConstants.LEADING);
            widowedMaritalChkbx.setIconTextGap(7);
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 1;
            gridBagConstraints.gridy = 3;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.EAST;
            gridBagConstraints.weightx = 1.0;
            maritalStatusPanel.add(widowedMaritalChkbx, gridBagConstraints);

            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 1;
            gridBagConstraints.gridy = 6;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 10);
            biodataSubPanel.add(maritalStatusPanel, gridBagConstraints);

            maritalStatusLbl.setForeground(new java.awt.Color(255, 51, 153));
            maritalStatusLbl.setText("Marital Status");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 6;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 20, 0, 0);
            biodataSubPanel.add(maritalStatusLbl, gridBagConstraints);

            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 1;
            gridBagConstraints.gridwidth = 2;
            gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
            gridBagConstraints.weightx = 2.0;
            gridBagConstraints.weighty = 1.0;
            bioDataPanel.add(biodataSubPanel, gridBagConstraints);

            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 0;
            gridBagConstraints.gridwidth = 2;
            gridBagConstraints.gridheight = 5;
            gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            admissionsMainPanel.add(bioDataPanel, gridBagConstraints);

            admissionInstancePanel.setBackground(new java.awt.Color(255, 255, 255));
            admissionInstancePanel.setBorder(javax.swing.BorderFactory.createTitledBorder("Admission details"));
            admissionInstancePanel.setForeground(new java.awt.Color(255, 0, 51));
            admissionInstancePanel.setLayout(new java.awt.GridBagLayout());

            wardLbl.setForeground(new java.awt.Color(255, 51, 153));
            wardLbl.setText("Ward");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 3;
            gridBagConstraints.gridy = 1;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 0.3;
            gridBagConstraints.insets = new java.awt.Insets(0, 15, 0, 0);
            admissionInstancePanel.add(wardLbl, gridBagConstraints);

            admissionWardCmbx.setModel(com.afrisoftech.lib.ComboBoxModel.ComboBoxModel(connectDB, "(select '0select-')  UNION (SELECT distinct ward_name FROM hp_wards) ORDER BY 1 asc"));
            admissionWardCmbx.addMouseListener(new java.awt.event.MouseAdapter() {
                public void mouseClicked(java.awt.event.MouseEvent evt) {
                    admissionWardCmbxMouseClicked(evt);
                }
            });
            admissionWardCmbx.addActionListener(new java.awt.event.ActionListener() {
                public void actionPerformed(java.awt.event.ActionEvent evt) {
                    admissionWardCmbxActionPerformed(evt);
                }
            });
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 5;
            gridBagConstraints.gridy = 1;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 10);
            admissionInstancePanel.add(admissionWardCmbx, gridBagConstraints);

            wardCodeLbl.setText("Ward Code");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 3;
            gridBagConstraints.gridy = 2;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 0.3;
            gridBagConstraints.insets = new java.awt.Insets(0, 15, 0, 0);
            admissionInstancePanel.add(wardCodeLbl, gridBagConstraints);

            wardCodeTxt.setEditable(false);
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 5;
            gridBagConstraints.gridy = 2;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 10);
            admissionInstancePanel.add(wardCodeTxt, gridBagConstraints);

            bedNoLbl.setForeground(new java.awt.Color(0, 0, 0));
            bedNoLbl.setText("Bed No");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 3;
            gridBagConstraints.gridy = 3;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 0.3;
            gridBagConstraints.insets = new java.awt.Insets(0, 15, 0, 0);
            admissionInstancePanel.add(bedNoLbl, gridBagConstraints);

            bedNumberCmbx.addActionListener(new java.awt.event.ActionListener() {
                public void actionPerformed(java.awt.event.ActionEvent evt) {
                    bedNumberCmbxActionPerformed(evt);
                }
            });
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 5;
            gridBagConstraints.gridy = 3;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 10);
            admissionInstancePanel.add(bedNumberCmbx, gridBagConstraints);

            bedCategoryLbl.setForeground(new java.awt.Color(255, 51, 153));
            bedCategoryLbl.setText("Bed Category");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 3;
            gridBagConstraints.gridy = 4;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 15, 0, 0);
            admissionInstancePanel.add(bedCategoryLbl, gridBagConstraints);

            bedCategoryCmbx.setModel(com.afrisoftech.lib.ComboBoxModel.ComboBoxModel(connectDB, "select category from hp_bed_category order by category"));
            bedCategoryCmbx.addActionListener(new java.awt.event.ActionListener() {
                public void actionPerformed(java.awt.event.ActionEvent evt) {
                    bedCategoryCmbxActionPerformed(evt);
                }
            });
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 5;
            gridBagConstraints.gridy = 4;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 0.3;
            gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 10);
            admissionInstancePanel.add(bedCategoryCmbx, gridBagConstraints);

            bedRateLbl.setForeground(new java.awt.Color(255, 51, 153));
            bedRateLbl.setText("Bed Rate");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 3;
            gridBagConstraints.gridy = 5;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.weighty = 0.3;
            gridBagConstraints.insets = new java.awt.Insets(0, 15, 0, 0);
            admissionInstancePanel.add(bedRateLbl, gridBagConstraints);

            bedRateTxt.setEditable(false);
            bedRateTxt.setBackground(new java.awt.Color(204, 204, 204));
            bedRateTxt.setFont(new java.awt.Font("Dialog", 1, 14)); // NOI18N
            bedRateTxt.setForeground(new java.awt.Color(204, 0, 204));
            bedRateTxt.setHorizontalAlignment(javax.swing.JTextField.TRAILING);
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 5;
            gridBagConstraints.gridy = 5;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 20, 0, 10);
            admissionInstancePanel.add(bedRateTxt, gridBagConstraints);

            admittedByPanel.setBorder(javax.swing.BorderFactory.createEtchedBorder());
            admittedByPanel.setPreferredSize(new java.awt.Dimension(48, 24));
            admittedByPanel.setLayout(new java.awt.GridBagLayout());

            admittedByTxt.setEditable(false);
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 1;
            gridBagConstraints.gridy = 0;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            admittedByPanel.add(admittedByTxt, gridBagConstraints);

            admittedByBtn.setToolTipText("Search");
            admittedByBtn.setHorizontalAlignment(javax.swing.SwingConstants.TRAILING);
            admittedByBtn.setMaximumSize(new java.awt.Dimension(40, 25));
            admittedByBtn.setMinimumSize(new java.awt.Dimension(40, 25));
            admittedByBtn.setPreferredSize(new java.awt.Dimension(30, 22));
            admittedByBtn.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
            admittedByBtn.addActionListener(new java.awt.event.ActionListener() {
                public void actionPerformed(java.awt.event.ActionEvent evt) {
                    admittedByBtnActionPerformed(evt);
                }
            });
            admittedByPanel.add(admittedByBtn, new java.awt.GridBagConstraints());

            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 5;
            gridBagConstraints.gridy = 6;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.ipadx = 10;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 0.3;
            gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 10);
            admissionInstancePanel.add(admittedByPanel, gridBagConstraints);

            admittedByLbl.setForeground(new java.awt.Color(0, 0, 0));
            admittedByLbl.setText("Admitted By");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 3;
            gridBagConstraints.gridy = 6;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 15, 0, 0);
            admissionInstancePanel.add(admittedByLbl, gridBagConstraints);

            specialityLbl.setForeground(new java.awt.Color(255, 51, 153));
            specialityLbl.setText("Speciality");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 3;
            gridBagConstraints.gridy = 7;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 0.3;
            gridBagConstraints.insets = new java.awt.Insets(0, 15, 0, 0);
            admissionInstancePanel.add(specialityLbl, gridBagConstraints);

            specialtyClinicCmbx.setModel(com.afrisoftech.lib.ComboBoxModel.ComboBoxModel(connectDB, "SELECT patient_type FROM pb_patient_categories ORDER BY 1"));
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 5;
            gridBagConstraints.gridy = 7;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 10);
            admissionInstancePanel.add(specialtyClinicCmbx, gridBagConstraints);

            referredFromLbl.setText("Reffered From");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 3;
            gridBagConstraints.gridy = 8;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 0.3;
            gridBagConstraints.insets = new java.awt.Insets(0, 15, 0, 0);
            admissionInstancePanel.add(referredFromLbl, gridBagConstraints);

            wardAdmittedLbl.setText("Ward Admitted");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 3;
            gridBagConstraints.gridy = 13;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 0.3;
            gridBagConstraints.insets = new java.awt.Insets(0, 15, 0, 0);
            admissionInstancePanel.add(wardAdmittedLbl, gridBagConstraints);

            wardAdmittedTxt.setEditable(false);
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 5;
            gridBagConstraints.gridy = 13;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.8;
            gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 10);
            admissionInstancePanel.add(wardAdmittedTxt, gridBagConstraints);

            bedOccupiedLbl.setText("Bed  Occupied");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 3;
            gridBagConstraints.gridy = 14;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 0.3;
            gridBagConstraints.insets = new java.awt.Insets(0, 15, 0, 0);
            admissionInstancePanel.add(bedOccupiedLbl, gridBagConstraints);

            bedoccupiedTxt.setEditable(false);
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 5;
            gridBagConstraints.gridy = 14;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 10);
            admissionInstancePanel.add(bedoccupiedTxt, gridBagConstraints);

            previousDischargeDateLbl.setText("Previous Discharge Date");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 3;
            gridBagConstraints.gridy = 12;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 0.3;
            gridBagConstraints.insets = new java.awt.Insets(0, 15, 0, 0);
            admissionInstancePanel.add(previousDischargeDateLbl, gridBagConstraints);

            previousDischargeDateTxt.setEditable(false);
            previousDischargeDateTxt.setPreferredSize(new java.awt.Dimension(4, 17));
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 5;
            gridBagConstraints.gridy = 12;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 10);
            admissionInstancePanel.add(previousDischargeDateTxt, gridBagConstraints);

            admissionDateLbl.setForeground(new java.awt.Color(255, 0, 0));
            admissionDateLbl.setText("Admission Date");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 3;
            gridBagConstraints.gridy = 0;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 0.3;
            gridBagConstraints.insets = new java.awt.Insets(0, 15, 0, 0);
            admissionInstancePanel.add(admissionDateLbl, gridBagConstraints);
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 5;
            gridBagConstraints.gridy = 0;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 0.3;
            gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 10);
            admissionInstancePanel.add(admissionDatePicker, gridBagConstraints);

            previousVisitIDLbl.setText("Previous Visit Id");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 3;
            gridBagConstraints.gridy = 10;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 0.3;
            gridBagConstraints.insets = new java.awt.Insets(0, 15, 0, 0);
            admissionInstancePanel.add(previousVisitIDLbl, gridBagConstraints);

            previousVisitIDPanel.setBorder(javax.swing.BorderFactory.createEtchedBorder());
            previousVisitIDPanel.setPreferredSize(new java.awt.Dimension(48, 24));
            previousVisitIDPanel.setLayout(new java.awt.GridBagLayout());

            previousVisitIDTxt.setEditable(false);
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 1;
            gridBagConstraints.gridy = 0;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            previousVisitIDPanel.add(previousVisitIDTxt, gridBagConstraints);

            previousVisitSearchButton.setToolTipText("Search");
            previousVisitSearchButton.setHorizontalAlignment(javax.swing.SwingConstants.TRAILING);
            previousVisitSearchButton.setMaximumSize(new java.awt.Dimension(40, 25));
            previousVisitSearchButton.setMinimumSize(new java.awt.Dimension(40, 25));
            previousVisitSearchButton.setPreferredSize(new java.awt.Dimension(30, 22));
            previousVisitSearchButton.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
            previousVisitSearchButton.addActionListener(new java.awt.event.ActionListener() {
                public void actionPerformed(java.awt.event.ActionEvent evt) {
                    previousVisitSearchButtonActionPerformed(evt);
                }
            });
            previousVisitIDPanel.add(previousVisitSearchButton, new java.awt.GridBagConstraints());

            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 5;
            gridBagConstraints.gridy = 10;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.ipadx = 10;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 10);
            admissionInstancePanel.add(previousVisitIDPanel, gridBagConstraints);

            previousAdmissionDateTxt.setEditable(false);
            previousAdmissionDateTxt.setPreferredSize(new java.awt.Dimension(4, 17));
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 5;
            gridBagConstraints.gridy = 11;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 10);
            admissionInstancePanel.add(previousAdmissionDateTxt, gridBagConstraints);

            previousAdmissionDateLbl.setText("Previous Admission Date");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 3;
            gridBagConstraints.gridy = 11;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 0.3;
            gridBagConstraints.insets = new java.awt.Insets(0, 15, 0, 0);
            admissionInstancePanel.add(previousAdmissionDateLbl, gridBagConstraints);

            registrationPointLbl.setText("Service Point");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 3;
            gridBagConstraints.gridy = 15;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 15, 0, 0);
            admissionInstancePanel.add(registrationPointLbl, gridBagConstraints);

            registrationPointCmbx.setModel(com.afrisoftech.lib.ComboBoxModel.ComboBoxModel(connectDB, "SELECT point_name  FROM records_service_points ORDER BY 1"));
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 5;
            gridBagConstraints.gridy = 15;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 10);
            admissionInstancePanel.add(registrationPointCmbx, gridBagConstraints);

            previousAdmissionsLbl.setForeground(new java.awt.Color(51, 51, 255));
            previousAdmissionsLbl.setText("Billing Report on previous admissions");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 3;
            gridBagConstraints.gridy = 17;
            gridBagConstraints.gridwidth = 3;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            admissionInstancePanel.add(previousAdmissionsLbl, gridBagConstraints);

            disabilityStatusLbl.setText("Patient with disability");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 3;
            gridBagConstraints.gridy = 16;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 15, 0, 0);
            admissionInstancePanel.add(disabilityStatusLbl, gridBagConstraints);

            patientDisabilityCmbx.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "N", "Y" }));
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 5;
            gridBagConstraints.gridy = 16;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            admissionInstancePanel.add(patientDisabilityCmbx, gridBagConstraints);

            patientDebtTxt.setEditable(false);
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 3;
            gridBagConstraints.gridy = 18;
            gridBagConstraints.gridwidth = 3;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            admissionInstancePanel.add(patientDebtTxt, gridBagConstraints);

            referredcombo.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "-", "County Hospital", "Health Center(Outside County)", "Health Center(Within County)", "Private Facility or Doctor", "NGO Facility", "Outside country", "Casualty dept at This Facility", "Other dept at This Facility", "Not Refered/Unknown Status" }));
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 5;
            gridBagConstraints.gridy = 8;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 10);
            admissionInstancePanel.add(referredcombo, gridBagConstraints);

            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 4;
            gridBagConstraints.gridy = 0;
            gridBagConstraints.gridwidth = 2;
            gridBagConstraints.gridheight = 5;
            gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            admissionsMainPanel.add(admissionInstancePanel, gridBagConstraints);

            otherDetailsPanel.setLayout(new java.awt.GridBagLayout());

            oldFileNumberLbl.setForeground(new java.awt.Color(255, 51, 153));
            oldFileNumberLbl.setText("Unit Number");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 7;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.insets = new java.awt.Insets(0, 20, 0, 0);
            otherDetailsPanel.add(oldFileNumberLbl, gridBagConstraints);

            unitNumberTxt.addCaretListener(new javax.swing.event.CaretListener() {
                public void caretUpdate(javax.swing.event.CaretEvent evt) {
                    unitNumberTxtCaretUpdate(evt);
                }
            });
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 1;
            gridBagConstraints.gridy = 7;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            otherDetailsPanel.add(unitNumberTxt, gridBagConstraints);

            occupationLbl.setText("Occupation");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 9;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 20, 0, 0);
            otherDetailsPanel.add(occupationLbl, gridBagConstraints);

            occupationCmbx.setModel(com.afrisoftech.lib.ComboBoxModel.ComboBoxModel(connectDB, "SELECT occupations FROM pb_occupation ORDER BY occupations"));
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 1;
            gridBagConstraints.gridy = 9;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            otherDetailsPanel.add(occupationCmbx, gridBagConstraints);

            idNumberLbl.setForeground(new java.awt.Color(255, 51, 153));
            idNumberLbl.setText("ID No / Passport No");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 10;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 0.3;
            gridBagConstraints.insets = new java.awt.Insets(0, 20, 0, 0);
            otherDetailsPanel.add(idNumberLbl, gridBagConstraints);
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 1;
            gridBagConstraints.gridy = 10;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            otherDetailsPanel.add(idPassportTxt, gridBagConstraints);

            telephoneNoLbl.setForeground(new java.awt.Color(255, 51, 51));
            telephoneNoLbl.setText("Telephone No");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 3;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 20, 0, 0);
            otherDetailsPanel.add(telephoneNoLbl, gridBagConstraints);
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 1;
            gridBagConstraints.gridy = 3;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 5.0;
            gridBagConstraints.weighty = 1.0;
            otherDetailsPanel.add(nokTelephoneTxt, gridBagConstraints);

            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 2;
            gridBagConstraints.gridy = 0;
            gridBagConstraints.gridwidth = 2;
            gridBagConstraints.gridheight = 5;
            gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            admissionsMainPanel.add(otherDetailsPanel, gridBagConstraints);

            admissionsTabbedPane.addTab("Patient Details", admissionsMainPanel);

            jPanel14.setLayout(new java.awt.GridBagLayout());

            jPanel2.setBackground(new java.awt.Color(153, 255, 204));
            jPanel2.setBorder(javax.swing.BorderFactory.createTitledBorder("Other details"));
            jPanel2.setLayout(new java.awt.GridBagLayout());

            nokNameLbl.setForeground(new java.awt.Color(255, 51, 153));
            nokNameLbl.setText("Next of Kin (NOK) Name");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 1;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 20, 0, 0);
            jPanel2.add(nokNameLbl, gridBagConstraints);
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 1;
            gridBagConstraints.gridy = 1;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            jPanel2.add(nokNameTxt, gridBagConstraints);

            postalAddressLbl.setText("Postal Address");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 4;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 20, 0, 0);
            jPanel2.add(postalAddressLbl, gridBagConstraints);
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 1;
            gridBagConstraints.gridy = 4;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            jPanel2.add(postalAddressTxt, gridBagConstraints);

            modeofPaymentLbl.setForeground(new java.awt.Color(255, 51, 153));
            modeofPaymentLbl.setText("Mode of Payment");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 3;
            gridBagConstraints.gridy = 2;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 20, 0, 0);
            jPanel2.add(modeofPaymentLbl, gridBagConstraints);
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 4;
            gridBagConstraints.gridy = 3;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 10);
            jPanel2.add(billPayerTxt, gridBagConstraints);

            billPayerLbl.setText("Person Paying Bill");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 3;
            gridBagConstraints.gridy = 3;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 20, 0, 0);
            jPanel2.add(billPayerLbl, gridBagConstraints);

            paymentModeCmbx.setSelectedItem(null);
            // javax.swing.JComboBox strCmb;
            java.lang.Object[] strCmb = {"-","Cash","Credit Card","Scheme","Cheque","Eft"};

            javax.swing.DefaultComboBoxModel comboModel = new javax.swing.DefaultComboBoxModel(strCmb);

            // comboModel.addElement("Cash");

            // comboModel.addElement("Account");

            paymentModeCmbx.setModel(comboModel);

            //javax.swing.JComboBox cmBox = new javax.swing.JComboBox(strCmb);

            //javax.swing.table.TableColumn teditor = this.jTable21.getColumn("Payment Mode");

            //        teditor.setCellEditor(new javax.swing.DefaultCellEditor(cmBox));
            paymentModeCmbx.addActionListener(new java.awt.event.ActionListener() {
                public void actionPerformed(java.awt.event.ActionEvent evt) {
                    paymentModeCmbxActionPerformed(evt);
                }
            });
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 4;
            gridBagConstraints.gridy = 2;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 10);
            jPanel2.add(paymentModeCmbx, gridBagConstraints);

            nhifChbx.setHorizontalTextPosition(javax.swing.SwingConstants.LEADING);
            nhifChbx.setLabel("NHIF Rgistered");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 11;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 20, 0, 0);
            jPanel2.add(nhifChbx, gridBagConstraints);

            patientStatusPanel.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Patient Status", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Dialog", 1, 12), new java.awt.Color(255, 0, 255))); // NOI18N
            patientStatusPanel.setLayout(new java.awt.GridBagLayout());

            buttonGroup1.add(admittedChbx);
            admittedChbx.setText("Admitted");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 1;
            gridBagConstraints.gridy = 0;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            patientStatusPanel.add(admittedChbx, gridBagConstraints);

            buttonGroup1.add(dischargedChkbx);
            dischargedChkbx.setText("Discharged");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 2;
            gridBagConstraints.gridy = 0;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            patientStatusPanel.add(dischargedChkbx, gridBagConstraints);

            hasInterimBillChkbx.setText("Has Interim Bill");
            hasInterimBillChkbx.setBorder(javax.swing.BorderFactory.createEmptyBorder(0, 0, 0, 0));
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 3;
            gridBagConstraints.gridy = 0;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            patientStatusPanel.add(hasInterimBillChkbx, gridBagConstraints);

            this.suspendBillChkbx.setEnabled(false);
            suspendBillChkbx.setText("Check to suspend existing interim Bill");
            suspendBillChkbx.setBorder(javax.swing.BorderFactory.createEmptyBorder(0, 0, 0, 0));
            suspendBillChkbx.addActionListener(new java.awt.event.ActionListener() {
                public void actionPerformed(java.awt.event.ActionEvent evt) {
                    suspendBillChkbxActionPerformed(evt);
                }
            });
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 4;
            gridBagConstraints.gridy = 0;
            gridBagConstraints.gridwidth = 3;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            patientStatusPanel.add(suspendBillChkbx, gridBagConstraints);

            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 8;
            gridBagConstraints.gridwidth = 5;
            gridBagConstraints.gridheight = 2;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            jPanel2.add(patientStatusPanel, gridBagConstraints);

            mergeOPBillChkbx.setForeground(new java.awt.Color(250, 127, 5));
            mergeOPBillChkbx.setText("Merge OP Bill ?");
            mergeOPBillChkbx.setBorder(javax.swing.BorderFactory.createEmptyBorder(0, 0, 0, 0));
            mergeOPBillChkbx.setHorizontalTextPosition(javax.swing.SwingConstants.LEADING);
            mergeOPBillChkbx.addActionListener(new java.awt.event.ActionListener() {
                public void actionPerformed(java.awt.event.ActionEvent evt) {
                    mergeOPBillChkbxActionPerformed(evt);
                }
            });
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 3;
            gridBagConstraints.gridy = 10;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            jPanel2.add(mergeOPBillChkbx, gridBagConstraints);

            cardMaturityDateLbl.setBackground(new java.awt.Color(204, 0, 51));
            cardMaturityDateLbl.setText("Card Maturity Date");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 10;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 20, 0, 0);
            jPanel2.add(cardMaturityDateLbl, gridBagConstraints);
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 1;
            gridBagConstraints.gridy = 10;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            jPanel2.add(cardMaturityDatePicker, gridBagConstraints);

            nokRelationLbl.setBackground(new java.awt.Color(255, 204, 255));
            nokRelationLbl.setForeground(new java.awt.Color(255, 51, 153));
            nokRelationLbl.setText("NOK Relationship");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 2;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 20, 0, 0);
            jPanel2.add(nokRelationLbl, gridBagConstraints);

            nokRelationShipCmbx.setModel(com.afrisoftech.lib.ComboBoxModel.ComboBoxModel(connectDB,"SELECT DISTINCT relation_description FROM nok_relationship order by 1"));
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 1;
            gridBagConstraints.gridy = 2;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 10);
            jPanel2.add(nokRelationShipCmbx, gridBagConstraints);

            nokResidenceLbl.setText("NOK Residence");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 3;
            gridBagConstraints.gridy = 1;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 20, 0, 0);
            jPanel2.add(nokResidenceLbl, gridBagConstraints);
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 4;
            gridBagConstraints.gridy = 1;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 10);
            jPanel2.add(nokResidenceTxt, gridBagConstraints);

            clinicNumberLbl.setText("Clinic Number");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 3;
            gridBagConstraints.gridy = 4;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 20, 0, 0);
            jPanel2.add(clinicNumberLbl, gridBagConstraints);
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 4;
            gridBagConstraints.gridy = 4;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.LINE_START;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 10);
            jPanel2.add(clinicFileNumberTxt, gridBagConstraints);

            nhifReferenceNoLbl.setText("NHIF / Claim/Reference Number");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 1;
            gridBagConstraints.gridy = 11;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            jPanel2.add(nhifReferenceNoLbl, gridBagConstraints);
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 3;
            gridBagConstraints.gridy = 11;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            jPanel2.add(nhifClaimNumberTxt, gridBagConstraints);

            countyofBirthLbl.setText("County of Birth");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 5;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 20, 0, 0);
            jPanel2.add(countyofBirthLbl, gridBagConstraints);

            countyofResidenceLbl.setText("County of Residence");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 3;
            gridBagConstraints.gridy = 5;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 20, 0, 0);
            jPanel2.add(countyofResidenceLbl, gridBagConstraints);

            countyofBirthCmbx.setModel(com.afrisoftech.lib.ComboBoxModel.ComboBoxModel(connectDB, "SELECT '-' UNION SELECT DISTINCT county_name FROM pb_county ORDER BY 1"));
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 1;
            gridBagConstraints.gridy = 5;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 10);
            jPanel2.add(countyofBirthCmbx, gridBagConstraints);

            countyofResidenceCmbx.setModel(com.afrisoftech.lib.ComboBoxModel.ComboBoxModel(connectDB, "SELECT '-' UNION SELECT DISTINCT county_name FROM pb_county order by 1"));
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 4;
            gridBagConstraints.gridy = 5;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 10);
            jPanel2.add(countyofResidenceCmbx, gridBagConstraints);

            employerNameLbl.setText("Employer Name");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 6;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 20, 0, 0);
            jPanel2.add(employerNameLbl, gridBagConstraints);
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 1;
            gridBagConstraints.gridy = 6;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            jPanel2.add(employerTxt, gridBagConstraints);

            employerTelLbl.setText("Employer Telephone");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 3;
            gridBagConstraints.gridy = 6;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 20, 0, 0);
            jPanel2.add(employerTelLbl, gridBagConstraints);

            employerTelTxt.addActionListener(new java.awt.event.ActionListener() {
                public void actionPerformed(java.awt.event.ActionEvent evt) {
                    employerTelTxtActionPerformed(evt);
                }
            });
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 4;
            gridBagConstraints.gridy = 6;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            jPanel2.add(employerTelTxt, gridBagConstraints);

            chargeSheetNoLbl.setForeground(new java.awt.Color(255, 51, 153));
            chargeSheetNoLbl.setText("C-Sheet No.");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 3;
            gridBagConstraints.gridy = 7;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 20, 0, 0);
            jPanel2.add(chargeSheetNoLbl, gridBagConstraints);
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 4;
            gridBagConstraints.gridy = 7;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            jPanel2.add(cSheetNoTxt, gridBagConstraints);

            educationLevelLbl.setText("Education Level");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 7;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 20, 0, 0);
            jPanel2.add(educationLevelLbl, gridBagConstraints);

            educationLevelCmbx.setModel(com.afrisoftech.lib.ComboBoxModel.ComboBoxModel(connectDB, "SELECT edu_name FROM pb_education ORDER BY edu_name"));
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 1;
            gridBagConstraints.gridy = 7;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 10);
            jPanel2.add(educationLevelCmbx, gridBagConstraints);

            nhifCardNoLbl.setText("NHIF Card Number");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 12;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 20, 0, 0);
            jPanel2.add(nhifCardNoLbl, gridBagConstraints);
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 1;
            gridBagConstraints.gridy = 12;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            jPanel2.add(nhifCardMemberNumberTxt, gridBagConstraints);

            nokTelLbl.setForeground(new java.awt.Color(255, 51, 51));
            nokTelLbl.setText("Next of kin Telephone");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 3;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            jPanel2.add(nokTelLbl, gridBagConstraints);
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 1;
            gridBagConstraints.gridy = 3;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            jPanel2.add(nokteltxt, gridBagConstraints);

            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 0;
            gridBagConstraints.gridwidth = 5;
            gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
            gridBagConstraints.weightx = 15.0;
            gridBagConstraints.weighty = 20.0;
            gridBagConstraints.insets = new java.awt.Insets(5, 5, 5, 5);
            jPanel14.add(jPanel2, gridBagConstraints);

            bankCardsPanel.setBackground(new java.awt.Color(219, 243, 255));
            bankCardsPanel.setBorder(javax.swing.BorderFactory.createTitledBorder("Select card name then enter card No.and the expiry date "));
            bankCardsPanel.setEnabled(false);
            bankCardsPanel.setLayout(new java.awt.GridBagLayout());

            cardNameLbl.setText("Card Name");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 1;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            bankCardsPanel.add(cardNameLbl, gridBagConstraints);

            cardNameCmbx.setModel(com.afrisoftech.lib.ComboBoxModel.ComboBoxModel(connectDB, "SELECT card_name FROM pb_creditcard_types ORDER By card_name"));
            cardNameCmbx.addActionListener(new java.awt.event.ActionListener() {
                public void actionPerformed(java.awt.event.ActionEvent evt) {
                    cardNameCmbxActionPerformed(evt);
                }
            });
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 1;
            gridBagConstraints.gridy = 1;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            bankCardsPanel.add(cardNameCmbx, gridBagConstraints);

            cardIssurerTxt.setEditable(false);
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 1;
            gridBagConstraints.gridy = 2;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            bankCardsPanel.add(cardIssurerTxt, gridBagConstraints);

            cardUssurerLbl.setText("Issurer");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 2;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            bankCardsPanel.add(cardUssurerLbl, gridBagConstraints);

            cardNoLbl.setText("Card No.");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 2;
            gridBagConstraints.gridy = 1;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            bankCardsPanel.add(cardNoLbl, gridBagConstraints);
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 3;
            gridBagConstraints.gridy = 1;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 10);
            bankCardsPanel.add(cardNumberTxt, gridBagConstraints);

            cardExpiryDateLbl.setText("Expiry Date");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 2;
            gridBagConstraints.gridy = 2;
            bankCardsPanel.add(cardExpiryDateLbl, gridBagConstraints);
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 3;
            gridBagConstraints.gridy = 2;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            bankCardsPanel.add(cardExpiryDatePicker, gridBagConstraints);

            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 1;
            gridBagConstraints.gridwidth = 5;
            gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 5.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 10, 0, 10);
            jPanel14.add(bankCardsPanel, gridBagConstraints);

            schemePanel.setBackground(new java.awt.Color(255, 239, 255));
            schemePanel.setBorder(javax.swing.BorderFactory.createTitledBorder("Select type of scheme & then select staff no"));
            schemePanel.setLayout(new java.awt.GridBagLayout());

            memberNameLbl.setText("Member Name");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 2;
            gridBagConstraints.gridy = 1;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 10, 0, 0);
            schemePanel.add(memberNameLbl, gridBagConstraints);

            memberNoLbl.setText("Member No.");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 2;
            gridBagConstraints.gridy = 2;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 10, 0, 0);
            schemePanel.add(memberNoLbl, gridBagConstraints);

            schemeExpiryDateLbl.setText("Expiry Date");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 4;
            gridBagConstraints.gridy = 2;
            gridBagConstraints.weightx = 1.0;
            schemePanel.add(schemeExpiryDateLbl, gridBagConstraints);

            schemeManagerLbl.setText("Scheme Manager");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 2;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 10, 0, 0);
            schemePanel.add(schemeManagerLbl, gridBagConstraints);

            schemeMangerTxt.setEditable(false);
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 1;
            gridBagConstraints.gridy = 2;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 2);
            schemePanel.add(schemeMangerTxt, gridBagConstraints);

            schemeNameLbl.setText("Scheme Name");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 1;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.insets = new java.awt.Insets(0, 10, 0, 0);
            schemePanel.add(schemeNameLbl, gridBagConstraints);

            schemeMemberNamePanel.setMinimumSize(new java.awt.Dimension(82, 37));
            schemeMemberNamePanel.setLayout(new java.awt.GridBagLayout());
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 1;
            gridBagConstraints.gridy = 1;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            schemeMemberNamePanel.add(memberNameTxt, gridBagConstraints);

            memberNameSearchButton.setToolTipText("Search");
            memberNameSearchButton.setHorizontalAlignment(javax.swing.SwingConstants.TRAILING);
            memberNameSearchButton.setMaximumSize(new java.awt.Dimension(74, 53));
            memberNameSearchButton.setMinimumSize(new java.awt.Dimension(74, 53));
            memberNameSearchButton.setPreferredSize(new java.awt.Dimension(40, 22));
            memberNameSearchButton.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
            memberNameSearchButton.addActionListener(new java.awt.event.ActionListener() {
                public void actionPerformed(java.awt.event.ActionEvent evt) {
                    memberNameSearchButtonActionPerformed(evt);
                }
            });
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 2;
            gridBagConstraints.gridy = 1;
            schemeMemberNamePanel.add(memberNameSearchButton, gridBagConstraints);

            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 4;
            gridBagConstraints.gridy = 1;
            gridBagConstraints.gridwidth = 3;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 10);
            schemePanel.add(schemeMemberNamePanel, gridBagConstraints);
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 3;
            gridBagConstraints.gridy = 2;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 2);
            schemePanel.add(memberNumberTxt, gridBagConstraints);

            schemeSearchNamePanel.setMinimumSize(new java.awt.Dimension(82, 37));
            schemeSearchNamePanel.setLayout(new java.awt.GridBagLayout());

            schemeNameTxt.setEditable(false);
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 1;
            gridBagConstraints.gridy = 1;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            schemeSearchNamePanel.add(schemeNameTxt, gridBagConstraints);

            schemeSearchButton.setToolTipText("Search");
            schemeSearchButton.setHorizontalAlignment(javax.swing.SwingConstants.TRAILING);
            schemeSearchButton.setMaximumSize(new java.awt.Dimension(74, 53));
            schemeSearchButton.setMinimumSize(new java.awt.Dimension(74, 53));
            schemeSearchButton.setPreferredSize(new java.awt.Dimension(40, 22));
            schemeSearchButton.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
            schemeSearchButton.addActionListener(new java.awt.event.ActionListener() {
                public void actionPerformed(java.awt.event.ActionEvent evt) {
                    schemeSearchButtonActionPerformed(evt);
                }
            });
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 2;
            gridBagConstraints.gridy = 1;
            schemeSearchNamePanel.add(schemeSearchButton, gridBagConstraints);

            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 1;
            gridBagConstraints.gridy = 1;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 3.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 2);
            schemePanel.add(schemeSearchNamePanel, gridBagConstraints);

            schemeAccNoLbl.setText("Scheme A/C No");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 3;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.insets = new java.awt.Insets(0, 10, 0, 0);
            schemePanel.add(schemeAccNoLbl, gridBagConstraints);

            schemeAccNoTxt.setEditable(false);
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 1;
            gridBagConstraints.gridy = 3;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            schemePanel.add(schemeAccNoTxt, gridBagConstraints);

            memberBalanceLbl.setText("Member Balance");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 4;
            gridBagConstraints.gridy = 3;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 10, 0, 0);
            schemePanel.add(memberBalanceLbl, gridBagConstraints);

            memberBalanceTxt.setEditable(false);
            memberBalanceTxt.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 5;
            gridBagConstraints.gridy = 3;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 20);
            schemePanel.add(memberBalanceTxt, gridBagConstraints);
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 5;
            gridBagConstraints.gridy = 2;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            schemePanel.add(schemeExpiryDatePicker, gridBagConstraints);

            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 1;
            gridBagConstraints.gridy = 1;
            gridBagConstraints.gridwidth = 5;
            gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 5.0;
            gridBagConstraints.insets = new java.awt.Insets(0, 10, 0, 10);
            jPanel14.add(schemePanel, gridBagConstraints);

            admissionsTabbedPane.addTab("Payment Information and Other details", jPanel14);

            admissionListingPanel.setLayout(new java.awt.GridBagLayout());

            admissionListingTable.setModel(com.afrisoftech.dbadmin.TableModel.createTableVectors(connectDB, "SELECT patient_no, sub_chief as unit_number, date_admitted,visit_id, patient_name, gender, pat_age as patient_age, ward, wing, mode_of_payment, data_capture_time,user_name AS registrar from hp_admission where user_name = current_user and date_admitted = now()::date order by data_capture_time"));
            refreshScrollPane.setViewportView(admissionListingTable);

            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 0;
            gridBagConstraints.gridwidth = 7;
            gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 200.0;
            admissionListingPanel.add(refreshScrollPane, gridBagConstraints);

            startDateLbl.setText("Start Date");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 1;
            gridBagConstraints.gridy = 1;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            admissionListingPanel.add(startDateLbl, gridBagConstraints);

            endDateLbl.setText("End Date");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 3;
            gridBagConstraints.gridy = 1;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            admissionListingPanel.add(endDateLbl, gridBagConstraints);
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 2;
            gridBagConstraints.gridy = 1;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            admissionListingPanel.add(startDatePicker, gridBagConstraints);
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 4;
            gridBagConstraints.gridy = 1;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            admissionListingPanel.add(endDatePicker, gridBagConstraints);

            refreshBtn.setText("Refresh listing");
            refreshBtn.addActionListener(new java.awt.event.ActionListener() {
                public void actionPerformed(java.awt.event.ActionEvent evt) {
                    refreshBtnActionPerformed(evt);
                }
            });
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 6;
            gridBagConstraints.gridy = 1;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            admissionListingPanel.add(refreshBtn, gridBagConstraints);

            reportTypeChooserCmbx.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "ALL Records Officers", "Current User" }));
            reportTypeChooserCmbx.addActionListener(new java.awt.event.ActionListener() {
                public void actionPerformed(java.awt.event.ActionEvent evt) {
                    reportTypeChooserCmbxActionPerformed(evt);
                }
            });
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 5;
            gridBagConstraints.gridy = 1;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            admissionListingPanel.add(reportTypeChooserCmbx, gridBagConstraints);
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 1;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 50.0;
            gridBagConstraints.weighty = 1.0;
            admissionListingPanel.add(spacerLabel, gridBagConstraints);

            admissionsTabbedPane.addTab("Admission Report", admissionListingPanel);

            admissionAnalysisPanel.setLayout(new java.awt.GridBagLayout());

            admissionAnalysisTable.setModel(com.afrisoftech.dbadmin.TableModel.createTableVectors(connectDB, "SELECT ward, count(ward) FROM hp_admission  where date_admitted = now()::date group by 1 order by 1"));
            admissionScrollPane.setViewportView(admissionAnalysisTable);

            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 0;
            gridBagConstraints.gridwidth = 7;
            gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 100.0;
            admissionAnalysisPanel.add(admissionScrollPane, gridBagConstraints);

            startDateLbl1.setText("Start Date");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 1;
            gridBagConstraints.gridy = 1;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            admissionAnalysisPanel.add(startDateLbl1, gridBagConstraints);

            endDateLbl1.setText("End Date");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 3;
            gridBagConstraints.gridy = 1;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            admissionAnalysisPanel.add(endDateLbl1, gridBagConstraints);
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 2;
            gridBagConstraints.gridy = 1;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            admissionAnalysisPanel.add(startDatePicker1, gridBagConstraints);
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 4;
            gridBagConstraints.gridy = 1;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            admissionAnalysisPanel.add(endDatePicker1, gridBagConstraints);

            refreshBtn1.setText("Refresh listing");
            refreshBtn1.addActionListener(new java.awt.event.ActionListener() {
                public void actionPerformed(java.awt.event.ActionEvent evt) {
                    refreshBtn1ActionPerformed(evt);
                }
            });
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 6;
            gridBagConstraints.gridy = 1;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            admissionAnalysisPanel.add(refreshBtn1, gridBagConstraints);

            reportTypeChooserCmbx1.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "ALL Records Officers", "Current User" }));
            reportTypeChooserCmbx1.addActionListener(new java.awt.event.ActionListener() {
                public void actionPerformed(java.awt.event.ActionEvent evt) {
                    reportTypeChooserCmbx1ActionPerformed(evt);
                }
            });
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 5;
            gridBagConstraints.gridy = 1;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            admissionAnalysisPanel.add(reportTypeChooserCmbx1, gridBagConstraints);
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 1;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 50.0;
            gridBagConstraints.weighty = 1.0;
            admissionAnalysisPanel.add(spacerLabel1, gridBagConstraints);

            admissionsTabbedPane.addTab("Admission analysis", admissionAnalysisPanel);

            occupancyReportPanel.setLayout(new java.awt.GridBagLayout());

            occupationsHeaderTable.setBorder(javax.swing.BorderFactory.createTitledBorder("Select the ward name here to generate occupancy report"));
            occupationsHeaderTable.setLayout(new java.awt.GridBagLayout());

            wardNameCmbx.setModel(com.afrisoftech.lib.ComboBoxModel.ComboBoxModel(connectDB, "SELECT ward_name FROM hp_wards order by ward_name"));
            wardNameCmbx.addActionListener(new java.awt.event.ActionListener() {
                public void actionPerformed(java.awt.event.ActionEvent evt) {
                    wardNameCmbxActionPerformed(evt);
                }
            });
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 1;
            gridBagConstraints.gridy = 0;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            occupationsHeaderTable.add(wardNameCmbx, gridBagConstraints);

            jLabel49.setText("Ward Name");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 0;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            occupationsHeaderTable.add(jLabel49, gridBagConstraints);

            patientNumber.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Patient Number/Unit Number", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Agency FB", 0, 10), new java.awt.Color(51, 51, 255))); // NOI18N
            patientNumber.addCaretListener(new javax.swing.event.CaretListener() {
                public void caretUpdate(javax.swing.event.CaretEvent evt) {
                    patientNumberCaretUpdate(evt);
                }
            });
            patientNumber.addActionListener(new java.awt.event.ActionListener() {
                public void actionPerformed(java.awt.event.ActionEvent evt) {
                    patientNumberActionPerformed(evt);
                }
            });
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 3;
            gridBagConstraints.gridy = 0;
            gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            occupationsHeaderTable.add(patientNumber, gridBagConstraints);

            searchFileBtn.setText("Search Patient File by Number");
            searchFileBtn.addActionListener(new java.awt.event.ActionListener() {
                public void actionPerformed(java.awt.event.ActionEvent evt) {
                    searchFileBtnActionPerformed(evt);
                }
            });
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 4;
            gridBagConstraints.gridy = 0;
            occupationsHeaderTable.add(searchFileBtn, gridBagConstraints);

            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            occupancyReportPanel.add(occupationsHeaderTable, gridBagConstraints);

            occupationsPanel.setBorder(javax.swing.BorderFactory.createTitledBorder("Ward occupation data"));
            occupationsPanel.setLayout(new java.awt.GridBagLayout());

            occupationTable.setBorder(javax.swing.BorderFactory.createTitledBorder(""));
            occupationTable.setModel(new javax.swing.table.DefaultTableModel(
                new Object [][] {

                },
                new String [] {

                }
            ));
            occupationJScrl.setViewportView(occupationTable);

            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 0;
            gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
            gridBagConstraints.ipadx = 431;
            gridBagConstraints.ipady = 292;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            occupationsPanel.add(occupationJScrl, gridBagConstraints);

            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 1;
            gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 500.0;
            occupancyReportPanel.add(occupationsPanel, gridBagConstraints);

            occupationButtonPanel.setLayout(new java.awt.GridBagLayout());

            jButton7.setMnemonic('U');
            jButton7.setText("Refresh occupancy information");
            jButton7.addActionListener(new java.awt.event.ActionListener() {
                public void actionPerformed(java.awt.event.ActionEvent evt) {
                    jButton7ActionPerformed(evt);
                }
            });
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 1;
            gridBagConstraints.gridy = 0;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            occupationButtonPanel.add(jButton7, gridBagConstraints);

            jButton8.setMnemonic('C');
            jButton8.setText("Clear form");
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 2;
            gridBagConstraints.gridy = 0;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            occupationButtonPanel.add(jButton8, gridBagConstraints);

            jButton10.setMnemonic('o');
            jButton10.setText("Close form");
            jButton10.addActionListener(new java.awt.event.ActionListener() {
                public void actionPerformed(java.awt.event.ActionEvent evt) {
                    jButton10ActionPerformed(evt);
                }
            });
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 3;
            gridBagConstraints.gridy = 0;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            occupationButtonPanel.add(jButton10, gridBagConstraints);

            totalsLabel.setForeground(new java.awt.Color(0, 0, 204));
            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 0;
            gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
            gridBagConstraints.weightx = 200.0;
            gridBagConstraints.weighty = 1.0;
            occupationButtonPanel.add(totalsLabel, gridBagConstraints);

            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 2;
            gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            occupancyReportPanel.add(occupationButtonPanel, gridBagConstraints);

            admissionsTabbedPane.addTab("Wards Occupancy Report", occupancyReportPanel);

            previousPanel.setLayout(new java.awt.GridBagLayout());

            previousVisitsTable.setModel(new javax.swing.table.DefaultTableModel(
                new Object [][] {

                },
                new String [] {

                }
            ));
            previousVisitsScrollPane.setViewportView(previousVisitsTable);

            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
            gridBagConstraints.weightx = 1.0;
            gridBagConstraints.weighty = 1.0;
            previousPanel.add(previousVisitsScrollPane, gridBagConstraints);

            admissionsTabbedPane.addTab("Previous Visits", previousPanel);

            gridBagConstraints = new java.awt.GridBagConstraints();
            gridBagConstraints.gridx = 0;
            gridBagConstraints.gridy = 2;
            gridBagConstraints.gridwidth = java.awt.GridBagConstraints.RELATIVE;
            gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
            gridBagConstraints.weightx = 20.0;
            gridBagConstraints.weighty = 100.0;
            getContentPane().add(admissionsTabbedPane, gridBagConstraints);

            setBounds(0, 0, 1247, 679);
        }// </editor-fold>//GEN-END:initComponents

    private void suspendBillChkbxActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_suspendBillChkbxActionPerformed
        String selectedchkbx;
        if (this.suspendBillChkbx.isSelected()) {
            int exitOption = javax.swing.JOptionPane.showConfirmDialog(this, "Do you want to suspend existing unfinalised bill?", "Caution before Saving!", javax.swing.JOptionPane.YES_NO_CANCEL_OPTION);

            if (exitOption == javax.swing.JOptionPane.YES_OPTION) {

                try {

                    java.sql.PreparedStatement pstmt1 = connectDB.prepareStatement("update hp_admission set check_out = true where check_out = false and patient_no ='" + admissionNumberTxt.getText() + "' AND DISCHARGE = true");
                    pstmt1.executeUpdate();

                } catch (java.sql.SQLException sq) {
                    System.out.println(sq.getMessage());
                    javax.swing.JOptionPane.showMessageDialog(this, sq.getMessage(), "Error Message!", javax.swing.JOptionPane.ERROR_MESSAGE);

                }

            } else {
                javax.swing.JOptionPane.showMessageDialog(this, "Thank You for taking caution", "Confirmation Message", javax.swing.JOptionPane.INFORMATION_MESSAGE);

            }
        } else {
        }
// TODO add your handling code here:
    }//GEN-LAST:event_suspendBillChkbxActionPerformed

    private void jButton5ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton5ActionPerformed
//    System.setProperty("docsdir",System.getProperty("user.dir"));
        java.io.File xmlDocFile = null;
        //  try {

        // xmlDocFile = java.io.File.createTempFile("CLAIM"+biz.systempartners.claims.DateLables.getDateLabel()+"_", ".xml", new java.io.File(System.getProperty("docsdir")));
        xmlDocFile = new java.io.File(System.getProperty("docsdir"), "ForwardedCardData.xml");//.createTempFile("HospitalClaimsFile", ".xml", new java.io.File(System.getProperty("docsdir")));

        // } catch(java.io.IOException ioExec){
        //    ioExec.printStackTrace();
        // }
        biz.systempartners.claims.XMLClaimFile claimFile = new biz.systempartners.claims.XMLClaimFile();

        claimFile.processFile(xmlDocFile);

        admissionNumberTxt.setText(claimFile.patientNumber);
        surNameTxt.setText(claimFile.patientSurName);
        firstNameTxt.setText(claimFile.patientForenames);
        paymentModeCmbx.setSelectedItem("Scheme");
        postalAddressTxt.setText(claimFile.patientAddress);
        nokTelephoneTxt.setText(claimFile.patientTelephone);
        //  emailAddTxt.setText(claimFile.patientEmail);
        java.text.SimpleDateFormat dateFormat = new java.text.SimpleDateFormat();//.getInstance();

        dateFormat.applyPattern("yyyy-MM-dd");
        //jTextField6.setText(claimFile.patientDOB);
        if (claimFile.patientDOB != null) {
            try {
                datePickerYOB.setDate(dateFormat.parse(claimFile.patientDOB));
            } catch (ParseException ex) {
                ex.printStackTrace();
                javax.swing.JOptionPane.showMessageDialog(this, ex.getMessage());
            }
        }

        memberNumberTxt.setText(claimFile.cardNumber);
        memberNameTxt.setText(claimFile.patientSurName + " " + claimFile.patientForenames);
        schemeNameTxt.setText(claimFile.medicalAidCode);
        schemeMangerTxt.setText(claimFile.medicalAidPlan);
        // TODO add your handling code here:
    }//GEN-LAST:event_jButton5ActionPerformed

    private void mergeOPBillChkbxActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_mergeOPBillChkbxActionPerformed
        com.afrisoftech.accounting.MergingPatientBillIntfr other = new com.afrisoftech.accounting.MergingPatientBillIntfr(connectDB, pConnDB);
        this.getParent().add(other, javax.swing.JLayeredPane.DEFAULT_LAYER);
        try {
            other.setSelected(true);
        } catch (java.beans.PropertyVetoException pvt) {
        }
        other.setVisible(true);// TODO add your handling code here:
    }//GEN-LAST:event_mergeOPBillChkbxActionPerformed

    private void admissionWardCmbxMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_admissionWardCmbxMouseClicked
    }//GEN-LAST:event_admissionWardCmbxMouseClicked

    private void jSearchTable3MouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jSearchTable3MouseClicked

        System.out.println("Starting To Query Patient data\n");
        String name = null;
        String patientNo = null;
        int pNo = 0;
        //   referredFromTxt.setText("");
        postalAddressTxt.setText("");
        nokTelephoneTxt.setText("");
        nokNameTxt.setText("");
        firstNameTxt.setText("");
        wardCodeTxt.setText("");
        surNameTxt.setText("");
        //jTextField6.setText("");
        // jTextField12.setText("");
        memberNumberTxt.setText("");
        currentResidence.setText("");
        billPayerTxt.setText("");
        bedRateTxt.setText("");
        schemeNameTxt.setText("");
        schemeMangerTxt.setText("");
        memberNameTxt.setText("");
        previousVisitIDTxt.setText("");
        opdSearchButton.setEnabled(false);
        searchButton.setEnabled(true);
//        searchbyPatientNameChkbx.setEnabled(true);
//        searchbyPatientNumberChkbx.setEnabled(true);
        dischargedChkbx.setEnabled(true);
        admittedChbx.setEnabled(true);
//        referredFromTxt.setEditable(true);
        postalAddressTxt.setEditable(true);
        nokTelephoneTxt.setEditable(true);
        nokNameTxt.setEditable(true);
        firstNameTxt.setEditable(true);
        surNameTxt.setEditable(true);
        //jTextField6.setEditable(true);
        admissionNumberTxt.setEditable(true);
        memberNumberTxt.setEditable(true);
        currentResidence.setEditable(true);
        billPayerTxt.setEditable(true);
        schemeNameTxt.setEditable(true);
        opdNoTxt.setEditable(false);
        schemeMangerTxt.setEditable(true);
        memberNameTxt.setEditable(true);
//        admissionNumber.setText(jSearchTable3.getValueAt(jSearchTable3.getSelectedRow(), 0).toString());
//        jTextField122.setText(jSearchTable3.getValueAt(jSearchTable3.getSelectedRow(), 2).toString());
//        surNameTxt.setText(jSearchTable3.getValueAt(jSearchTable3.getSelectedRow(), 1).toString());
        System.out.println("Finished Clearing Form\n Starting Populating Form, Please wait...");
        admissionNumberTxt.setText(jSearchTable3.getValueAt(jSearchTable3.getSelectedRow(), 0).toString());
        firstNameTxt.setText(jSearchTable3.getValueAt(jSearchTable3.getSelectedRow(), 1).toString());
        surNameTxt.setText(jSearchTable3.getValueAt(jSearchTable3.getSelectedRow(), 2).toString());
        previousVisitIDTxt.setText(jSearchTable3.getValueAt(jSearchTable3.getSelectedRow(), 4).toString());

        System.out.println("Finished Populating Form\n Starting Patient Query, Please wait...");
        try {

            java.sql.Statement stmt112 = connectDB.createStatement();
            java.sql.ResultSet rset112 = stmt112.executeQuery("select nationality,occupation,pat_religion,pat_district,sub_chief,nok_relationship,home_county,residence_county,education_level,id_no,pat_location,chief_name,speciality,nok_residence,marital_status from hp_admission where patient_no ='" + admissionNumberTxt.getText() + "' and  visit_id = '" + previousVisitIDTxt.getText() + "' ");
            while (rset112.next()) {
                nationalityCmbx.setSelectedItem(rset112.getObject(1).toString().trim());
                occupationCmbx.setSelectedItem(rset112.getObject(2));
                religionCmbx.setSelectedItem(rset112.getObject(3));

                if (rset112.getObject(4).toString().equalsIgnoreCase("")) {
                    districtCmbx.setSelectedItem("-");
                } else {
                    districtCmbx.setSelectedItem(rset112.getObject(4).toString());
                }
                //  districtCmbx.setSelectedItem( "-");
                //districtCmbx.setSelectedItem(rset112.getObject(4).toString());
                unitNumberTxt.setText(rset112.getObject(5).toString());
                nokRelationShipCmbx.setSelectedItem(rset112.getObject(6));
                countyofBirthCmbx.setSelectedItem(rset112.getObject(7));
                countyofResidenceCmbx.setSelectedItem(rset112.getObject(8));
                educationLevelCmbx.setSelectedItem(rset112.getObject(9));
                if (rset112.getObject(10).toString().equalsIgnoreCase("")) {
                    idPassportTxt.setText("-");
                } else {
                    idPassportTxt.setText(rset112.getObject(10).toString());
                }

                if (rset112.getObject(11).toString().equalsIgnoreCase("")) {
                    locationTxt.setText("-");
                } else {
                    locationTxt.setText(rset112.getObject(11).toString());
                }

                if (rset112.getObject(12).toString().equalsIgnoreCase("")) {
                    nameofChiefTxt.setText("-");
                } else {
                    nameofChiefTxt.setText(rset112.getObject(12).toString());
                }

                specialtyClinicCmbx.setSelectedItem(rset112.getObject(13).toString());
                nokResidenceTxt.setText(rset112.getObject(14).toString());

                if (rset112.getObject(15).toString().startsWith("S")) {
                    singleMaritalChkbx.setSelected(true);

                }
                if (rset112.getObject(15).toString().startsWith("M")) {
                    marriedMaritalChkbx.setSelected(true);
                }
                if (rset112.getObject(15).toString().startsWith("D")) {
                    divorcedMaritalChkbx.setSelected(true);
                }
                if (rset112.getObject(15).toString().startsWith("W")) {
                    widowedMaritalChkbx.setSelected(true);
                }

            }

            java.sql.Statement stmt = connectDB.createStatement();
            java.sql.ResultSet rset = stmt.executeQuery("select nok,residence,year_of_birth::date,address,sex,tel_no,('now'::date-year_of_birth::date)/365 from hp_inpatient_register where patient_no ='" + admissionNumberTxt.getText() + "'");
            while (rset.next()) {
                //  jTextField2.setText(rset.getObject(1).toString());
                nokNameTxt.setText(rset.getObject(1).toString());
                currentResidence.setText(rset.getObject(2).toString());
                java.text.DateFormat df = java.text.DateFormat.getDateInstance();
                java.text.SimpleDateFormat sdf = (java.text.SimpleDateFormat) df;
                ageTxt.setText(rset.getObject(7).toString());
                sdf.applyPattern("yyyy-MM-dd");
                try {
                    datePickerYOB.setDate(sdf.parse(rset.getString(3)));
                } catch (java.text.ParseException pe) {
                    javax.swing.JOptionPane.showMessageDialog(this, pe.getMessage());
                }
                postalAddressTxt.setText(rset.getObject(4).toString());
                nokTelephoneTxt.setText(rset.getObject(6).toString());
                if (rset.getObject(5).toString().startsWith("M")) {
                    maleChkbx.setSelected(true);
                } else {
                    femaleChkbx.setSelected(true);
                }
            }

            System.out.println("Query Progress ongoing, Please wait...");

            java.sql.Statement stmt11 = connectDB.createStatement();
            java.sql.ResultSet rset11 = stmt11.executeQuery("select patient_no from hp_admission where patient_no ='" + admissionNumberTxt.getText() + "' and discharge = false");
            while (rset11.next()) {
                // jComboBox1.setSelectedItem(rset11.getObject(1).toString());
                name = rset11.getObject(1).toString();
            }
            //  if(jRadioButton1.isSelected()){
            boolean checkOut = false;
            java.sql.Statement stmt1111xx = connectDB.createStatement();
            java.sql.ResultSet rset1111x = stmt1111xx.executeQuery("select check_out from hp_admission where patient_no ='" + admissionNumberTxt.getText() + "' order by date_admitted DESC LIMIT 1");
            while (rset1111x.next()) {
                checkOut = rset1111x.getBoolean(1);
            }

            ipSearchDialog.dispose();

            System.out.println("We are Almost Finishing to load, Please wait...");
            //  jComboBox6.setSelectedItem(jTextField17.getText().toString());
            if (!editReprintBtn.isSelected()) {
                if (admissionNumberTxt.getText().equalsIgnoreCase(name)) {
                    javax.swing.JOptionPane.showMessageDialog(this, " Patient already admitted ", "Error", javax.swing.JOptionPane.ERROR_MESSAGE);

                    admissionNumberTxt.setText("");
                    surNameTxt.setText("");
                }
            }
            //  if(checkOut == false){
            //      javax.swing.JOptionPane.showMessageDialog(this," Patient cannot be re-admitted with unfinalised invoice pending", "Error",javax.swing.JOptionPane.ERROR_MESSAGE);

            //  }else{
            java.sql.Statement stmtf = connectDB.createStatement();
            java.sql.ResultSet rsetf = stmtf.executeQuery("select patient_no from hp_inpatient_register where patient_no ='" + this.admissionNumberTxt.getText() + "'");
            while (rsetf.next()) {
                patientNo = rsetf.getObject(1).toString();
            }

            java.sql.Statement stmt11f = connectDB.createStatement();

            java.sql.ResultSet rset11f = stmt11f.executeQuery("select patient_no,check_out from hp_admission where patient_no ='" + admissionNumberTxt.getText() + "' and check_out = false");
            while (rset11f.next()) {
                // jComboBox1.setSelectedItem(rset11.getObject(1).toString());
                //  name = rset11f.getObject(1).toString();
                if (rset11f.getBoolean(2) == false) {
                    hasInterimBillChkbx.setSelected(true);
                } else {
                    hasInterimBillChkbx.setSelected(false);
                }
            }

            java.sql.Statement stmt111 = connectDB.createStatement();
            java.sql.ResultSet rset111 = stmt111.executeQuery("select count (patient_no) from hp_admission where patient_no ='" + admissionNumberTxt.getText() + "'");
            while (rset111.next()) {
                // jComboBox1.setSelectedItem(rset11.getObject(1).toString());
                pNo = rset111.getInt(1);
            }
            if (pNo > 0) {

                java.sql.Statement stmt1111 = connectDB.createStatement();
                java.sql.ResultSet rset1111 = stmt1111.executeQuery("select date_admitted::date,discharge_date::date,CASE WHEN (visit_id IS NULL) THEN '-' ELSE visit_id END AS visit_id,ward,bed_no from hp_admission where patient_no ='" + admissionNumberTxt.getText() + "' order by date_admitted DESC LIMIT 1");
                while (rset1111.next()) {
                    previousDischargeDateTxt.setText(rset1111.getObject(2).toString());
                    previousAdmissionDateTxt.setText(rset1111.getObject(1).toString());
                    previousVisitIDTxt.setText(rset1111.getObject(3).toString());
                    wardAdmittedTxt.setText(rset1111.getObject(4).toString());
                    bedoccupiedTxt.setText(rset1111.getObject(5).toString());
                }
            }
            //  }
            System.out.println("Finished Populating Form , Thankyou For Waiting");

        } catch (java.sql.SQLException sqe) {

            sqe.printStackTrace();
            System.out.println("Select not successful");
            System.out.println("We have a problem");
        }
        this.previousVisitIDDialog.dispose();
        // Add your handling code here:
    }//GEN-LAST:event_jSearchTable3MouseClicked

    private void jButton513ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton513ActionPerformed
        previousVisitIDDialog.dispose();    // Add your handling code here:
    }//GEN-LAST:event_jButton513ActionPerformed

    private void previousVisitSearchButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_previousVisitSearchButtonActionPerformed
        this.admitBtn.setVisible(true);
        this.admitBtn.setText("Update");
        searchButtonClicked3(); // Add your handling code here:

        // Add your handling code here:
    }//GEN-LAST:event_previousVisitSearchButtonActionPerformed
    private void searchButtonClicked3() {

        System.out.println("Showing dialog");

        java.awt.Point point = this.previousVisitIDLbl.getLocationOnScreen();

        previousVisitIDDialog.setSize(700, 200);

        previousVisitIDDialog.setLocation(point);

        previousVisitIDDialog.setVisible(true);

    }
    private void jTextField1114CaretUpdate(javax.swing.event.CaretEvent evt) {//GEN-FIRST:event_jTextField1114CaretUpdate

        //query update to obtain last visit_id by ordering descending >> WHERE hp.patient_no = hd.patient_no order by 1 desc  LIMIT 1
        if (jTextField1114.getCaretPosition() < 4) {

            System.out.println("Nothing");
        } else {
            if (this.searchbyPatientNameChkbx.isSelected()) {
                jSearchTable3.setModel(com.afrisoftech.dbadmin.TableModel.createTableVectors(connectDB, ""
                        + "SELECT hd.patient_no, (upper(hd.second_name||' '||hd.last_name)) as name, hd.first_name AS surname, "
                        + "(SELECT hp.sub_chief FROM hp_admission hp WHERE hp.patient_no = hd.patient_no order by 1 LIMIT 1) as unit_number,"
                        + "(SELECT hp.visit_id FROM hp_admission hp WHERE hp.patient_no = hd.patient_no order by 1 desc  LIMIT 1) as VisitId"
                        + " from hp_inpatient_register hd where (upper(hd.second_name||' '||hd.first_name||' '||hd.last_name)) ILIKE '%" + jTextField1114.getText().toString() + "%' ORDER BY second_name"));
                jSearchTable3.setShowHorizontalLines(false);
                jSearchScrollPane3.setViewportView(jSearchTable3);

            } else {
                if (this.searchbyPatientNumberChkbx.isSelected()) {
                    jSearchTable3.setModel(com.afrisoftech.dbadmin.TableModel.createTableVectors(connectDB, ""
                            + "SELECT hd.patient_no, (upper(hd.second_name||' '||hd.last_name)) as name,hd.first_name AS surname, "
                            + "(SELECT hp.sub_chief FROM hp_admission hp WHERE hp.patient_no = hd.patient_no order by 1 LIMIT 1) as unit_number, "
                            + "(SELECT hp.visit_id FROM hp_admission hp WHERE hp.patient_no = hd.patient_no order by 1 desc LIMIT 1) as VisitId "
                            + "from hp_inpatient_register hd where hd.patient_no ILIKE '%" + jTextField1114.getText().toString() + "%' or (SELECT hp.sub_chief FROM hp_admission hp WHERE hp.patient_no = hd.patient_no order by 1 LIMIT 1) ilike '%" + jTextField1114.getText().toString() + "%' ORDER BY second_name"));
                    jSearchTable3.setShowHorizontalLines(false);
                    jSearchScrollPane3.setViewportView(jSearchTable3);

                }
            }

//            if (this.searchbyPatientNameChkbx.isSelected()) {
//                jSearchTable3.setModel(com.afrisoftech.dbadmin.TableModel.createTableVectors(connectDB, "SELECT patient_no, patient_name as name,visit_id from hp_admission where (upper(patient_name)) ILIKE '" + jTextField1114.getText().toString() + "%' AND visit_id IS NOT NULL  ORDER BY patient_name"));
//
//                jSearchTable3.setShowHorizontalLines(false);
//                jSearchScrollPane3.setViewportView(jSearchTable3);
//
//
//
//            } else {
//                if (this.searchbyPatientNumberChkbx.isSelected()) {
//                    jSearchTable3.setModel(com.afrisoftech.dbadmin.TableModel.createTableVectors(connectDB, "SELECT patient_no, patient_name as name,visit_id from hp_admission where patient_no ILIKE '" + jTextField1114.getText().toString() + "%' AND visit_id IS NOT NULL ORDER BY patient_no"));
//
//                    jSearchTable3.setShowHorizontalLines(false);
//                    jSearchScrollPane3.setViewportView(jSearchTable3);
//
//
//                }
//            }
        }   // Add your handling code here:
    }//GEN-LAST:event_jTextField1114CaretUpdate

    private void bedCategoryCmbxActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_bedCategoryCmbxActionPerformed
        try {

            java.sql.Statement stmt = connectDB.createStatement();
            java.sql.ResultSet rset = stmt.executeQuery("select rate from hp_bed_category where category ='" + bedCategoryCmbx.getSelectedItem() + "'");
            while (rset.next()) {
                //   jTextField5.setText(rset.getObject(1).toString());
                bedRateTxt.setText(rset.getObject(1).toString());
            }
        } catch (java.sql.SQLException sqe) {
            sqe.printStackTrace();
            System.out.println("Select not successful");
        }          // Add your handling code here:
    }//GEN-LAST:event_bedCategoryCmbxActionPerformed

    private void admittedByBtnActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_admittedByBtnActionPerformed
        searchButton11bClicked();    // Add your handling code here:
    }//GEN-LAST:event_admittedByBtnActionPerformed

    private void jButton5121ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton5121ActionPerformed
        jSearchDialog21.dispose();   // Add your handling code here:
    }//GEN-LAST:event_jButton5121ActionPerformed

    private void jSearchTable21MouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jSearchTable21MouseClicked
        admittedByTxt.setText(jSearchTable21.getValueAt(jSearchTable21.getSelectedRow(), 0).toString());
        //jTextField13.setText(jSearchTable1.getValueAt(jSearchTable1.getSelectedRow(), 0).toString());
        //jTextField23.setText(jSearchTable2.getValueAt(jSearchTable2.getSelectedRow(), 2).toString());
        jSearchDialog21.dispose();   // Add your handling code here:
    }//GEN-LAST:event_jSearchTable21MouseClicked

    private void jTextField11131CaretUpdate(javax.swing.event.CaretEvent evt) {//GEN-FIRST:event_jTextField11131CaretUpdate
        if (jTextField11131.getCaretPosition() < 2) {

            System.out.println("Nothing");
        } else {

            jSearchTable21.setModel(com.afrisoftech.dbadmin.TableModel.createTableVectors(connectDB, "SELECT first_name||' '||middle_name as name from pb_doctors_list where status ILIKE 'acti%' and first_name||' '||middle_name ILIKE '%" + jTextField11131.getText() + "%' order by first_name||' '||middle_name"));

            jSearchTable21.setShowHorizontalLines(false);
            jSearchScrollPane21.setViewportView(jSearchTable21);

        }  // Add your handling code here:
    }//GEN-LAST:event_jTextField11131CaretUpdate
    private void searchButton11bClicked() {

        System.out.println("Showing dialog");

        jSearchDialog21.dispose();
        java.awt.Point point = this.admittedByTxt.getLocationOnScreen();

        jSearchDialog21.setSize(700, 200);

        jSearchDialog21.setLocation(point);
        jSearchDialog21.setVisible(true);

    }
    private void reAdmissionRbtnActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_reAdmissionRbtnActionPerformed
        admitPrintBtn.setEnabled(true);
        reprintFileBtn.setEnabled(false);
        jButton2.setEnabled(true);
        this.admitBtn.setText("Admit");
        admitPrintBtn.setText("Admit & Print");
        this.admitBtn.setVisible(true);
//        referredFromTxt.setEditable(false);
        postalAddressTxt.setEditable(false);
        nokTelephoneTxt.setEditable(true);
        nokNameTxt.setEditable(true);
        firstNameTxt.setEditable(false);
        surNameTxt.setEditable(false);
        //jTextField6.setEditable(false);
        admissionNumberTxt.setEditable(false);
        memberNumberTxt.setEditable(false);
        currentResidence.setEditable(true);
        billPayerTxt.setText("");
        schemeNameTxt.setEditable(false);
        schemeMangerTxt.setEditable(false);
        memberNameTxt.setEditable(false);
        searchButton.setEnabled(true);
        opdSearchButton.setEnabled(false);
//        searchbyPatientNameChkbx.setEnabled(true);
//        searchbyPatientNumberChkbx.setEnabled(true);
        dischargedChkbx.setEnabled(false);
        admittedChbx.setEnabled(false);
        religionCmbx.setSelectedIndex(-1);
        nationalityCmbx.setSelectedIndex(-1);
        districtCmbx.setSelectedIndex(-1);
        occupationCmbx.setSelectedIndex(-1);
        admissionWardCmbx.setSelectedIndex(-1);
        bedNumberCmbx.setSelectedIndex(-1);
        bedCategoryCmbx.setSelectedIndex(-1);
        specialtyClinicCmbx.setSelectedIndex(-1);
        nokRelationShipCmbx.setSelectedIndex(-1);
        countyofBirthCmbx.setSelectedItem("-");
        educationLevelCmbx.setSelectedItem("-");
        paymentModeCmbx.setSelectedItem("-");
        countyofResidenceCmbx.setSelectedItem("-");
        nokNameTxt.setText("");
        nokResidenceTxt.setText("");
        employerTelTxt.setText("");
        cSheetNoTxt.setText("");
        nokTelephoneTxt.setText("");
        employerTxt.setText("");
        currentResidence.setText("");
        unitNumberTxt.setText("");
        idPassportTxt.setText("");
        nameofChiefTxt.setText("");
        locationTxt.setText("");
        firstNameTxt.setText("");
        try {
            java.text.DateFormat df = java.text.DateFormat.getDateInstance();

            java.text.SimpleDateFormat sdf = (java.text.SimpleDateFormat) df;

            sdf.applyPattern("yyyy-MM-dd");
            java.sql.Statement stmtx2 = connectDB.createStatement();
            java.sql.ResultSet rsetx2 = stmtx2.executeQuery("SELECT CURRENT_DATE::DATE");
            try {
                while (rsetx2.next()) {
                    admissionDatePicker.setDate(sdf.parse(rsetx2.getObject(1).toString()));
                }
            } catch (java.text.ParseException pe) {
                javax.swing.JOptionPane.showMessageDialog(this, pe.getMessage());
            }
        } catch (java.sql.SQLException SqlExec) {
            SqlExec.printStackTrace();
            javax.swing.JOptionPane.showMessageDialog(new javax.swing.JFrame(), SqlExec.getMessage());

        }
        // Add your handling code here:
    }//GEN-LAST:event_reAdmissionRbtnActionPerformed

    private void newAdimissionRbtnActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_newAdimissionRbtnActionPerformed

        resetFields();
        admitPrintBtn.setEnabled(true);
        admitPrintBtn.setText("Admit & Print");
        jButton2.setEnabled(true);
        reprintFileBtn.setEnabled(false);
        /*
         this.admitPrintBtn.setEnabled(true);
         this.jButton1.setVisible(true);
         this.jButton1.setText("Admit");
         referredFromTxt.setText("");
         jTextField9.setText("");
         nokTelephoneTxt.setText("");
         nokNameTxt.setText("");
         firstNameTxt.setText("");
         wardCodeTxt.setText("");
         surNameTxt.setText("");
         //jTextField6.setText("");
         admissionNumber.setText("");
         memberNumberTxt.setText("");
         currentResidence.setText("");
         jTextField4.setText("");
         jTextField3611.setText("");
         jTextField361.setText("");
         jTextField23.setText("");
         jTextField36.setText("");
         searchButton1.setEnabled(true);
         searchButton.setEnabled(true);
         searchbyPatientNameChkbx.setEnabled(true);
         searchbyPatientNumberChkbx.setEnabled(true);
         jCheckBox311.setEnabled(false);
         jCheckBox221.setEnabled(false);
         referredFromTxt.setEditable(true);
         jTextField9.setEditable(true);
         nokTelephoneTxt.setEditable(true);
         nokNameTxt.setEditable(true);
         firstNameTxt.setEditable(true);
         surNameTxt.setEditable(true);
         //jTextField6.setEditable(true);
         admissionNumber.setEditable(true);
         memberNumberTxt.setEditable(true);
         currentResidence.setEditable(true);
         jTextField4.setEditable(true);
         jTextField3611.setEditable(true);
         jTextField361.setEditable(false);
         jTextField23.setEditable(true);
         jTextField36.setEditable(true);
         String useonenumber = null;
         religionCmbx.setSelectedIndex(-1);
         nationalityCmbx.setSelectedIndex(-1);
         districtCmbx.setSelectedIndex(-1);
         occupationCmbx.setSelectedIndex(-1);
         admissionWardCmbx.setSelectedIndex(-1);
         bedNumberCmbx.setSelectedIndex(-1);
         bedCategoryCmbx.setSelectedIndex(-1);
         specialtyClinicCmbx.setSelectedIndex(-1);
         nokRelationShipCmbx.setSelectedIndex(-1);
         countyofBirthCmbx.setSelectedIndex(-1);
         educationLevelCmbx.setSelectedIndex(-1);
         paymentModeCmbx.setSelectedIndex(-1);
         countyofResidenceCmbx.setSelectedIndex(-1);
         try {

         java.text.DateFormat df = java.text.DateFormat.getDateInstance();

         java.text.SimpleDateFormat sdf = (java.text.SimpleDateFormat) df;

         sdf.applyPattern("yyyy-MM-dd");
         java.sql.Statement stmtx2 = connectDB.createStatement();
         java.sql.ResultSet rsetx2 = stmtx2.executeQuery("SELECT CURRENT_DATE::DATE");
         try {
         while (rsetx2.next()) {
         datePicker1.setDate(sdf.parse(rsetx2.getObject(1).toString()));
         }
         } catch (java.text.ParseException pe) {
         javax.swing.JOptionPane.showMessageDialog(this, pe.getMessage());
         }
         java.sql.Statement stmtx = connectDB.createStatement();
         java.sql.ResultSet rsetx = stmtx.executeQuery("select ip_numbering,use_one_number from pb_patient_names");
         while (rsetx.next()) {
         autonumber = rsetx.getBoolean(1);
         useonenumber = rsetx.getString(2);
         java.sql.Statement pss1 = connectDB.createStatement();
         java.sql.ResultSet rss1 = pss1.executeQuery("select patient_no from hp_inpatient_register ORDER BY OID desc LIMIT 1");
         while (rss1.next()) {
         // patientsNo = rss1.getObject(1).toString();
         //   jTextField24.setText(rss1.getObject(1).toString());
         }
         }
         rsetx.close();
         stmtx.close();
         if (autonumber) {
         admissionNumber.setEditable(false);

         } else {
         admissionNumber.setEditable(true);
         }

         } catch (java.sql.SQLException sqe) {
         sqe.printStackTrace();
         System.out.println("selection not successful");
         }*/
        // Add your handling code here:
    }//GEN-LAST:event_newAdimissionRbtnActionPerformed

    private void jButton1521ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton1521ActionPerformed
        //    javax.swing.JFrame bank = new InPatientRegister(connectDB, pConnDB, jTextField361.getText());
        //    bank.setVisible(true);         // Add your handling code here:
    }//GEN-LAST:event_jButton1521ActionPerformed

    private void schemeSearchBtnActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_schemeSearchBtnActionPerformed
        schemeSearchDialog.dispose();      // Add your handling code here:
    }//GEN-LAST:event_schemeSearchBtnActionPerformed

    private void schemeSearchTableMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_schemeSearchTableMouseClicked
        schemeNameTxt.setText(schemeSearchTable.getValueAt(schemeSearchTable.getSelectedRow(), 1).toString());
        schemeAccNoTxt.setText(schemeSearchTable.getValueAt(schemeSearchTable.getSelectedRow(), 0).toString());
        schemeMangerTxt.setText(schemeSearchTable.getValueAt(schemeSearchTable.getSelectedRow(), 2).toString());
        schemeSearchDialog.dispose();
        try {
            connectDB.setAutoCommit(false);

            java.sql.Statement stmt = connectDB.createStatement();
            java.sql.ResultSet rset = stmt.executeQuery("select suspended, closed from ac_schemes where scheme_name = '" + schemeNameTxt.getText() + "' and payer_name = '" + schemeMangerTxt.getText() + "'");
            while (rset.next()) {
                if (rset.getObject(1).toString().equalsIgnoreCase("true")) {

                    javax.swing.JOptionPane.showMessageDialog(this, "SCHEME SUSPENDED !!", "Error MESSAGE", javax.swing.JOptionPane.ERROR_MESSAGE);
                    schemeNameTxt.setText("");
                    schemeMangerTxt.setText("");
                } else {
                    // jTextField361.setText("");
                }
            }
            while (rset.next()) {
                if (rset.getObject(2).toString().equalsIgnoreCase("true")) {

                    javax.swing.JOptionPane.showMessageDialog(this, "SCHEME CLOSED !!", "Error MESSAGE", javax.swing.JOptionPane.ERROR_MESSAGE);
                    schemeNameTxt.setText("");
                    schemeMangerTxt.setText("");
                } else {
                }
            }
        } catch (java.sql.SQLException sqlExec) {

            javax.swing.JOptionPane.showMessageDialog(this, sqlExec.getMessage());

        }

        schemeSearchDialog.dispose();        // Add your handling code here:
    }//GEN-LAST:event_schemeSearchTableMouseClicked

    private void schemeSearchTxtCaretUpdate(javax.swing.event.CaretEvent evt) {//GEN-FIRST:event_schemeSearchTxtCaretUpdate
        if (schemeSearchTxt.getCaretPosition() < 1) {

            System.out.println("Nothing");
        } else {

            schemeSearchTable.setModel(com.afrisoftech.dbadmin.TableModel.createTableVectors(connectDB, "SELECT account_no,scheme_name,payer_name from ac_schemes where scheme_name ILIKE '" + schemeSearchTxt.getText() + "%' and (allowed ilike 'Both' or allowed ilike 'IP%') order by scheme_name"));

            /*
             * try {
             *
             * searchRowSet2.execute("SELECT account_no,scheme_name,payer_name
             * from ac_schemes where scheme_name ILIKE
             * '"+jTextField1113.getText()+"%' and (allowed ilike 'Both' or
             * allowed ilike 'IP%') order by scheme_name"); //
             * searchRowSet.execute("SELECT patient_no, (upper(first_name||'
             * '||second_name)) as name, year_of_birth, residence from
             * hp_patient_register where (upper(first_name||' '||second_name))
             * ILIKE '"+jTextField11.getText()+"%' order by first_name");
             *
             * jSearchTable2.setModel(new
             * org.netbeans.lib.sql.models.TableModel(searchRowSet2, new
             * org.netbeans.lib.sql.models.TableModel.Column[] { new
             * org.netbeans.lib.sql.models.TableModel.Column("account_no",
             * "Account no", false), new
             * org.netbeans.lib.sql.models.TableModel.Column("scheme_name",
             * "Name", false), new
             * org.netbeans.lib.sql.models.TableModel.Column("payer_name",
             * "Payer", false)
             *
             * }));
             */
            schemeSearchTable.setShowHorizontalLines(false);
            schemeSearchScrollPane.setViewportView(schemeSearchTable);

        }         // Add your handling code here:
    }//GEN-LAST:event_schemeSearchTxtCaretUpdate

    private void schemeSearchButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_schemeSearchButtonActionPerformed
        searchButton11aClicked();            // Add your handling code here:
    }//GEN-LAST:event_schemeSearchButtonActionPerformed
    private void searchButton11aClicked() {

        System.out.println("Showing dialog");

        schemeSearchDialog.dispose();
        java.awt.Point point = this.schemeNameTxt.getLocationOnScreen();

        schemeSearchDialog.setSize(700, 200);

        schemeSearchDialog.setLocation(point);
        schemeSearchDialog.setVisible(true);

    }
    private void jSearchTable11MouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jSearchTable11MouseClicked
        memberNameTxt.setText(jSearchTable11.getValueAt(jSearchTable11.getSelectedRow(), 1).toString());
        memberNumberTxt.setText(jSearchTable11.getValueAt(jSearchTable11.getSelectedRow(), 0).toString());
        //   jTextField2.setText(jSearchTable11.getValueAt(jSearchTable11.getSelectedRow(), 2).toString());
        int interval = 0;
        double limit = 0.00;
        double bal = 0.00;
        double rect = 0.00;
        double outstanding = 0.00;
        boolean appLimit = false;
        String memberno = null;
        int occ = 0;
        try {

            java.sql.Statement stmt = connectDB.createStatement();
            java.sql.ResultSet rset = stmt.executeQuery("select payer_name from ac_schemes where scheme_name ='" + schemeNameTxt.getText() + "'");
            while (rset.next()) {
                schemeMangerTxt.setText(rset.getObject(1).toString());
            }
            if (paymentModeCmbx.getSelectedItem().toString().equalsIgnoreCase("Scheme")) {
                java.sql.Statement stmt1cz = connectDB.createStatement();
                java.sql.ResultSet rset1cz = stmt1cz.executeQuery("select applylimit from hp_schemestaff where staff_no  ='" + memberNumberTxt.getText() + "' and applylimit = true AND account_no = '" + schemeAccNoTxt.getText() + "'");
                while (rset1cz.next()) {
                    appLimit = rset1cz.getBoolean(1);
                }
                System.out.println(appLimit);
                if (appLimit) {
                    ageingSeries = new com.afrisoftech.timeseries.YearyAgeing(1, admissionDatePicker.getDate());

                    java.lang.Object[][] rangeDates = ageingSeries.getAgeingDateSeries();

                    // ageingDates = ageingSeries.getAgeingDateSeries();
                    // double columnTotals[] = new double[rangeDates.length];
                    for (int x = 0; x < rangeDates.length; x++) {
                        System.out.println(rangeDates[x]);
                        try {

                            java.text.SimpleDateFormat dateFormat = new java.text.SimpleDateFormat("EEE MMM dd HH:mm:ss zzz yyyy");
                            com.afrisoftech.lib.DateFormatter dateFormatter = new com.afrisoftech.lib.DateFormatter(dateFormat.parse(rangeDates[x][0].toString().trim()), "yyyy");

                            java.lang.String monthString = dateFormatter.getDateString();

                            interval = x;

                        } catch (java.text.ParseException prs) {
                            prs.printStackTrace();
                        }
                    }
                    java.sql.Statement stmt1c = connectDB.createStatement();
                    java.sql.ResultSet rset1c = stmt1c.executeQuery("select iplimit from hp_schemestaff where staff_no  ='" + memberNumberTxt.getText() + "' and applylimit = true");
                    while (rset1c.next()) {
                        limit = rset1c.getDouble(1);
                    }
                    System.out.println(limit);
                    for (int t = 0; t < rangeDates.length; t++) {
                        java.sql.Statement stmt1cxz = connectDB.createStatement();
                        java.sql.ResultSet rset1cxz = stmt1cxz.executeQuery("select count(member_no) from ac_debtors where member_no  ='" + memberNumberTxt.getText() + "' AND date between '" + rangeDates[t][0] + "' AND '" + rangeDates[t][1] + "' AND account_no ilike '" + schemeAccNoTxt.getText() + "'");
                        while (rset1cxz.next()) {
                            occ = rset1cxz.getInt(1);
                        }
                        if (occ > 0) {
                            java.sql.Statement stmt1cx = connectDB.createStatement();
                            System.out.println("Dates between : " + rangeDates[t][0] + " AND " + rangeDates[t][1]);
                            java.sql.ResultSet rset1cx = stmt1cx.executeQuery("select sum(balance) from ac_debtors where member_no  ='" + memberNumberTxt.getText() + "' AND date between '" + rangeDates[t][0] + "' AND '" + rangeDates[t][1] + "' AND account_no ilike '" + schemeAccNoTxt.getText() + "'");
                            while (rset1cx.next()) {
                                bal = rset1cx.getDouble(1);
                                System.out.println(bal);
                            }
                        } else {
                            bal = 0.00;
                        }
                    }
                    outstanding = limit - bal;
                    memberBalanceTxt.setText(java.lang.String.valueOf(outstanding));
                    if (bal >= limit) {
                        javax.swing.JOptionPane.showMessageDialog(this, "The patient has exausted the member limit", "Error Message!", javax.swing.JOptionPane.ERROR_MESSAGE);
                    } else {
                    }
                }
            }

        } catch (java.sql.SQLException sqe) {
            sqe.printStackTrace();
            System.out.println("Insert not successful");
        }

        jSearchDialog11.dispose();        // Add your handling code here:
    }//GEN-LAST:event_jSearchTable11MouseClicked

    private void dispose1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_dispose1ActionPerformed
        this.jSearchDialog11.dispose();

        // Add your handling code here:
    }//GEN-LAST:event_dispose1ActionPerformed

    private void jTextField1112CaretUpdate(javax.swing.event.CaretEvent evt) {//GEN-FIRST:event_jTextField1112CaretUpdate
        if (jTextField1112.getCaretPosition() < 3) {

            System.out.println("Nothing");
        } else {

            jSearchTable11.setModel(com.afrisoftech.dbadmin.TableModel.createTableVectors(connectDB, "select trim(staff_no) as scheme, staff_name as name,sheme_name from scheme_members_view where suspended = 'false' AND staff_name ILIKE '" + jTextField1112.getText().toString() + "%' and sheme_name = '" + schemeNameTxt.getText().toString() + "' ORDER BY staff_name"));

            /*
             * try { searchRowSet11.execute("select trim(staff_no) as scheme,
             * staff_name as name,sheme_name from scheme_members_view where
             * staff_name ILIKE '"+jTextField1112.getText().toString()+"%' and
             * sheme_name = '"+jTextField3611.getText().toString()+"' ORDER BY
             * staff_name");
             *
             * jSearchTable11.setModel(new
             * org.netbeans.lib.sql.models.TableModel(searchRowSet11, new
             * org.netbeans.lib.sql.models.TableModel.Column[] { new
             * org.netbeans.lib.sql.models.TableModel.Column("scheme", "Member
             * Acc.", false), new
             * org.netbeans.lib.sql.models.TableModel.Column("name", "Name",
             * false), new
             * org.netbeans.lib.sql.models.TableModel.Column("sheme_name",
             * "Scheme Name", false)
             *
             * }));
             */
            jSearchTable11.setShowHorizontalLines(false);
            jSearchScrollPane11.setViewportView(jSearchTable11);

        }        // Add your handling code here:
    }//GEN-LAST:event_jTextField1112CaretUpdate

    private void memberNameSearchButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_memberNameSearchButtonActionPerformed
        searchButton11Clicked();        // Add your handling code here:
    }//GEN-LAST:event_memberNameSearchButtonActionPerformed
    private void searchButton11Clicked() {

        System.out.println("Showing dialog");

        jSearchDialog11.dispose();
        java.awt.Point point = this.memberNameTxt.getLocationOnScreen();

        jSearchDialog11.setSize(700, 200);

        jSearchDialog11.setLocation(point);
        jSearchDialog11.setVisible(true);

    }
    private void bedNumberCmbxActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_bedNumberCmbxActionPerformed
        // Add your handling code here:
    }//GEN-LAST:event_bedNumberCmbxActionPerformed
    private void searchButton1Clicked() {

        System.out.println("Showing dialog");

        java.awt.Point point = this.opdNoTxt.getLocationOnScreen();

        opSearchDialog.setSize(700, 200);

        opSearchDialog.setLocation(point);

        opSearchDialog.setVisible(true);

    }
    private void jButton511ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton511ActionPerformed
        opSearchDialog.dispose(); // Add your handling code here:
    }//GEN-LAST:event_jButton511ActionPerformed

    private void opSearchTableMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_opSearchTableMouseClicked
        opdNoTxt.setText(opSearchTable.getValueAt(opSearchTable.getSelectedRow(), 0).toString());

        opSearchDialog.dispose();
        String useonenumber = null;
        try {

            java.sql.Statement stmtx = connectDB.createStatement();
            java.sql.ResultSet rsetx = stmtx.executeQuery("select auto_numbering,use_one_number from pb_patient_names");
            while (rsetx.next()) {
                autonumber = rsetx.getBoolean(1);
                useonenumber = rsetx.getString(2);
            }
            if (useonenumber.equalsIgnoreCase("useonenumber")) {
                admissionNumberTxt.setText(opSearchTable.getValueAt(opSearchTable.getSelectedRow(), 0).toString());
            }
            java.sql.Statement stmt = connectDB.createStatement();
            java.sql.ResultSet rset = stmt.executeQuery("SELECT first_name,second_name,nok,residence,year_of_birth::date,tel_no,address,sex,pat_marital_status,pat_nationality,nok_relationship,education_level,residence_county,pat_religion,home_county,district,nok_residence,occupation, nhif_status,nhif_number,nok_telno,tribe,charge_sheet_no,id_no,patient_race,locations,sub_location,patient_disability FROM hp_patient_register WHERE patient_no ='" + opdNoTxt.getText() + "'");
            while (rset.next()) {
                // jComboBox6.setSelectedItem(rset.getObject(1).toString());
                surNameTxt.setText(dbObject.getDBObject(rset.getObject(1), "-"));
                firstNameTxt.setText(dbObject.getDBObject(rset.getObject(2), "-"));
                // jTextField61.setText(rset.getObject(3).toString());
                nokNameTxt.setText(dbObject.getDBObject(rset.getObject(3), "-"));
                currentResidence.setText(dbObject.getDBObject(rset.getObject(4), "-"));
                nationalityCmbx.setSelectedItem(dbObject.getDBObject(rset.getObject(10), "-"));
                nokRelationShipCmbx.setSelectedItem(dbObject.getDBObject(rset.getObject(11), "-"));
                educationLevelCmbx.setSelectedItem(dbObject.getDBObject(rset.getObject(12), "-"));
                countyofResidenceCmbx.setSelectedItem(dbObject.getDBObject(rset.getObject(13), "-"));
                religionCmbx.setSelectedItem(dbObject.getDBObject(rset.getObject(14), "-"));
                countyofBirthCmbx.setSelectedItem(dbObject.getDBObject(rset.getObject(15), "-"));
                districtCmbx.setSelectedItem(dbObject.getDBObject(rset.getObject(16), "-"));
                nokResidenceTxt.setText(dbObject.getDBObject(rset.getObject(17), "-"));
                occupationCmbx.setSelectedItem(dbObject.getDBObject(rset.getObject(18), "-"));
                nokteltxt.setText(rset.getString("nok_telno"));
                unitNumberTxt.setText(rset.getString("patient_race"));
                idPassportTxt.setText(rset.getString("id_no"));
                locationTxt.setText(rset.getString("locations"));
                districtCmbx.setSelectedItem(rset.getString("sub_location"));
                clinicFileNumberTxt.setText(rset.getString("tribe"));
                if (rset.getBoolean("nhif_status")) {
                    nhifChbx.setSelected(true);
                } else {
                    nhifChbx.setSelected(false);
                }
                nhifCardMemberNumberTxt.setText(rset.getString("nhif_number"));
                cSheetNoTxt.setText(rset.getString("charge_sheet_no"));
                patientDisabilityCmbx.setSelectedItem(rset.getString("patient_disability"));
                java.text.DateFormat df = java.text.DateFormat.getDateInstance();
                java.text.SimpleDateFormat sdf = (java.text.SimpleDateFormat) df;

                sdf.applyPattern("yyyy-MM-dd");
                try {
                    datePickerYOB.setDate(sdf.parse(rset.getString(5)));
                } catch (java.text.ParseException pe) {
                    javax.swing.JOptionPane.showMessageDialog(this, pe.getMessage());
                }
                nokTelephoneTxt.setText(dbObject.getDBObject(rset.getObject(6), "-"));
                postalAddressTxt.setText(dbObject.getDBObject(rset.getObject(7), "-"));
                if (rset.getObject(8).toString().startsWith("M")) {
                    maleChkbx.setSelected(true);

                } else {

                    if (rset.getObject(8).toString().startsWith("F")) {
                        femaleChkbx.setSelected(true);
                    } else {
                    }
                }

                if (rset.getObject(9).toString().equalsIgnoreCase("Single")) {
                    singleMaritalChkbx.setSelected(true);
                } else {
                    if (rset.getObject(9).toString().startsWith("Married")) {
                        marriedMaritalChkbx.setSelected(true);
                    } else {
                        if (rset.getObject(9).toString().startsWith("Divorced")) {
                            divorcedMaritalChkbx.setSelected(true);
                        } else {
                            widowedMaritalChkbx.setSelected(true);
                        }
                    }
                }
            }
        } catch (java.sql.SQLException sqe) {
            sqe.printStackTrace();
            javax.swing.JOptionPane.showMessageDialog(this, sqe.getMessage());
            System.out.println("Insert not successful");
        }
        previousVisitsTable.setModel(com.afrisoftech.dbadmin.TableModel.createTableVectors(connectDB, "SELECT input_date::timestamp(0) as visit_date, clinic as speciality_visited, parameter as registration_point, user_name as registration_officer, marital_status, urgency as case_type FROM hp_patient_visit WHERE patient_no = '" + admissionNumberTxt.getText() + "' UNION SELECT data_capture_time::timestamp(0) as visit_date, ward as speciality_visited, diagnosis3 as registration_point, user_name as registration_officer, marital_status, comments as case_type FROM hp_admission WHERE patient_no = '" + admissionNumberTxt.getText() + "' ORDER BY 1"));

        // jButton301.setEnabled(true);
        opSearchDialog.dispose();   // Add your handling code here:
    }//GEN-LAST:event_opSearchTableMouseClicked

    private void opdSearchButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_opdSearchButtonActionPerformed
        searchButton1Clicked();
        this.admitBtn.setVisible(true);// Add your handling code here:
    }//GEN-LAST:event_opdSearchButtonActionPerformed

    private void opSearchFieldTxtCaretUpdate(javax.swing.event.CaretEvent evt) {//GEN-FIRST:event_opSearchFieldTxtCaretUpdate
        if (opSearchFieldTxt.getCaretPosition() < 5) {

            System.out.println("Nothing");
        } else {
            if (this.searchbyPatientNameChkbx.isSelected()) {
                opSearchTable.setModel(com.afrisoftech.dbadmin.TableModel.createTableVectors(connectDB, "SELECT patient_no, (upper(first_name||' '||second_name||' '||last_name)) as name, year_of_birth::date, residence, patient_race as unit_number from hp_patient_register where (upper(first_name||' '||second_name||' '||last_name)) ILIKE '%" + opSearchFieldTxt.getText().toString() + "%' or patient_race ILIKE '%" + opSearchFieldTxt.getText().toString() + "%'"));
            } else {
                opSearchTable.setModel(com.afrisoftech.dbadmin.TableModel.createTableVectors(connectDB, "SELECT patient_no, (upper(first_name||' '||second_name||' '||last_name)) as name, year_of_birth::date, residence, patient_race as unit_number from hp_patient_register where patient_no ILIKE '%" + opSearchFieldTxt.getText().toString() + "%' or patient_race ILIKE '%" + opSearchFieldTxt.getText().toString() + "%'"));

            }
            /*
             * try {
             *
             * searchRowSet1.execute("SELECT patient_no, (upper(first_name||'
             * '||second_name||' '||last_name)) as name, year_of_birth,
             * residence from hp_patient_register where (upper(first_name||'
             * '||second_name||' '||last_name)) ILIKE
             * '"+jTextField1111.getText().toString()+"%'"); //l
             * searchRowSet.execute(); // searchRowSet.execute("SELECT
             * patient_no, (upper(first_name||' '||second_name||' '||last_name))
             * as name, year_of_birth, residence from hp_patient_register where
             * first_name '~ '~"+jTextField11.getText()+"' order by name");
             *
             * jSearchTable1.setModel(new
             * org.netbeans.lib.sql.models.TableModel(searchRowSet1, new
             * org.netbeans.lib.sql.models.TableModel.Column[] { new
             * org.netbeans.lib.sql.models.TableModel.Column("patient_no",
             * "Patient no", false), new
             * org.netbeans.lib.sql.models.TableModel.Column("name", "Name",
             * false), new
             * org.netbeans.lib.sql.models.TableModel.Column("year_of_birth",
             * "Year of birth", false), new
             * org.netbeans.lib.sql.models.TableModel.Column("residence",
             * "Residence", false) }));
             */
            opSearchTable.setShowHorizontalLines(false);
            opSearchScrollPane1.setViewportView(opSearchTable);

        }

        javax.swing.table.TableColumn column = null;
        for (int i = 0; i < opSearchTable.getColumnCount(); i++) {
            System.out.println("Resizing table ...");
            column = this.opSearchTable.getColumnModel().getColumn(i);
            if (i == 1) {

                column.setPreferredWidth(500); // item description column is bigger
            } else if (i == 0) {
                column.setPreferredWidth(200);
            } else {
                column.setPreferredWidth(100);
            }
        }
        opSearchScrollPane1.setViewportView(opSearchTable);
        // Add your handling code here:
    }//GEN-LAST:event_opSearchFieldTxtCaretUpdate

    private void opSearchFieldTxtActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_opSearchFieldTxtActionPerformed
        // Add your handling code here:
    }//GEN-LAST:event_opSearchFieldTxtActionPerformed

    private void ipSearchTableMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_ipSearchTableMouseClicked
        String name = null;
        String patientNo = null;
        int pNo = 0;

        previousDischargeDateTxt.setText("");
        previousAdmissionDateTxt.setText("");
        previousVisitIDTxt.setText("");
        wardAdmittedTxt.setText("");
        bedoccupiedTxt.setText("");

        admissionNumberTxt.setText(ipSearchTable.getValueAt(ipSearchTable.getSelectedRow(), 0).toString());
        firstNameTxt.setText(ipSearchTable.getValueAt(ipSearchTable.getSelectedRow(), 1).toString());
        surNameTxt.setText(ipSearchTable.getValueAt(ipSearchTable.getSelectedRow(), 2).toString());

        try {

            java.sql.Statement stmt112 = connectDB.createStatement();
            java.sql.ResultSet rset112 = stmt112.executeQuery("select nationality,occupation,pat_religion,pat_district,sub_chief,nok_relationship,home_county,residence_county,education_level,id_no,pat_location,chief_name,speciality,nok_residence,marital_status from hp_admission where patient_no ='" + admissionNumberTxt.getText() + "' ");
            while (rset112.next()) {
                nationalityCmbx.setSelectedItem(dbObject.getDBObject(rset112.getObject(1), "-"));
                occupationCmbx.setSelectedItem(dbObject.getDBObject(rset112.getObject(2), "-"));
                religionCmbx.setSelectedItem(rset112.getObject(3).toString());
                districtCmbx.setSelectedItem(dbObject.getDBObject(rset112.getObject(4), "-"));
                unitNumberTxt.setText(rset112.getObject(5).toString());
                nokRelationShipCmbx.setSelectedItem(rset112.getObject(6));
                countyofBirthCmbx.setSelectedItem(dbObject.getDBObject(rset112.getObject(7), "-"));
                countyofResidenceCmbx.setSelectedItem(rset112.getObject(8));
                educationLevelCmbx.setSelectedItem(rset112.getObject(9));
                if (rset112.getObject(10).toString().equalsIgnoreCase("")) {
                    idPassportTxt.setText("-");
                } else {
                    idPassportTxt.setText(rset112.getString(10));
                }

                if (rset112.getObject(11).toString().equalsIgnoreCase("")) {
                    locationTxt.setText("-");
                } else {
                    locationTxt.setText(rset112.getObject(11).toString());
                }

                if (rset112.getObject(12).toString().equalsIgnoreCase("")) {
                    nameofChiefTxt.setText("-");
                } else {
                    nameofChiefTxt.setText(rset112.getString(12));
                }

                specialtyClinicCmbx.setSelectedItem(rset112.getObject(13));
                nokResidenceTxt.setText(rset112.getString(14));

                if (rset112.getObject(15).toString().startsWith("S")) {
                    singleMaritalChkbx.setSelected(true);

                }
                if (rset112.getObject(15).toString().startsWith("M")) {
                    marriedMaritalChkbx.setSelected(true);
                }
                if (rset112.getObject(15).toString().startsWith("D")) {
                    divorcedMaritalChkbx.setSelected(true);
                }
                if (rset112.getObject(15).toString().startsWith("W")) {
                    widowedMaritalChkbx.setSelected(true);
                }

            }

            java.sql.Statement stmt = connectDB.createStatement();
            java.sql.ResultSet rset = stmt.executeQuery("select nok,residence,year_of_birth::date,address,sex,tel_no,('now'::date-year_of_birth::date)/365,payer,account_no,member_name,description from hp_inpatient_register where patient_no ='" + admissionNumberTxt.getText() + "'");
            while (rset.next()) {
                nokNameTxt.setText(rset.getObject(1).toString());
                currentResidence.setText(rset.getObject(2).toString());
                java.text.DateFormat df = java.text.DateFormat.getDateInstance();
                java.text.SimpleDateFormat sdf = (java.text.SimpleDateFormat) df;
                ageTxt.setText(rset.getObject(7).toString());
                sdf.applyPattern("yyyy-MM-dd");
                try {
                    datePickerYOB.setDate(sdf.parse(rset.getString(3)));
                } catch (java.text.ParseException pe) {
                    javax.swing.JOptionPane.showMessageDialog(this, pe.getMessage());
                }
                postalAddressTxt.setText(rset.getObject(4).toString());
                nokTelephoneTxt.setText(rset.getObject(6).toString());
                if (rset.getObject(5).toString().startsWith("M")) {
                    maleChkbx.setSelected(true);
                } else {
                    femaleChkbx.setSelected(true);
                }
                schemeNameTxt.setText(rset.getString(8));
                memberNumberTxt.setText(rset.getString(9));
                memberNameTxt.setText(rset.getString(10));
                schemeMangerTxt.setText(rset.getString(11));
            }

            java.sql.Statement stmt11 = connectDB.createStatement();
            java.sql.ResultSet rset11 = stmt11.executeQuery("select patient_no from hp_admission where patient_no ='" + admissionNumberTxt.getText() + "' and discharge = false");
            while (rset11.next()) {
                name = rset11.getObject(1).toString();
            }
            boolean checkOut = false;
            java.sql.Statement stmt1111xx = connectDB.createStatement();
            java.sql.ResultSet rset1111x = stmt1111xx.executeQuery("select check_out from hp_admission where patient_no ='" + admissionNumberTxt.getText() + "' order by date_admitted DESC LIMIT 1");
            while (rset1111x.next()) {
                checkOut = rset1111x.getBoolean(1);
            }

            if (!editReprintBtn.isSelected()) {
                if (admissionNumberTxt.getText().equalsIgnoreCase(name)) {
                    javax.swing.JOptionPane.showMessageDialog(this, " Patient already admitted ", "Error", javax.swing.JOptionPane.ERROR_MESSAGE);

                    admissionNumberTxt.setText("");
                    surNameTxt.setText("");
                }
            }

            java.sql.Statement stmtf = connectDB.createStatement();
            java.sql.ResultSet rsetf = stmtf.executeQuery("select patient_no from hp_inpatient_register where patient_no ='" + this.admissionNumberTxt.getText() + "'");
            while (rsetf.next()) {
                patientNo = rsetf.getObject(1).toString();
            }

            java.sql.Statement stmt11f = connectDB.createStatement();

            java.sql.ResultSet rset11f = stmt11f.executeQuery("select patient_no,check_out from hp_admission where patient_no ='" + admissionNumberTxt.getText() + "' and check_out = false");
            while (rset11f.next()) {
                // jComboBox1.setSelectedItem(rset11.getObject(1).toString());
                //  name = rset11f.getObject(1).toString();
                if (rset11f.getBoolean(2) == false) {
                    hasInterimBillChkbx.setSelected(true);
                } else {
                    hasInterimBillChkbx.setSelected(false);
                }
            }

            java.sql.Statement stmt111 = connectDB.createStatement();
            java.sql.ResultSet rset111 = stmt111.executeQuery("select count (patient_no) from hp_admission where patient_no ='" + admissionNumberTxt.getText() + "'");
            while (rset111.next()) {
                // jComboBox1.setSelectedItem(rset11.getObject(1).toString());
                pNo = rset111.getInt(1);
            }
            if (pNo > 0) {

                java.sql.Statement stmt1111 = connectDB.createStatement();
                java.sql.ResultSet rset1111 = stmt1111.executeQuery("select date_admitted::date,discharge_date::date,CASE WHEN (visit_id IS NULL) THEN '-' ELSE visit_id END AS visit_id,ward,bed_no from hp_admission where patient_no ='" + admissionNumberTxt.getText() + "' order by date_admitted DESC LIMIT 1");
                while (rset1111.next()) {
                    previousDischargeDateTxt.setText(rset1111.getString(2));
                    previousAdmissionDateTxt.setText(rset1111.getString(1));
                    previousVisitIDTxt.setText(rset1111.getString(3));
                    wardAdmittedTxt.setText(rset1111.getString(4));
                    bedoccupiedTxt.setText(rset1111.getString(5));
                }
            }

        } catch (java.sql.SQLException sqe) {
            sqe.printStackTrace();
            System.out.println("Select not successful");
            javax.swing.JOptionPane.showMessageDialog(this, sqe.getMessage());
        }

        previousVisitsTable.setModel(com.afrisoftech.dbadmin.TableModel.createTableVectors(connectDB, "SELECT input_date::timestamp(0) as visit_date, clinic as speciality_visited, parameter as registration_point, user_name as registration_officer, marital_status, urgency as case_type FROM hp_patient_visit WHERE patient_no = '" + admissionNumberTxt.getText() + "' UNION SELECT data_capture_time::timestamp(0) as visit_date, ward as speciality_visited, diagnosis3 as registration_point, user_name as registration_officer, marital_status, comments as case_type FROM hp_admission WHERE patient_no = '" + admissionNumberTxt.getText() + "'"));

        // Flagging patients whole accounts have outstanding bills
        javax.swing.JOptionPane.showMessageDialog(this, "Patient Number [" + admissionNumberTxt.getText() + "] outstanding bill status total : [" + com.afrisoftech.lib.CurrencyFormatter.getFormattedDouble(com.afrisoftech.lib.PatientAccountStatus.getOutstandillBill(connectDB, patientNo) + com.afrisoftech.lib.PatientAccountStatus.getPersonalDebtStatus(connectDB, patientNo)) + "], Abscondment status bill : [" + com.afrisoftech.lib.PatientAccountStatus.getAbscondmentStatus(connectDB, patientNo) + "]");

        ipSearchDialog.dispose();        // Add your handling code here:
    }//GEN-LAST:event_ipSearchTableMouseClicked

    private void jButton51ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton51ActionPerformed
        ipSearchDialog.dispose();  // Add your handling code here:
    }//GEN-LAST:event_jButton51ActionPerformed

    private void ipSearchTxtCaretUpdate(javax.swing.event.CaretEvent evt) {//GEN-FIRST:event_ipSearchTxtCaretUpdate
        if (ipSearchTxt.getCaretPosition() < 5) {

            System.out.println("Nothing");
        } else {
            if (this.searchbyPatientNameChkbx.isSelected()) {
                ipSearchTable.setModel(com.afrisoftech.dbadmin.TableModel.createTableVectors(connectDB, "SELECT hd.patient_no, (upper(hd.second_name||' '||hd.last_name)) as name, hd.first_name AS surname, (SELECT hp.sub_chief FROM hp_admission hp WHERE hp.patient_no = hd.patient_no order by 1 LIMIT 1) as unit_number, hd.tel_no as telephone_no, (SELECT hp.id_no FROM hp_admission hp WHERE hp.patient_no = hd.patient_no order by 1 LIMIT 1) as id_no, hd.nok as next_of_kin from hp_inpatient_register hd where (upper(hd.second_name||' '||hd.first_name||' '||hd.last_name)) ILIKE '%" + ipSearchTxt.getText().toString() + "%' ORDER BY second_name"));
                ipSearchTable.setShowHorizontalLines(false);
                ipSearchScrollPane.setViewportView(ipSearchTable);

            } else {
                if (this.searchbyPatientNumberChkbx.isSelected()) {
//                    ipSearchTable.setModel(com.afrisoftech.dbadmin.TableModel.createTableVectors(connectDB, "SELECT hd.patient_no, (upper(hd.second_name||' '||hd.last_name)) as name, hd.first_name AS surname, (SELECT hp.sub_chief FROM hp_admission hp WHERE hp.patient_no = hd.patient_no order by 1 LIMIT 1) as unit_number, hd.tel_no as telephone_no, (SELECT hp.id_no FROM hp_admission hp WHERE hp.patient_no = hd.patient_no order by 1 LIMIT 1) as id_no, hd.nok as next_of_kin from hp_inpatient_register hd where hd.patient_no ILIKE '%" + ipSearchTxt.getText().toString() + "%' or (SELECT hp.sub_chief FROM hp_admission hp WHERE hp.patient_no = hd.patient_no order by 1 LIMIT 1) ilike '%" + ipSearchTxt.getText().toString() + "%' ORDER BY second_name"));
                    ipSearchTable.setModel(com.afrisoftech.dbadmin.TableModel.createTableVectors(connectDB, "SELECT hd.patient_no, (upper(hd.second_name||' '||hd.last_name)) as name,hd.first_name AS surname, (SELECT hp.sub_chief FROM hp_admission hp WHERE hp.patient_no = hd.patient_no order by 1 LIMIT 1) as unit_number, hd.tel_no as telephone_no, (SELECT hp.id_no FROM hp_admission hp WHERE hp.patient_no = hd.patient_no order by 1 LIMIT 1) as id_no, hd.nok as next_of_kin from hp_inpatient_register hd where hd.patient_no ILIKE '%" + ipSearchTxt.getText().toString() + "%' or (SELECT hp.sub_chief FROM hp_admission hp WHERE hp.patient_no = hd.patient_no order by 1 LIMIT 1) ilike '%" + ipSearchTxt.getText().toString() + "%'  or hd.nok ilike '%" + ipSearchTxt.getText().toString() + "%'  or (SELECT hp.id_no FROM hp_admission hp WHERE hp.patient_no = hd.patient_no order by 1 LIMIT 1) ilike '%" + ipSearchTxt.getText().toString() + "%'  or hd.tel_no ilike '%" + ipSearchTxt.getText().toString() + "%' ORDER BY second_name"));
                    ipSearchTable.setShowHorizontalLines(false);
                    ipSearchScrollPane.setViewportView(ipSearchTable);

                }
            }
        }
        javax.swing.table.TableColumn column = null;
        for (int i = 0; i < ipSearchTable.getColumnCount(); i++) {
            System.out.println("Resizing table ...");
            column = this.ipSearchTable.getColumnModel().getColumn(i);
            if (i == 1) {

                column.setPreferredWidth(500); // item description column is bigger
            } else if (i == 2) {

                column.setPreferredWidth(300);

            } else {
                column.setPreferredWidth(100);
            }
        }
        ipSearchScrollPane.setViewportView(ipSearchTable);
        // Add your handling code here:
    }//GEN-LAST:event_ipSearchTxtCaretUpdate

    private void searchButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_searchButtonActionPerformed
        this.admitBtn.setVisible(true);
        searchButtonClicked(); // Add your handling code here:
    }//GEN-LAST:event_searchButtonActionPerformed
    private void searchButtonClicked() {

        System.out.println("Showing dialog");

        java.awt.Point point = this.admissionNumberTxt.getLocationOnScreen();

        ipSearchDialog.setSize(700, 200);

        ipSearchDialog.setLocation(point);

        ipSearchDialog.setVisible(true);

    }
    private void jButton2021ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton2021ActionPerformed
        //this.revalidate();
        jTextField161.setText("");
        jTextField58211.setText("");

        jTextField31.setText("");
        //jTextField61.setText("");
        jTextField151.setText("");
        jTextField41.setText("");
        jTextField141.setText("");
        jTextField51.setText("");
        //  this.jComboBox21.setToolTipText(null);
        // Add your handling code here:
    }//GEN-LAST:event_jButton2021ActionPerformed

    private void jComboBox8ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jComboBox8ActionPerformed
        // Add your handling code here:
    }//GEN-LAST:event_jComboBox8ActionPerformed

    private void jComboBox7ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jComboBox7ActionPerformed
        // Add your handling code here:
    }//GEN-LAST:event_jComboBox7ActionPerformed

    private void cardNameCmbxActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cardNameCmbxActionPerformed
        try {

            java.sql.Statement stmt = connectDB.createStatement();
            java.sql.ResultSet rset = stmt.executeQuery("select insurer from pb_creditcard_types where card_name ='" + cardNameCmbx.getSelectedItem() + "'");
            while (rset.next()) {
                cardIssurerTxt.setText(rset.getObject(1).toString());

            }
        } catch (java.sql.SQLException sqe) {
            sqe.printStackTrace();
            System.out.println("Insert not successful");
            javax.swing.JOptionPane.showMessageDialog(this, sqe.getMessage());
        }        // Add your handling code here:
    }//GEN-LAST:event_cardNameCmbxActionPerformed

    private void paymentModeCmbxActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_paymentModeCmbxActionPerformed
        if (paymentModeCmbx.getSelectedItem().equals("Credit Card")) {
            schemePanel.setVisible(false);
            bankCardsPanel.setVisible(true);
        } else {
            if (paymentModeCmbx.getSelectedItem().equals("Scheme")) {
                bankCardsPanel.setVisible(false);
                schemePanel.setVisible(true);
            } else {
                bankCardsPanel.setVisible(false);
                schemePanel.setVisible(false);
            }
        }

        // jButton301.setEnabled(true);        // Add your handling code here:
    }//GEN-LAST:event_paymentModeCmbxActionPerformed

    private void jButton2521ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton2521ActionPerformed
        jDialog2.dispose();        // Add your handling code here:
    }//GEN-LAST:event_jButton2521ActionPerformed

    private void jButton3011ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton3011ActionPerformed

        java.util.Calendar calendar = java.util.Calendar.getInstance();

        long dateNow = calendar.getTimeInMillis();

        java.sql.Date datenowSql1 = new java.sql.Date(dateNow);

        System.out.println(datenowSql1.toString());

        java.sql.Timestamp datenowSql = new java.sql.Timestamp(dateNow);

        System.out.println(datenowSql.toString());

        try {

            String selectedchkbx = null;

            if (this.jCheckBox21.isSelected()) {
                selectedchkbx = jCheckBox21.getText();
            } else {
                selectedchkbx = jCheckBox11.getText();
            }
            String patientNo = null;

            try {
                java.sql.Statement stmt = connectDB.createStatement();
                java.sql.ResultSet rset = stmt.executeQuery("select patient_no from hp_inpatient_register where patient_no ='" + this.jTextField21.getText() + "'");
                while (rset.next()) {
                    patientNo = rset.getObject(1).toString();
                }
            } catch (java.sql.SQLException sqlExec) {

                javax.swing.JOptionPane.showMessageDialog(this, sqlExec.getMessage());

            }

            if (this.jTextField21.getText().equalsIgnoreCase(patientNo)) {
                jLabel33.setForeground(java.awt.Color.red);
                jLabel33.setText("PATIENT No. Already On File");

                // javax.swing.JOptionPane.showMessageDialog(this,"PATIENT No. Already Exists", "Error",javax.swing.JOptionPane.ERROR_MESSAGE);
            } else {

                try {
                    connectDB.setAutoCommit(false);
                    java.sql.PreparedStatement pstmt = connectDB.prepareStatement("insert into hp_inpatient_register(patient_no, first_name, second_name, last_name, nok, residence, address, year_of_birth, tel_no, sex,op_no) values(?, initcap(?), initcap(?), ?, ?, ?, ?, ?, ?, ?,?)");
                    if (jTextField21.getText().equals("")) {
                        javax.swing.JOptionPane.showMessageDialog(this, "You must enter Member No.", "Error", javax.swing.JOptionPane.ERROR_MESSAGE);
                    } else {
                        pstmt.setString(1, jTextField21.getText());
                    }

                    //pstmt.setString(1,jTextField21.getText());
                    if (jTextField161.getText().equals("")) {
                        javax.swing.JOptionPane.showMessageDialog(this, "You must enter First Name and Second Name", "Error", javax.swing.JOptionPane.ERROR_MESSAGE);
                    } else {
                        pstmt.setString(2, jTextField161.getText());
                    }
                    pstmt.setString(3, jTextField31.getText());
                    pstmt.setString(4, "");
                    pstmt.setString(5, jTextField151.getText());
                    pstmt.setString(6, jTextField41.getText());
                    pstmt.setString(7, jTextField51.getText());
                    if (jTextField141.getText().equals("")) {
                        javax.swing.JOptionPane.showMessageDialog(this, "You must enter residence", "Error", javax.swing.JOptionPane.ERROR_MESSAGE);
                    } else {
                        pstmt.setString(8, jTextField141.getText());
                    }

                    pstmt.setString(9, jTextField58211.getText());
                    if (selectedchkbx == null) {
                        javax.swing.JOptionPane.showMessageDialog(this, "You must tick patient sex", "Error", javax.swing.JOptionPane.ERROR_MESSAGE);
                    } else {
                        pstmt.setObject(10, selectedchkbx);
                    }
                    pstmt.setString(11, opdNoTxt.getText());

                    pstmt.executeUpdate();
                    connectDB.commit();
                    connectDB.setAutoCommit(true);
                    //                    this.jTextField22.setText(jTextField361.getText());
                    this.surNameTxt.setText(jTextField161.getText() + " " + jTextField31.getText());
                    admissionNumberTxt.setText(jTextField21.getText());
                    nokNameTxt.setText(jTextField151.getText());
                    jDialog2.dispose();
                } catch (java.lang.Exception sq) {

                    try {
                        connectDB.rollback();
                    } catch (java.sql.SQLException sql) {
                        javax.swing.JOptionPane.showMessageDialog(this, sql.getMessage(), "Error Message!", javax.swing.JOptionPane.ERROR_MESSAGE);
                    }
                    System.out.println(sq.getMessage());
                    javax.swing.JOptionPane.showMessageDialog(this, sq.getMessage(), "Error", javax.swing.JOptionPane.ERROR_MESSAGE);
                }
            }

        } catch (java.lang.Exception ex) {
            System.out.println(ex.getMessage());
            javax.swing.JOptionPane.showMessageDialog(this, "TRANSACTION ERROR : Please double check your entries.", "Error", javax.swing.JOptionPane.ERROR_MESSAGE);

        }
        // Add your handling code here:
    }//GEN-LAST:event_jButton3011ActionPerformed

    private void admissionWardCmbxActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_admissionWardCmbxActionPerformed
        this.admitBtn.setVisible(true);
        try {

            java.sql.Statement stmt = connectDB.createStatement();
            java.sql.ResultSet rset = stmt.executeQuery("select ward_code from hp_wards where ward_name ='" + admissionWardCmbx.getSelectedItem() + "'");
            while (rset.next()) {
                wardCodeTxt.setText(rset.getObject(1).toString());
                // jTextField11.setText(rset.getObject(2).toString());
            }
        } catch (java.sql.SQLException sqe) {
            sqe.printStackTrace();
            System.out.println("Select not successful");
        }

        // crset4.setCommand("select bed_no from hp_bed_setup where ward ='"+jComboBox2.getSelectedItem()+"' and occupied = 'f' and available = 'Available' order by bed_no asc");
        // try {
        // crset4.execute();
        if (admitBtn.getText().equalsIgnoreCase("Update")) {
            bedNumberCmbx.setModel(com.afrisoftech.lib.ComboBoxModel.ComboBoxModel(connectDB, "SELECT '" + bedoccupiedTxt.getText() + "' as bed_no UNION ALL select bed_no from hp_bed_setup where ward ='" + admissionWardCmbx.getSelectedItem() + "' and occupied = false and available = 'Available' order by bed_no asc"));

        } else {
            bedNumberCmbx.setModel(com.afrisoftech.lib.ComboBoxModel.ComboBoxModel(connectDB, "SELECT '-' as bed_no UNION ALL select bed_no from hp_bed_setup where ward ='" + admissionWardCmbx.getSelectedItem() + "' and occupied = false and available = 'Available' order by bed_no asc"));
            // jComboBox4.setModel(new org.netbeans.lib.sql.models.ComboBoxModel(crset4, "bed_no", null, null, null));
            //}catch (java.sql.SQLException sql){}
        }
        // Add your handling code here:
    }//GEN-LAST:event_admissionWardCmbxActionPerformed

    private void jButton4ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton4ActionPerformed
        setVisible(false);   // Add your handling code here:
    }//GEN-LAST:event_jButton4ActionPerformed

    private void jButton3ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton3ActionPerformed

//        referredFromTxt.setText("");
        postalAddressTxt.setText("");
        nokTelephoneTxt.setText("");
        nokNameTxt.setText("");
        wardCodeTxt.setText("");
        surNameTxt.setText("");
//        referredFromTxt.setText("");
        currentResidence.setText("");
        billPayerTxt.setText("");
        schemeNameTxt.setText("");
        schemeMangerTxt.setText("");
        memberNameTxt.setText("");
        nhifClaimNumberTxt.setText("");
        cSheetNoTxt.setText("");
        countyofResidenceCmbx.setSelectedItem(null);
        countyofBirthCmbx.setSelectedItem(null);
        educationLevelCmbx.setSelectedItem(null);
        clinicFileNumberTxt.setText("");
        employerTxt.setText("");
        employerTelTxt.setText("");
        this.admitBtn.setEnabled(false);
        this.admitPrintBtn.setEnabled(false);

        referredcombo.setSelectedItem("-");
        postalAddressTxt.setText("");
        nokTelephoneTxt.setText("");
        nokNameTxt.setText("");
        // jTextField6.setText("");
        wardCodeTxt.setText("");
        surNameTxt.setText("");
//        referredFromTxt.setText("");
        //        jTextField12.setText("");
        currentResidence.setText("");
        billPayerTxt.setText("");
        schemeNameTxt.setText("");
        schemeMangerTxt.setText("");
        memberNameTxt.setText("");
        // jTextField4.setText("");
        // Add your handling code here:
    }//GEN-LAST:event_jButton3ActionPerformed

    private void jButton2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton2ActionPerformed

        if (admissionNumberTxt.getText().length() > 3) {
            admitPrintBtn.setText("Update File");
            referredcombo.setSelectedItem("-");
            postalAddressTxt.setText("");
            nokTelephoneTxt.setText("");
            nokNameTxt.setText("");
            firstNameTxt.setText("");
            wardCodeTxt.setText("");
            surNameTxt.setText("");
//        jTextField6.setText("");
            // jTextField12.setText("");
            memberNumberTxt.setText("");
            currentResidence.setText("");
            billPayerTxt.setText("");
            bedRateTxt.setText("");
            schemeNameTxt.setText("");
            schemeMangerTxt.setText("");
            memberNameTxt.setText("");
            opdSearchButton.setEnabled(false);
            searchButton.setEnabled(true);
//        searchbyPatientNameChkbx.setEnabled(true);
//        searchbyPatientNumberChkbx.setEnabled(true);
            dischargedChkbx.setEnabled(true);
            admittedChbx.setEnabled(true);
//            referredFromTxt.setEditable(true);
            postalAddressTxt.setEditable(true);
            nokTelephoneTxt.setEditable(true);
            nokNameTxt.setEditable(true);
            firstNameTxt.setEditable(true);
            surNameTxt.setEditable(true);
//        jTextField6.setEditable(true);
            admissionNumberTxt.setEditable(false);
            memberNumberTxt.setEditable(true);
            currentResidence.setEditable(true);
            billPayerTxt.setEditable(true);
            schemeNameTxt.setEditable(true);
            opdNoTxt.setEditable(false);
            schemeMangerTxt.setEditable(true);
            memberNameTxt.setEditable(true);

            try {
                java.sql.Statement stmt = connectDB.createStatement();
                java.sql.ResultSet rset = stmt.executeQuery("select nok,residence,year_of_birth::date,address,sex,tel_no,first_name,second_name from hp_inpatient_register where patient_no  ilike '" + admissionNumberTxt.getText() + "%'");
                while (rset.next()) {
                    //  jTextField2.setText(rset.getObject(1).toString());
                    nokNameTxt.setText(rset.getObject(1).toString());
                    currentResidence.setText(rset.getObject(2).toString());
                    java.text.DateFormat df = java.text.DateFormat.getDateInstance();
                    java.text.SimpleDateFormat sdf = (java.text.SimpleDateFormat) df;

                    sdf.applyPattern("yyyy-MM-dd");
                    try {
                        datePickerYOB.setDate(sdf.parse(rset.getString(3)));
                    } catch (java.text.ParseException pe) {
                        javax.swing.JOptionPane.showMessageDialog(this, pe.getMessage());
                    }
                    postalAddressTxt.setText(rset.getObject(4).toString());
                    nokTelephoneTxt.setText(rset.getObject(6).toString());
                    if (rset.getObject(5).toString().startsWith("M")) {
                        maleChkbx.setSelected(true);
                    } else {
                        femaleChkbx.setSelected(true);
                    }

                    surNameTxt.setText(rset.getObject(7).toString());
                    firstNameTxt.setText(rset.getObject(8).toString());

                }
                java.sql.Statement stmt11 = connectDB.createStatement();
                java.sql.ResultSet rset11 = stmt11.executeQuery("select visit_id,date_admitted,ward,bed_no,CASE WHEN (discharge = false) THEN '-' ELSE discharge_date END AS discharge_date,discharge,admission_reason,deposit from hp_admission where patient_no  ilike '" + admissionNumberTxt.getText() + "%' ORDER BY visit_id DESC");
                while (rset11.next()) {
                    //  jTextField2.setText(rset.getObject(1).toString());
                    previousVisitIDTxt.setText(rset11.getObject(1).toString());
                    previousAdmissionDateTxt.setText(rset11.getObject(2).toString());
                    wardAdmittedTxt.setText(rset11.getObject(3).toString());
                    bedoccupiedTxt.setText(rset11.getObject(4).toString());
                    previousDischargeDateTxt.setText(rset11.getObject(5).toString());
                    bedRateTxt.setText(rset11.getObject(8).toString());
                    diagnosisTextPane.setText(rset11.getObject(7).toString());
                    if (rset11.getBoolean(6) == true) {
                        dischargedChkbx.setSelected(true);
                    } else {
                        admittedChbx.setSelected(true);
                    }
                }
            } catch (java.sql.SQLException sq) {
                sq.printStackTrace();
                try {
                    connectDB.rollback();
                } catch (java.sql.SQLException sql) {
                    javax.swing.JOptionPane.showMessageDialog(this, sql.getMessage(), "Error Message!", javax.swing.JOptionPane.ERROR_MESSAGE);
                }
                System.out.println(sq.getMessage());
                javax.swing.JOptionPane.showMessageDialog(this, sq.getMessage(), "Error", javax.swing.JOptionPane.ERROR_MESSAGE);

            }
        } else {
            javax.swing.JOptionPane.showMessageDialog(this, "Retrieve the file first to allow editing.", "Error Message!", javax.swing.JOptionPane.ERROR_MESSAGE);

        }

    }//GEN-LAST:event_jButton2ActionPerformed

    private void admitBtnActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_admitBtnActionPerformed
        if (unitNumberTxt.getText().length() > 1) {
            if (surNameTxt.getText().length() > 1) {
                if (firstNameTxt.getText().length() > 1) {
                    if (currentResidence.getText().length() > 1) {
                        if (admissionWardCmbx.getSelectedItem() != null) {
                            if (bedCategoryCmbx.getSelectedItem() != null) {
                                if (specialtyClinicCmbx.getSelectedItem() != null) {
                                    if (paymentModeCmbx.getSelectedItem() != null) {
                                        if (bedNumberCmbx.getSelectedItem() != null) {
                                            if (bedRateTxt.getText().length() > 0) {
                                                if (nokNameTxt.getText().length() > 1) {
                                                    //  if (nhifChbx.isSelected() && nhifCardMemberNumberTxt.getText().length() > 1) {
                                                    if (nokRelationShipCmbx.getSelectedItem() != null) {
                                                        if (nokTelephoneTxt.getText().length() > 6) {
                                                            admitPatient();
                                                            jButton3.doClick();
                                                        } else {
                                                            javax.swing.JOptionPane.showMessageDialog(this, "TRANSACTION ERROR : Please double check your entries. \n DETAILS : NOK Telephone Number is mandatory", "Error", javax.swing.JOptionPane.ERROR_MESSAGE);

                                                        }
                                                    } else {
                                                        javax.swing.JOptionPane.showMessageDialog(this, "TRANSACTION ERROR : Please double check your entries. \n DETAILS : NOK Relationship is mandatory", "Error", javax.swing.JOptionPane.ERROR_MESSAGE);

                                                    }
                                                    //  } else {
                                                    //      javax.swing.JOptionPane.showMessageDialog(this, "TRANSACTION ERROR : Please double check your entries. \n DETAILS : You MUST provide a card number for NHIF beneficiary", "Error", javax.swing.JOptionPane.ERROR_MESSAGE);

                                                    //  }
                                                } else {
                                                    javax.swing.JOptionPane.showMessageDialog(this, "TRANSACTION ERROR : Please double check your entries. \n DETAILS : Next of Kin name is manadatory", "Error", javax.swing.JOptionPane.ERROR_MESSAGE);

                                                }
                                            } else {
                                                javax.swing.JOptionPane.showMessageDialog(this, "TRANSACTION ERROR : Please double check your entries. \n DETAILS : Bed Rate is manadatory, You MUST set rate through setting the \"Bed Category\"", "Error", javax.swing.JOptionPane.ERROR_MESSAGE);

                                            }
                                        } else {
                                            javax.swing.JOptionPane.showMessageDialog(this, "TRANSACTION ERROR : Please double check your entries. \n DETAILS : Bed Number is manadatory", "Error", javax.swing.JOptionPane.ERROR_MESSAGE);

                                        }
                                    } else {
                                        javax.swing.JOptionPane.showMessageDialog(this, "TRANSACTION ERROR : Please double check your entries. \n DETAILS : Payment Mode is manadatory", "Error", javax.swing.JOptionPane.ERROR_MESSAGE);

                                    }
                                } else {
                                    javax.swing.JOptionPane.showMessageDialog(this, "TRANSACTION ERROR : Please double check your entries. \n DETAILS : Specialty Clinic is manadatory", "Error", javax.swing.JOptionPane.ERROR_MESSAGE);

                                }
                            } else {
                                javax.swing.JOptionPane.showMessageDialog(this, "TRANSACTION ERROR : Please double check your entries. \n DETAILS : Bed category is manadatory", "Error", javax.swing.JOptionPane.ERROR_MESSAGE);

                            }
                        } else {
                            javax.swing.JOptionPane.showMessageDialog(this, "TRANSACTION ERROR : Please double check your entries. \n DETAILS :  Admission ward is manadatory", "Error", javax.swing.JOptionPane.ERROR_MESSAGE);

                        }
                    } else {
                        javax.swing.JOptionPane.showMessageDialog(this, "TRANSACTION ERROR : Please double check your entries. \n DETAILS : Current residence is manadatory", "Error", javax.swing.JOptionPane.ERROR_MESSAGE);

                    }
                } else {
                    javax.swing.JOptionPane.showMessageDialog(this, "TRANSACTION ERROR : Please double check your entries. \n DETAILS : First name is manadatory", "Error", javax.swing.JOptionPane.ERROR_MESSAGE);

                }
            } else {
                javax.swing.JOptionPane.showMessageDialog(this, "TRANSACTION ERROR : Please double check your entries. \n DETAILS :  Surname is manadatory", "Error", javax.swing.JOptionPane.ERROR_MESSAGE);

            }
        } else {
            javax.swing.JOptionPane.showMessageDialog(this, "TRANSACTION ERROR : Please double check your entries. \n DETAILS :  Unit Number is manadatory", "Error", javax.swing.JOptionPane.ERROR_MESSAGE);

        }

// Add your handling code here:
    }//GEN-LAST:event_admitBtnActionPerformed

private void ageTxtCaretUpdate(javax.swing.event.CaretEvent evt) {//GEN-FIRST:event_ageTxtCaretUpdate
//    if (ageTxt.getText().equalsIgnoreCase("")) {
//    } else {
//        float ages = java.lang.Float.valueOf(ageTxt.getText());
//        int ageYrs = java.lang.Math.round(ages);
//        try {
//            java.sql.Statement stmnza = connectDB.createStatement();
//            java.sql.ResultSet rsnza = stmnza.executeQuery("select (CURRENT_DATE::DATE - ('" + ageYrs + "'*365))");
//            while (rsnza.next()) {
//                java.text.DateFormat df = java.text.DateFormat.getDateInstance();
//                java.text.SimpleDateFormat sdf = (java.text.SimpleDateFormat) df;
//
//                sdf.applyPattern("yyyy-MM-dd");
//                try {
//                    this.datePickerYOB.setDate(sdf.parse(rsnza.getString(1)));
//
//                } catch (java.text.ParseException pe) {
//                    javax.swing.JOptionPane.showMessageDialog(this, pe.getMessage());
//                }
//            }
//        } catch (java.sql.SQLException sq) {
//
//            sq.printStackTrace();
//            System.out.println(sq.getMessage());
//            javax.swing.JOptionPane.showMessageDialog(this, sq.getMessage(), "Error", javax.swing.JOptionPane.ERROR_MESSAGE);
//
//        }
//    }
// TODO add your handling code here:
}//GEN-LAST:event_ageTxtCaretUpdate

private void createManualNumbersRbtnActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_createManualNumbersRbtnActionPerformed
    newAdimissionRbtnActionPerformed(evt);
    admissionNumberTxt.setEditable(true);
    this.admitBtn.setEnabled(true);
    this.admitPrintBtn.setEnabled(true);
// TODO add your handling code here:
}//GEN-LAST:event_createManualNumbersRbtnActionPerformed

private void singleMaritalChkbxActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_singleMaritalChkbxActionPerformed
    // TODO add your handling code here:
}//GEN-LAST:event_singleMaritalChkbxActionPerformed

private void surNameTxtCaretUpdate(javax.swing.event.CaretEvent evt) {//GEN-FIRST:event_surNameTxtCaretUpdate

//    searchbyPatientNameChkbx.setSelected(true);
    System.out.println("Showing dialog");

    java.awt.Point point = this.surNameTxt.getLocationOnScreen();

    point.setLocation(surNameTxt.getLocationOnScreen().x, surNameTxt.getLocationOnScreen().y + 20);

    jSearchDialog4.setSize(700, 200);

    jSearchDialog4.setLocation(point);

    jSearchDialog4.setVisible(true);

    if (surNameTxt.getCaretPosition() > 3) {

        jSearchTable4.setModel(com.afrisoftech.dbadmin.TableModel.createTableVectors(connectDB, "SELECT patient_no, upper(second_name) as other_names, upper(first_name) as surname, year_of_birth, residence from hp_inpatient_register where second_name||' '||first_name ILIKE '%" + surNameTxt.getText() + "%' order by second_name"));

    }

//    surNameTxt.requestFocusInWindow();
    // TODO add your handling code here:
}//GEN-LAST:event_surNameTxtCaretUpdate

private void firstNameTxtCaretUpdate(javax.swing.event.CaretEvent evt) {//GEN-FIRST:event_firstNameTxtCaretUpdate

//    searchbyPatientNameChkbx.setSelected(true);
    System.out.println("Showing dialog");

    java.awt.Point point = this.firstNameTxt.getLocationOnScreen();

    point.setLocation(firstNameTxt.getLocationOnScreen().x, firstNameTxt.getLocationOnScreen().y + 20);

    jSearchDialog4.setSize(700, 200);

    jSearchDialog4.setLocation(point);

    jSearchDialog4.setVisible(true);

    if (firstNameTxt.getCaretPosition() > 3) {

        jSearchTable4.setModel(com.afrisoftech.dbadmin.TableModel.createTableVectors(connectDB, "SELECT patient_no, upper(second_name) as other_names, upper(first_name) as surname, year_of_birth, residence from hp_inpatient_register where second_name||' '||first_name ILIKE '%" + firstNameTxt.getText() + "%' order by second_name"));

    }

//    firstNameTxt.requestFocusInWindow();
    // TODO add your handling code here:
}//GEN-LAST:event_firstNameTxtCaretUpdate

    private void datePickerYOBInputMethodTextChanged(java.awt.event.InputMethodEvent evt) {//GEN-FIRST:event_datePickerYOBInputMethodTextChanged
        /*
         * try { java.sql.PreparedStatement pstmt =
         * connectDB.prepareStatement("SELECT ");
         *
         * // TODO add your handling code here: } catch (SQLException ex) {
         * Logger.getLogger(AdmissionIntfr.class.getName()).log(Level.SEVERE,
         * null, ex); }
         *
         */
    }//GEN-LAST:event_datePickerYOBInputMethodTextChanged

    private void admitPrintBtnActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_admitPrintBtnActionPerformed

        java.lang.Boolean nhif = false;
        if ((nhifChbx.isSelected() == true) && nhifCardMemberNumberTxt.getText().length() > 1) {
            nhif = true;
        } else if ((nhifChbx.isSelected() == false)) {
            nhif = true;
        }

        if (admitPrintBtn.getText().equalsIgnoreCase("Update file")) {
            String adm = null;
            String sex = null;

            if (admittedChbx.isSelected()) {
                adm = "false";
            } else {
                if (dischargedChkbx.isSelected()) {
                    adm = "true";
                }
            }

            if (maleChkbx.isSelected()) {
                sex = maleChkbx.getText();
            } else {
                sex = femaleChkbx.getText();
            }

            if (this.marriedMaritalChkbx.isSelected()) {
                selectedStatus = marriedMaritalChkbx.getText();
            }

            if (this.singleMaritalChkbx.isSelected()) {
                selectedStatus = singleMaritalChkbx.getText();
            }

            if (this.divorcedMaritalChkbx.isSelected()) {
                selectedStatus = divorcedMaritalChkbx.getText();
            }

            if (this.widowedMaritalChkbx.isSelected()) {
                selectedStatus = widowedMaritalChkbx.getText();
            }

            try {

                java.sql.Statement stmtfsx = connectDB.createStatement();
                java.sql.ResultSet rsetfsx = stmtfsx.executeQuery("SELECT '" + datePickerYOB.getDate() + "'::DATE ");
                while (rsetfsx.next()) {
                    dateOfBirth = rsetfsx.getString(1);

                }

                java.sql.Statement stmnzab = connectDB.createStatement();
                java.sql.ResultSet rsnzab = stmnzab.executeQuery("select (CURRENT_DATE::DATE - '" + datePickerYOB.getDate() + "'::DATE)/365");
                while (rsnzab.next()) {
                    ageYrs = rsnzab.getDouble(1);
                }

                java.sql.PreparedStatement pstmt811x = connectDB.prepareStatement("UPDATE hp_admission SET  patient_name = '" + firstNameTxt.getText() + " " + surNameTxt.getText() + "',residence ='" + currentResidence.getText() + "',nok = '" + nokNameTxt.getText() + "',tel = '" + nokTelephoneTxt.getText() + "',address = '" + postalAddressTxt.getText() + "',pat_age = '" + ageYrs + "',gender = '" + sex + "',"
                        + "marital_status = '" + selectedStatus + "',id_no='" + idPassportTxt.getText() + "', nationality='" + nationalityCmbx.getSelectedItem() + "',  speciality='" + specialtyClinicCmbx.getSelectedItem() + "', occupation='" + occupationCmbx.getSelectedItem() + "', pat_religion='" + religionCmbx.getSelectedItem() + "', pat_district='" + districtCmbx.getSelectedItem() + "',pat_location='" + locationTxt.getText() + "', chief_name='" + nameofChiefTxt.getText() + "', sub_chief='" + unitNumberTxt.getText() + "', nok_residence='" + nokResidenceTxt.getText() + "', nok_relationship='" + nokRelationShipCmbx.getSelectedItem() + "', \n"
                        + "       home_county='" + countyofBirthCmbx.getSelectedItem() + "',comments='" + patientUrgencyCMBX.getSelectedItem().toString() + "', residence_county='" + countyofResidenceCmbx.getSelectedItem() + "', education_level='" + educationLevelCmbx.getSelectedItem() + "', date_admitted = '" + admissionDatePicker.getDate() + "' WHERE  patient_no = '" + admissionNumberTxt.getText() + "' AND check_out = false AND discharge_date is null");
                //visit_id = '" + jTextField122.getText() + "' and 
                pstmt811x.executeUpdate();

//                            java.sql.PreparedStatement pstmt811x = connectDB.prepareStatement("UPDATE hp_admission SET  patient_name = '" + firstNameTxt.getText() + " " + surNameTxt.getText() + "',date_admitted = '" + datePicker1.getDate().toString() + "',bed_no = '" + bedNumberCmbx.getSelectedItem() + "',ward = '" + admissionWardCmbx.getSelectedItem() + "',wing = '" + bedCategoryCmbx.getSelectedItem() + "', deposit = '" + bedRateTxt.getText() + "',residence ='" + currentResidence.getText() + "',nok = '" + nokNameTxt.getText() + "',tel = '" + nokTelephoneTxt.getText() + "',address = '" + jTextField9.getText() + "',discharge = '" + adm + "',pat_age = '" + ageYrs + "',gender = '" + sex + "',"
//                                    + "marital_status = '" + selectedStatus + "',id_no='"+idPassportTxt.getText()+"', nationality='"+nationalityCmbx.getSelectedItem()+"',  speciality='"+specialtyClinicCmbx.getSelectedItem()+"', occupation='"+occupationCmbx.getSelectedItem()+"', pat_religion='"+religionCmbx.getSelectedItem()+"', pat_district='"+districtCmbx.getSelectedItem()+"',pat_location='"+locationTxt.getText()+"', chief_name='"+jTextField27.getText()+"', sub_chief='"+unitNumberTxt.getText()+"', nok_residence='"+nokResidenceTxt.getText()+"', nok_relationship='"+nokRelationShipCmbx.getSelectedItem()+"', \n" +
//"       home_county='"+countyofBirthCmbx.getSelectedItem()+"',comments='"+ patientUrgencyCMBX.getSelectedItem().toString()+"', residence_county='"+countyofResidenceCmbx.getSelectedItem()+"', education_level='"+educationLevelCmbx.getSelectedItem()+"' WHERE visit_id = '" + jTextField122.getText() + "' and patient_no = '" + admissionNumber.getText() + "'");
//                            pstmt811x.executeUpdate();
                java.sql.PreparedStatement pstmt = connectDB.prepareStatement("UPDATE hp_inpatient_register SET  first_name = '" + surNameTxt.getText() + "',second_name = '" + firstNameTxt.getText() + "',adm_date = '" + admissionDatePicker.getDate().toString() + "',residence ='" + currentResidence.getText() + "',nok = '" + nokNameTxt.getText() + "',tel_no = '" + nokTelephoneTxt.getText() + "',address = '" + postalAddressTxt.getText() + "',sex = '" + sex + "',year_of_birth = '" + dateOfBirth + "',payer = '" + billPayerTxt.getText() + "'  where patient_no = '" + admissionNumberTxt.getText() + "'");
                pstmt.executeUpdate();

                java.sql.PreparedStatement pstmt1 = connectDB.prepareStatement("UPDATE hp_patient_register set first_name = '" + surNameTxt.getText() + "',"
                        + "second_name = '" + firstNameTxt.getText() + "' "
                        + " WHERE patient_no = '" + admissionNumberTxt.getText() + "'");
                pstmt1.executeUpdate();

                java.sql.PreparedStatement pstmn = connectDB.prepareStatement("UPDATE hp_patient_visit SET name = '" + firstNameTxt.getText() + " " + surNameTxt.getText() + "' WHERE patient_no = '" + admissionNumberTxt.getText() + "'");
                pstmn.executeUpdate();

                java.sql.PreparedStatement pstmnx = connectDB.prepareStatement("UPDATE credit_acc_slip SET pat_name = '" + firstNameTxt.getText() + " " + surNameTxt.getText() + "' WHERE patient_no = '" + admissionNumberTxt.getText() + "'");
                pstmnx.executeUpdate();

                java.sql.PreparedStatement pstmnw = connectDB.prepareStatement("UPDATE ac_ledger SET dealer = '" + firstNameTxt.getText() + " " + surNameTxt.getText() + "' WHERE patient_no = '" + admissionNumberTxt.getText() + "' and description not ilike '%grn account%'");
                pstmnw.executeUpdate();

                java.sql.PreparedStatement pstmnf = connectDB.prepareStatement("UPDATE hp_patient_billing SET patient_name = '" + firstNameTxt.getText() + " " + surNameTxt.getText() + "' WHERE patient_no = '" + admissionNumberTxt.getText() + "'");
                pstmnf.executeUpdate();

                java.sql.PreparedStatement pstmnq = connectDB.prepareStatement("UPDATE hp_pharmacy SET patient_name = '" + firstNameTxt.getText() + " " + surNameTxt.getText() + "' WHERE patient_no = '" + admissionNumberTxt.getText() + "'");
                pstmnq.executeUpdate();
            } catch (java.sql.SQLException ex) {
                System.out.println("the update file error is" + ex);
                ex.printStackTrace();
            }

            javax.swing.JOptionPane.showMessageDialog(this, "File updated for patient no [" + admissionNumberTxt.getText() + "]", "Information", javax.swing.JOptionPane.INFORMATION_MESSAGE);

            admitPrintBtn.setEnabled(false);

        } else {

            if (maleChkbx.isSelected() || femaleChkbx.isSelected()) {
                if (nationalityCmbx.getSelectedItem() != null) {
//            if (unitNumberTxt.getText().length() > 1) {
//                if (cSheetNoTxt.getText().length() > 1) {
                    if (surNameTxt.getText().length() > 1) {
                        if (firstNameTxt.getText().length() > 1) {
                            if (currentResidence.getText().length() > 1) {
                                if (admissionWardCmbx.getSelectedItem() != null) {
                                    if (bedCategoryCmbx.getSelectedItem() != null) {
                                        if (specialtyClinicCmbx.getSelectedItem() != null) {
                                            if (!paymentModeCmbx.getSelectedItem().toString().equalsIgnoreCase("-")) {
                                                if (bedNumberCmbx.getSelectedItem() != null) {
                                                    if (bedRateTxt.getText().length() > 0) {
                                                        if (nokNameTxt.getText().length() > 1) {
                                                            if (nhif == true) {
                                                                if (nokRelationShipCmbx.getSelectedItem() != null) {
                                                                    if (nokTelephoneTxt.getText().length() > 6) {

                                                                        int unitNo = 0;
                                                                        boolean status = true;
                                                                        if (newAdimissionRbtn.isSelected()) {

//                                                                            try {
//                                                                                java.sql.Statement stmtx = connectDB.createStatement();
//                                                                                java.sql.ResultSet rsetx = stmtx.executeQuery("SELECT count(*) FROM hp_admission WHERE sub_chief ='" + unitNumberTxt.getText() + "'");
//                                                                                while (rsetx.next()) {
//                                                                                    unitNo = rsetx.getInt(1);
//                                                                                }
//
//                                                                                if (unitNo > 0) {
//                                                                                    //  jLabel33.setForeground(java.awt.Color.red);
//                                                                                    //  jLabel33.setText("PATIENT No. Already On File");
//                                                                                    status = false;
//                                                                                    javax.swing.JOptionPane.showMessageDialog(this, "The Unit Number is already in use", "Error", javax.swing.JOptionPane.ERROR_MESSAGE);
//                                                                                }
//                                                                            } catch (java.sql.SQLException sql) {
//                                                                                sql.printStackTrace();
//                                                                                javax.swing.JOptionPane.showMessageDialog(this, sql.getMessage(), "Error Message!", javax.swing.JOptionPane.ERROR_MESSAGE);
//                                                                            }
                                                                        }

                                                                        if (status == true) {

                                                                            //  else 
                                                                            if (admitPrintBtn.getText().equalsIgnoreCase("Admit & Print")) {
                                                                                adminPrint();
                                                                            }

                                                                        }
                                                                    } else {
                                                                        javax.swing.JOptionPane.showMessageDialog(this, "TRANSACTION ERROR : Please double check your entries. \n DETAILS : NOK Telephone Number is mandatory", "Error", javax.swing.JOptionPane.ERROR_MESSAGE);

                                                                    }
                                                                } else {
                                                                    javax.swing.JOptionPane.showMessageDialog(this, "TRANSACTION ERROR : Please double check your entries. \n DETAILS : NOK Relationship is mandatory", "Error", javax.swing.JOptionPane.ERROR_MESSAGE);

                                                                }
                                                            } else {
                                                                javax.swing.JOptionPane.showMessageDialog(this, "TRANSACTION ERROR : Please double check your entries. \n DETAILS :"
                                                                        + " You MUST provide a card number for NHIF beneficiary", "Error", javax.swing.JOptionPane.ERROR_MESSAGE);

                                                            }
                                                        } else {
                                                            javax.swing.JOptionPane.showMessageDialog(this, "TRANSACTION ERROR : Please double check your entries. \n DETAILS : Next of Kin name is manadatory", "Error", javax.swing.JOptionPane.ERROR_MESSAGE);

                                                        }
                                                    } else {
                                                        javax.swing.JOptionPane.showMessageDialog(this, "TRANSACTION ERROR : Please double check your entries. \n DETAILS : Bed Rate is manadatory, You MUST set rate through setting the \"Bed Category\"", "Error", javax.swing.JOptionPane.ERROR_MESSAGE);

                                                    }
                                                } else {
                                                    javax.swing.JOptionPane.showMessageDialog(this, "TRANSACTION ERROR : Please double check your entries. \n DETAILS : Bed Number is manadatory", "Error", javax.swing.JOptionPane.ERROR_MESSAGE);

                                                }
                                            } else {
                                                javax.swing.JOptionPane.showMessageDialog(this, "TRANSACTION ERROR : Please double check your entries. \n DETAILS : Payment Mode is manadatory", "Error", javax.swing.JOptionPane.ERROR_MESSAGE);

                                            }
                                        } else {
                                            javax.swing.JOptionPane.showMessageDialog(this, "TRANSACTION ERROR : Please double check your entries. \n DETAILS : Specialty Clinic is manadatory", "Error", javax.swing.JOptionPane.ERROR_MESSAGE);

                                        }
                                    } else {
                                        javax.swing.JOptionPane.showMessageDialog(this, "TRANSACTION ERROR : Please double check your entries. \n DETAILS : Bed category is manadatory", "Error", javax.swing.JOptionPane.ERROR_MESSAGE);

                                    }
                                } else {
                                    javax.swing.JOptionPane.showMessageDialog(this, "TRANSACTION ERROR : Please double check your entries. \n DETAILS :  Admission ward is manadatory", "Error", javax.swing.JOptionPane.ERROR_MESSAGE);

                                }
                            } else {
                                javax.swing.JOptionPane.showMessageDialog(this, "TRANSACTION ERROR : Please double check your entries. \n DETAILS : Current residence is manadatory", "Error", javax.swing.JOptionPane.ERROR_MESSAGE);

                            }
                        } else {
                            javax.swing.JOptionPane.showMessageDialog(this, "TRANSACTION ERROR : Please double check your entries. \n DETAILS : First name is manadatory", "Error", javax.swing.JOptionPane.ERROR_MESSAGE);

                        }
                    } else {
                        javax.swing.JOptionPane.showMessageDialog(this, "TRANSACTION ERROR : Please double check your entries. \n DETAILS :  Surname is manadatory", "Error", javax.swing.JOptionPane.ERROR_MESSAGE);

                    }

//                } else {
//                    javax.swing.JOptionPane.showMessageDialog(this, "TRANSACTION ERROR : Please double check your entries. \n DETAILS :  Charge Sheet Number is manadatory", "Error", javax.swing.JOptionPane.ERROR_MESSAGE);
//
//                }
//            } else {
//                javax.swing.JOptionPane.showMessageDialog(this, "TRANSACTION ERROR : Please double check your entries. \n DETAILS :  Unit Number is manadatory", "Error", javax.swing.JOptionPane.ERROR_MESSAGE);
//
//            }
                } else {
                    javax.swing.JOptionPane.showMessageDialog(this, "TRANSACTION ERROR : Please double check your entries. \n DETAILS :  Nationality field is manadatory", "Error", javax.swing.JOptionPane.ERROR_MESSAGE);

                }
            } else {
                javax.swing.JOptionPane.showMessageDialog(this, "TRANSACTION ERROR : Please double check your entries. \n DETAILS :  Gender field is manadatory", "Error", javax.swing.JOptionPane.ERROR_MESSAGE);

            }

        }

        //jButton3.doClick();
        searchbyPatientNumberChkbx.setSelected(true);

        // TODO add your handling code here:
    }//GEN-LAST:event_admitPrintBtnActionPerformed

    private void employerTelTxtActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_employerTelTxtActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_employerTelTxtActionPerformed

    private void disposeBtnActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_disposeBtnActionPerformed

        jSearchDialog4.dispose();
        // TODO add your handling code here:
    }//GEN-LAST:event_disposeBtnActionPerformed

    private void unitNumberTxtCaretUpdate(javax.swing.event.CaretEvent evt) {//GEN-FIRST:event_unitNumberTxtCaretUpdate
        // TODO add your handling code here:
    }//GEN-LAST:event_unitNumberTxtCaretUpdate

    private void editReprintBtnActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_editReprintBtnActionPerformed
        admitPrintBtn.setText("Update File");
        admitPrintBtn.setEnabled(true);
        opdSearchButton.setEnabled(false);
//jButton2.doClick();
        opdNoTxt.setEnabled(false);

        jButton2.setEnabled(true);
        reprintFileBtn.setEnabled(true);

        // TODO add your handling code here:
    }//GEN-LAST:event_editReprintBtnActionPerformed

    private void reprintFileBtnActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_reprintFileBtnActionPerformed
        String nhifStatusTxt = null;

        if (nhifChbx.isSelected()) {
            nhifStatusTxt = "YES";
        } else {
            nhifStatusTxt = "NO";
        }

        String interviewer = null;

        String receiptNo = null, amt = null;

        try {
            java.sql.PreparedStatement pstmt = connectDB.prepareStatement("SELECT current_user");
            java.sql.ResultSet rset = pstmt.executeQuery();
            while (rset.next()) {
                interviewer = rset.getString(1);
            }

            java.sql.Statement stmt11 = connectDB.createStatement();
            java.sql.ResultSet rset11 = stmt11.executeQuery("SELECT  description,receipt_no, debit  FROM ac_cash_collection where  patient_no='" + admissionNumberTxt.getText() + "' and receipt_time::date >= current_date-1 ");
            while (rset11.next()) {
                receiptNo = rset11.getObject(2).toString();
                amt = rset11.getObject(3).toString();
            }

            String selectgender = null;
            if (this.maleChkbx.isSelected()) {
                selectgender = maleChkbx.getText();
            } else {

                selectgender = femaleChkbx.getText();
            }

            com.afrisoftech.reports.PatientRegFormPdf.connectDB = connectDB;
            com.afrisoftech.reports.PatientRegFormPdf regForm = new com.afrisoftech.reports.PatientRegFormPdf();
            regForm.callPdf(connectDB, admissionNumberTxt.getText(), "IP");
        } catch (SQLException ex) {
            ex.printStackTrace();

            Logger.getLogger(PatientRegisterIntfr.class
                    .getName()).log(Level.SEVERE, null, ex);
        }

    }//GEN-LAST:event_reprintFileBtnActionPerformed
    private void changeDate() {
        agelabel.setText(com.afrisoftech.lib.PatientAge.getPatientActualAge(connectDB, this.datePickerYOB.getDate()));
        ageTxt.setText(String.valueOf(com.afrisoftech.lib.PatientAge.getPatientAge(connectDB, this.datePickerYOB.getDate())));

    }
    private void biodataSubPanelMouseMoved(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_biodataSubPanelMouseMoved
//       changeDate();
    }//GEN-LAST:event_biodataSubPanelMouseMoved

    private void admissionsReportBtnActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_admissionsReportBtnActionPerformed
        com.afrisoftech.reports.PatientAdminPdf_ policy = new com.afrisoftech.reports.PatientAdminPdf_();
        policy.PatientAdminPdf(connectDB, startDatePicker.getDate(), endDatePicker.getDate(), "-");

        // TODO add your handling code here:
    }//GEN-LAST:event_admissionsReportBtnActionPerformed

    private void refreshBtnActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_refreshBtnActionPerformed
        if (reportTypeChooserCmbx.getSelectedItem().toString().equalsIgnoreCase("ALL Records Officers")) {
            admissionListingTable.setModel(com.afrisoftech.dbadmin.TableModel.createTableVectors(connectDB, "SELECT patient_no, sub_chief as unit_number,date_admitted, visit_id, patient_name, gender, pat_age as patient_age, ward, wing, mode_of_payment, data_capture_time,user_name AS registrar from hp_admission where date_admitted between '" + startDatePicker.getDate() + "' and '" + endDatePicker.getDate() + "' order by data_capture_time"));
        } else {
            admissionListingTable.setModel(com.afrisoftech.dbadmin.TableModel.createTableVectors(connectDB, "SELECT patient_no, sub_chief as unit_number,date_admitted, visit_id, patient_name, gender, pat_age as patient_age, ward, wing, mode_of_payment, data_capture_time,user_name AS registrar from hp_admission where user_name = current_user and date_admitted between '" + startDatePicker.getDate() + "' and '" + endDatePicker.getDate() + "' order by data_capture_time"));
        }
// TODO add your handling code here:
    }//GEN-LAST:event_refreshBtnActionPerformed

    private void reportTypeChooserCmbxActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_reportTypeChooserCmbxActionPerformed
        if (reportTypeChooserCmbx.getSelectedItem().toString().equalsIgnoreCase("ALL Records Officers")) {
            admissionListingTable.setModel(com.afrisoftech.dbadmin.TableModel.createTableVectors(connectDB, "SELECT patient_no, sub_chief as unit_number,date_admitted, visit_id, patient_name, gender, pat_age as patient_age, ward, wing, mode_of_payment, data_capture_time,user_name AS registrar from hp_admission where date_admitted between '" + startDatePicker.getDate() + "' and '" + endDatePicker.getDate() + "' order by data_capture_time"));
        } else {
            admissionListingTable.setModel(com.afrisoftech.dbadmin.TableModel.createTableVectors(connectDB, "SELECT patient_no, sub_chief as unit_number, date_admitted, visit_id, patient_name, gender, pat_age as patient_age, ward, wing, mode_of_payment, data_capture_time,user_name AS registrar from hp_admission where user_name = current_user and date_admitted between '" + startDatePicker.getDate() + "' and '" + endDatePicker.getDate() + "' order by data_capture_time"));

        }
        // TODO add your handling code here:
    }//GEN-LAST:event_reportTypeChooserCmbxActionPerformed

    private void wardNameCmbxActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_wardNameCmbxActionPerformed

        this.occupationTable.setModel(com.afrisoftech.dbadmin.TableModel.createTableVectors(connectDB, "SELECT patient_no, visit_id, sub_chief as unit_number, patient_name, wing, date_admitted, false as discharge, 'DISCHARGE_BED_RECONCILIATION' as comments, (SELECT sum(debit-credit)::numeric(30,2) FROM hp_patient_card WHERE hp_patient_card.patient_no = hp_admission.patient_no) as BILL_AMOUNT FROM hp_admission WHERE ward = '" + this.wardNameCmbx.getSelectedItem().toString() + "' and check_out = false order by 4"));

        int patientTotal = 0;

        try {

            java.sql.PreparedStatement pstmtTotal = connectDB.prepareStatement("SELECT  count(*) FROM hp_admission WHERE ward = '" + this.wardNameCmbx.getSelectedItem().toString() + "' and check_out = false");

            java.sql.ResultSet rsetTotal = pstmtTotal.executeQuery();

            while (rsetTotal.next()) {

                patientTotal = rsetTotal.getInt(1);

            }

        } catch (SQLException ex) {

            ex.printStackTrace();

            javax.swing.JOptionPane.showMessageDialog(this, ex.getMessage());

            Logger
                    .getLogger(WardOccupancyIntfr.class
                            .getName()).log(Level.SEVERE, null, ex);

        }

        this.totalsLabel.setText("Number Admitted in the Ward: " + patientTotal);

        // TODO add your handling code here:
    }//GEN-LAST:event_wardNameCmbxActionPerformed

    private void patientNumberCaretUpdate(javax.swing.event.CaretEvent evt) {//GEN-FIRST:event_patientNumberCaretUpdate
        if (patientNumber.getText().length() > 3) {
            this.occupationTable.setModel(com.afrisoftech.dbadmin.TableModel.createTableVectors(connectDB, "SELECT patient_no, visit_id, sub_chief as unit_number, patient_name, wing, date_admitted, false as Reinstate, 'REINSTATEMENT' as comments FROM hp_admission WHERE (patient_no ilike '%" + patientNumber.getText() + "%' or patient_name ilike '%" + patientNumber.getText() + "%' or sub_chief ilike '%" + patientNumber.getText() + "%') and check_out = true AND comments = 'DISCHARGE_BED_RECONCILIATION' order by 4"));
        }     // TODO add your handling code here:
    }//GEN-LAST:event_patientNumberCaretUpdate

    private void patientNumberActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_patientNumberActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_patientNumberActionPerformed

    private void searchFileBtnActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_searchFileBtnActionPerformed

        this.occupationTable.setModel(com.afrisoftech.dbadmin.TableModel.createTableVectors(connectDB, "SELECT patient_no, visit_id, sub_chief as unit_number, patient_name, wing, date_admitted, false as discharge, '' as comments FROM hp_admission WHERE patient_no = '" + patientNumber.getText() + "' and check_out = true AND comments = '' order by 4"));

        // TODO add your handling code here:
    }//GEN-LAST:event_searchFileBtnActionPerformed

    private void jButton7ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton7ActionPerformed

        this.occupationTable.setModel(com.afrisoftech.dbadmin.TableModel.createTableVectors(connectDB, "SELECT patient_no, visit_id, sub_chief as unit_number, patient_name, wing, date_admitted, false as discharge, 'DISCHARGE_BED_RECONCILIATION' as comments, (SELECT sum(debit-credit)::numeric(30,2) FROM hp_patient_card WHERE hp_patient_card.patient_no = hp_admission.patient_no) as BILL_AMOUNT FROM hp_admission WHERE ward = '" + this.wardNameCmbx.getSelectedItem().toString() + "' and check_out = false order by 4"));

        int patientTotal = 0;

        try {

            java.sql.PreparedStatement pstmtTotal = connectDB.prepareStatement("SELECT  count(*) FROM hp_admission WHERE ward = '" + this.wardNameCmbx.getSelectedItem().toString() + "' and check_out = false");

            java.sql.ResultSet rsetTotal = pstmtTotal.executeQuery();

            while (rsetTotal.next()) {

                patientTotal = rsetTotal.getInt(1);

            }

        } catch (SQLException ex) {

            ex.printStackTrace();

            javax.swing.JOptionPane.showMessageDialog(this, ex.getMessage());

            Logger
                    .getLogger(WardOccupancyIntfr.class
                            .getName()).log(Level.SEVERE, null, ex);

        }

        this.totalsLabel.setText("Number Admitted in the Ward: " + patientTotal);
        // TODO add your handling code here:
    }//GEN-LAST:event_jButton7ActionPerformed

    private void jButton10ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton10ActionPerformed

        this.dispose();
        // TODO add your handling code here:
    }//GEN-LAST:event_jButton10ActionPerformed

    private void refreshBtn1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_refreshBtn1ActionPerformed
        if (reportTypeChooserCmbx1.getSelectedItem().toString().equalsIgnoreCase("ALL Records Officers")) {
            admissionAnalysisTable.setModel(com.afrisoftech.dbadmin.TableModel.createTableVectors(connectDB, "SELECT ward, count(ward) FROM hp_admission  where date_admitted between '" + startDatePicker1.getDate() + "' and '" + endDatePicker1.getDate() + "' group by 1 order by 1"));
        } else {
            admissionAnalysisTable.setModel(com.afrisoftech.dbadmin.TableModel.createTableVectors(connectDB, "SELECT ward, count(ward) FROM hp_admission  where date_admitted  between '" + startDatePicker1.getDate() + "' and '" + endDatePicker1.getDate() + "' and user_name = current_user group by 1 order by 1"));
        }     // TODO add your handling code here:
    }//GEN-LAST:event_refreshBtn1ActionPerformed

    private void reportTypeChooserCmbx1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_reportTypeChooserCmbx1ActionPerformed
        if (reportTypeChooserCmbx1.getSelectedItem().toString().equalsIgnoreCase("ALL Records Officers")) {
            admissionAnalysisTable.setModel(com.afrisoftech.dbadmin.TableModel.createTableVectors(connectDB, "SELECT ward, count(ward) FROM hp_admission  where date_admitted between '" + startDatePicker1.getDate() + "' and '" + endDatePicker1.getDate() + "' group by 1 order by 1"));
        } else {
            admissionAnalysisTable.setModel(com.afrisoftech.dbadmin.TableModel.createTableVectors(connectDB, "SELECT ward, count(ward) FROM hp_admission  where date_admitted  between '" + startDatePicker1.getDate() + "' and '" + endDatePicker1.getDate() + "' and user_name = current_user group by 1 order by 1"));
        }// TODO add your handling code here:
    }//GEN-LAST:event_reportTypeChooserCmbx1ActionPerformed

    private void ageYrsTxtCaretUpdate(javax.swing.event.CaretEvent evt) {//GEN-FIRST:event_ageYrsTxtCaretUpdate

        if (ageYrsTxt.getText().length() > 0) {
            try {
                java.sql.PreparedStatement pstmt = connectDB.prepareStatement("SELECT current_date - round(? * 365.25)::int");
                pstmt.setInt(1, Integer.parseInt(ageYrsTxt.getText()));
                java.sql.ResultSet rset = pstmt.executeQuery();
                while (rset.next()) {
                    datePickerYOB.setDate(rset.getDate(1));
                }

            } catch (java.sql.SQLException sq) {
                sq.printStackTrace();
                javax.swing.JOptionPane.showMessageDialog(this, sq.getMessage());

            }
        }        // TODO add your handling code here:
    }//GEN-LAST:event_ageYrsTxtCaretUpdate

    private void currentResidenceActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_currentResidenceActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_currentResidenceActionPerformed

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JPanel actionsPanel;
    private javax.swing.JPanel admissionAnalysisPanel;
    private javax.swing.JTable admissionAnalysisTable;
    private javax.swing.JLabel admissionDateLbl;
    private com.afrisoftech.lib.DatePicker admissionDatePicker;
    private javax.swing.JPanel admissionHeaderDetailPanel;
    private javax.swing.JPanel admissionInstancePanel;
    private javax.swing.JPanel admissionListingPanel;
    private javax.swing.JTable admissionListingTable;
    private javax.swing.JPanel admissionNoPanel;
    private javax.swing.JLabel admissionNolbl;
    private javax.swing.JTextField admissionNumberTxt;
    private javax.swing.JPanel admissionPanel;
    private javax.swing.JScrollPane admissionScrollPane;
    private javax.swing.JComboBox admissionWardCmbx;
    private javax.swing.JPanel admissionsMainPanel;
    private javax.swing.JButton admissionsReportBtn;
    private javax.swing.JTabbedPane admissionsTabbedPane;
    private javax.swing.JButton admitBtn;
    private javax.swing.JButton admitPrintBtn;
    private javax.swing.JButton admittedByBtn;
    private javax.swing.JLabel admittedByLbl;
    private javax.swing.JPanel admittedByPanel;
    private javax.swing.JTextField admittedByTxt;
    private javax.swing.JCheckBox admittedChbx;
    private javax.swing.JTextField ageTxt;
    private javax.swing.JTextField ageYrsTxt;
    private javax.swing.JLabel agelabel;
    private javax.swing.JPanel bankCardsPanel;
    private javax.swing.JComboBox bedCategoryCmbx;
    private javax.swing.JLabel bedCategoryLbl;
    private javax.swing.JLabel bedNoLbl;
    private javax.swing.JComboBox bedNumberCmbx;
    private javax.swing.JLabel bedOccupiedLbl;
    private javax.swing.JLabel bedRateLbl;
    private javax.swing.JTextField bedRateTxt;
    private javax.swing.JTextField bedoccupiedTxt;
    private javax.swing.JLabel billPayerLbl;
    private javax.swing.JTextField billPayerTxt;
    private javax.swing.JPanel bioDataPanel;
    private javax.swing.JPanel biodataSubPanel;
    private javax.swing.JLabel birthDateLbl;
    private javax.swing.JPanel birthDatePanel;
    private javax.swing.ButtonGroup buttonGroup1;
    private javax.swing.ButtonGroup buttonGroup2;
    private javax.swing.ButtonGroup buttonGroup3;
    private javax.swing.ButtonGroup buttonGroup4;
    private javax.swing.ButtonGroup buttonGroup5;
    private javax.swing.ButtonGroup buttonGroup6;
    private javax.swing.JTextField cSheetNoTxt;
    private javax.swing.JLabel cardExpiryDateLbl;
    private com.afrisoftech.lib.DatePicker cardExpiryDatePicker;
    private javax.swing.JTextField cardIssurerTxt;
    private javax.swing.JLabel cardMaturityDateLbl;
    private com.afrisoftech.lib.DatePicker cardMaturityDatePicker;
    private javax.swing.JComboBox cardNameCmbx;
    private javax.swing.JLabel cardNameLbl;
    private javax.swing.JLabel cardNoLbl;
    private javax.swing.JTextField cardNumberTxt;
    private javax.swing.JLabel cardUssurerLbl;
    private javax.swing.JLabel chargeSheetNoLbl;
    private javax.swing.JTextField clinicFileNumberTxt;
    private javax.swing.JLabel clinicNumberLbl;
    private javax.swing.JComboBox countyofBirthCmbx;
    private javax.swing.JLabel countyofBirthLbl;
    private javax.swing.JComboBox countyofResidenceCmbx;
    private javax.swing.JLabel countyofResidenceLbl;
    public javax.swing.JRadioButton createManualNumbersRbtn;
    private javax.swing.JTextField currentResidence;
    private com.afrisoftech.lib.DatePicker datePickerYOB;
    private javax.swing.JPanel demographicsPanel;
    private javax.swing.JScrollPane diagnosisScrollPane;
    private javax.swing.JTextPane diagnosisTextPane;
    private javax.swing.JLabel disabilityStatusLbl;
    private javax.swing.JCheckBox dischargedChkbx;
    private javax.swing.JButton dispose1;
    private javax.swing.JButton disposeBtn;
    private javax.swing.JComboBox districtCmbx;
    private javax.swing.JCheckBox divorcedMaritalChkbx;
    private javax.swing.JRadioButton editReprintBtn;
    private javax.swing.JComboBox educationLevelCmbx;
    private javax.swing.JLabel educationLevelLbl;
    private javax.swing.JLabel employerNameLbl;
    private javax.swing.JLabel employerTelLbl;
    private javax.swing.JTextField employerTelTxt;
    private javax.swing.JTextField employerTxt;
    private javax.swing.JLabel endDateLbl;
    private javax.swing.JLabel endDateLbl1;
    private com.afrisoftech.lib.DatePicker endDatePicker;
    private com.afrisoftech.lib.DatePicker endDatePicker1;
    private javax.swing.JCheckBox femaleChkbx;
    private javax.swing.JTextField firstNameTxt;
    private javax.swing.JLabel genderLbl;
    private javax.swing.JPanel genderpanel;
    private javax.swing.JCheckBox hasInterimBillChkbx;
    private javax.swing.JCheckBox hospitalCategoryChkbx;
    private javax.swing.JLabel idNumberLbl;
    private javax.swing.JTextField idPassportTxt;
    private javax.swing.JDialog ipSearchDialog;
    private javax.swing.JPanel ipSearchPanel;
    private javax.swing.JScrollPane ipSearchScrollPane;
    private javax.swing.JTable ipSearchTable;
    private javax.swing.JTextField ipSearchTxt;
    private javax.swing.JButton jButton10;
    private javax.swing.JButton jButton11;
    private javax.swing.JButton jButton1521;
    private javax.swing.JButton jButton2;
    private javax.swing.JButton jButton2021;
    private javax.swing.JButton jButton2521;
    private javax.swing.JButton jButton3;
    private javax.swing.JButton jButton3011;
    public javax.swing.JButton jButton4;
    private javax.swing.JButton jButton41;
    private javax.swing.JButton jButton411;
    public static javax.swing.JButton jButton5;
    private javax.swing.JButton jButton51;
    private javax.swing.JButton jButton511;
    private javax.swing.JButton jButton5121;
    private javax.swing.JButton jButton513;
    private javax.swing.JButton jButton7;
    private javax.swing.JButton jButton8;
    private javax.swing.JButton jButton9;
    private javax.swing.JCheckBox jCheckBox11;
    private javax.swing.JCheckBox jCheckBox21;
    private javax.swing.JDialog jDialog2;
    private javax.swing.JLabel jLabel12;
    private javax.swing.JLabel jLabel13;
    private javax.swing.JLabel jLabel31;
    private javax.swing.JLabel jLabel32;
    private javax.swing.JLabel jLabel33;
    private javax.swing.JLabel jLabel41;
    private javax.swing.JLabel jLabel49;
    private javax.swing.JLabel jLabel51;
    private javax.swing.JLabel jLabel57211;
    private javax.swing.JLabel jLabel58211;
    private javax.swing.JLabel jLabel5822;
    private javax.swing.JLabel jLabel62;
    private javax.swing.JLabel jLabel661;
    private javax.swing.JPanel jPanel11;
    private javax.swing.JPanel jPanel14;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel4;
    private javax.swing.JPanel jPanel41;
    private javax.swing.JDialog jSearchDialog11;
    private javax.swing.JDialog jSearchDialog21;
    private javax.swing.JDialog jSearchDialog4;
    private javax.swing.JPanel jSearchPanel11;
    private javax.swing.JPanel jSearchPanel21;
    private javax.swing.JPanel jSearchPanel3;
    private javax.swing.JPanel jSearchPanel5;
    private javax.swing.JScrollPane jSearchScrollPane11;
    private javax.swing.JScrollPane jSearchScrollPane21;
    private javax.swing.JScrollPane jSearchScrollPane3;
    private javax.swing.JScrollPane jSearchScrollPane4;
    private javax.swing.JTable jSearchTable11;
    private javax.swing.JTable jSearchTable21;
    private javax.swing.JTable jSearchTable3;
    private javax.swing.JTable jSearchTable4;
    private javax.swing.JSeparator jSeparator1;
    private javax.swing.JSeparator jSeparator711;
    private javax.swing.JTextField jTextField1112;
    private javax.swing.JTextField jTextField11131;
    private javax.swing.JTextField jTextField1114;
    private javax.swing.JTextField jTextField141;
    private javax.swing.JTextField jTextField151;
    private javax.swing.JTextField jTextField161;
    private javax.swing.JTextField jTextField21;
    private javax.swing.JTextField jTextField28;
    private javax.swing.JTextField jTextField31;
    private javax.swing.JTextField jTextField41;
    private javax.swing.JTextField jTextField51;
    private javax.swing.JTextField jTextField58211;
    private javax.swing.JLabel locationLbl;
    private javax.swing.JTextField locationTxt;
    private javax.swing.JCheckBox maleChkbx;
    private javax.swing.JLabel maritalStatusLbl;
    private javax.swing.JPanel maritalStatusPanel;
    private javax.swing.JCheckBox marriedMaritalChkbx;
    private javax.swing.JLabel memberBalanceLbl;
    private javax.swing.JTextField memberBalanceTxt;
    private javax.swing.JLabel memberNameLbl;
    private javax.swing.JButton memberNameSearchButton;
    private javax.swing.JTextField memberNameTxt;
    private javax.swing.JLabel memberNoLbl;
    private javax.swing.JTextField memberNumberTxt;
    private javax.swing.JCheckBox mergeOPBillChkbx;
    private javax.swing.JLabel modeofPaymentLbl;
    private javax.swing.JLabel nameofChiefLbl;
    private javax.swing.JTextField nameofChiefTxt;
    private javax.swing.JComboBox nationalityCmbx;
    private javax.swing.JLabel nationalityLbl;
    private javax.swing.JRadioButton newAdimissionRbtn;
    private javax.swing.JTextField nhifCardMemberNumberTxt;
    private javax.swing.JLabel nhifCardNoLbl;
    private javax.swing.JCheckBox nhifChbx;
    private javax.swing.JTextField nhifClaimNumberTxt;
    private javax.swing.JLabel nhifReferenceNoLbl;
    private javax.swing.JLabel nokNameLbl;
    private javax.swing.JTextField nokNameTxt;
    private javax.swing.JLabel nokRelationLbl;
    private javax.swing.JComboBox nokRelationShipCmbx;
    private javax.swing.JLabel nokResidenceLbl;
    private javax.swing.JTextField nokResidenceTxt;
    private javax.swing.JLabel nokTelLbl;
    private javax.swing.JTextField nokTelephoneTxt;
    private javax.swing.JTextField nokteltxt;
    private javax.swing.JPanel occupancyReportPanel;
    private javax.swing.JPanel occupationButtonPanel;
    private javax.swing.JComboBox occupationCmbx;
    private javax.swing.JScrollPane occupationJScrl;
    private javax.swing.JLabel occupationLbl;
    private javax.swing.JTable occupationTable;
    private javax.swing.JPanel occupationsHeaderTable;
    private javax.swing.JPanel occupationsPanel;
    private javax.swing.JLabel oldFileNumberLbl;
    private javax.swing.JDialog opSearchDialog;
    private javax.swing.JTextField opSearchFieldTxt;
    private javax.swing.JPanel opSearchPanel;
    private javax.swing.JScrollPane opSearchScrollPane1;
    private javax.swing.JTable opSearchTable;
    private javax.swing.JLabel opdNoLbl;
    private javax.swing.JPanel opdNoPanel;
    private javax.swing.JTextField opdNoTxt;
    private javax.swing.JButton opdSearchButton;
    private javax.swing.JPanel otherDetailsPanel;
    private javax.swing.JLabel otherNamesLbl;
    private javax.swing.JLabel patientAgeInputLbl;
    private javax.swing.JLabel patientAgeLbl;
    private javax.swing.JTextField patientDebtTxt;
    private javax.swing.JComboBox patientDisabilityCmbx;
    private javax.swing.JTextField patientNumber;
    private javax.swing.JPanel patientStatusPanel;
    private javax.swing.JComboBox patientUrgencyCMBX;
    private javax.swing.JComboBox paymentModeCmbx;
    private javax.swing.JLabel placeofBirthLbl;
    private javax.swing.JLabel postalAddressLbl;
    private javax.swing.JTextField postalAddressTxt;
    private javax.swing.JLabel previousAdmissionDateLbl;
    private javax.swing.JTextField previousAdmissionDateTxt;
    private javax.swing.JLabel previousAdmissionsLbl;
    private javax.swing.JLabel previousDischargeDateLbl;
    private javax.swing.JTextField previousDischargeDateTxt;
    private javax.swing.JPanel previousPanel;
    private javax.swing.JDialog previousVisitIDDialog;
    private javax.swing.JLabel previousVisitIDLbl;
    private javax.swing.JPanel previousVisitIDPanel;
    private javax.swing.JTextField previousVisitIDTxt;
    private javax.swing.JButton previousVisitSearchButton;
    private javax.swing.JScrollPane previousVisitsScrollPane;
    private javax.swing.JTable previousVisitsTable;
    private javax.swing.JCheckBox privateCategoryChkbx;
    private javax.swing.JRadioButton reAdmissionRbtn;
    private javax.swing.JLabel referredFromLbl;
    private javax.swing.JComboBox referredcombo;
    private javax.swing.JButton refreshBtn;
    private javax.swing.JButton refreshBtn1;
    private javax.swing.JScrollPane refreshScrollPane;
    private javax.swing.JComboBox registrationPointCmbx;
    private javax.swing.JLabel registrationPointLbl;
    private javax.swing.JComboBox religionCmbx;
    private javax.swing.JLabel religionLbl;
    private javax.swing.JComboBox reportTypeChooserCmbx;
    private javax.swing.JComboBox reportTypeChooserCmbx1;
    private javax.swing.JButton reprintFileBtn;
    private javax.swing.JLabel residencelbl;
    private javax.swing.JLabel schemeAccNoLbl;
    private javax.swing.JTextField schemeAccNoTxt;
    private javax.swing.JLabel schemeExpiryDateLbl;
    private com.afrisoftech.lib.DatePicker schemeExpiryDatePicker;
    private javax.swing.JLabel schemeManagerLbl;
    private javax.swing.JTextField schemeMangerTxt;
    private javax.swing.JPanel schemeMemberNamePanel;
    private javax.swing.JLabel schemeNameLbl;
    private javax.swing.JTextField schemeNameTxt;
    private javax.swing.JPanel schemePanel;
    private javax.swing.JButton schemeSearchBtn;
    private javax.swing.JButton schemeSearchButton;
    private javax.swing.JDialog schemeSearchDialog;
    private javax.swing.JPanel schemeSearchNamePanel;
    private javax.swing.JPanel schemeSearchPanel;
    private javax.swing.JScrollPane schemeSearchScrollPane;
    private javax.swing.JTable schemeSearchTable;
    private javax.swing.JTextField schemeSearchTxt;
    private javax.swing.JButton searchButton;
    private javax.swing.JButton searchFileBtn;
    private javax.swing.JPanel searchModelPanel;
    private javax.swing.JCheckBox searchbyPatientNameChkbx;
    private javax.swing.JCheckBox searchbyPatientNumberChkbx;
    private javax.swing.JButton select1;
    private javax.swing.JCheckBox singleMaritalChkbx;
    private javax.swing.JLabel spacerLabel;
    private javax.swing.JLabel spacerLabel1;
    private javax.swing.JLabel specialityLbl;
    private javax.swing.JComboBox specialtyClinicCmbx;
    private javax.swing.JLabel startDateLbl;
    private javax.swing.JLabel startDateLbl1;
    private com.afrisoftech.lib.DatePicker startDatePicker;
    private com.afrisoftech.lib.DatePicker startDatePicker1;
    private javax.swing.JLabel surNameLbl;
    private javax.swing.JTextField surNameTxt;
    private javax.swing.JCheckBox suspendBillChkbx;
    private javax.swing.JLabel telephoneNoLbl;
    private javax.swing.JLabel totalsLabel;
    private javax.swing.JTextField unitNumberTxt;
    private javax.swing.JPanel urgencyPanel;
    private javax.swing.JLabel wardAdmittedLbl;
    private javax.swing.JTextField wardAdmittedTxt;
    private javax.swing.JLabel wardCodeLbl;
    private javax.swing.JTextField wardCodeTxt;
    private javax.swing.JLabel wardLbl;
    private javax.swing.JComboBox wardNameCmbx;
    private javax.swing.JCheckBox widowedMaritalChkbx;
    // End of variables declaration//GEN-END:variables

    private void admitPatient() {
        //throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.

        String yrs = null;
        java.util.Date periodFrom = null;
        java.util.Date periodTo = null;
        java.sql.Savepoint registerSavePoint = null;

        //   try {
        //       connectDB.setAutoCommit(false);
        //       registerSavePoint = connectDB.setSavepoint("registration");
        //   } catch (java.sql.SQLException ex) {
        //       ex.printStackTrace();
        //   }
        try {

            // Date parser
            java.text.SimpleDateFormat dateFormat = new java.text.SimpleDateFormat("EEE MMM dd HH:mm:ss zzz yy");
            com.afrisoftech.lib.DateFormatter dateFormatter = new com.afrisoftech.lib.DateFormatter(dateFormat.parse(admissionDatePicker.getDate().toString().trim()), "yy");

            java.lang.String monthString = dateFormatter.getDateString();

            yrs = monthString;

            // Catch java.text.parse exception.
        } catch (java.text.ParseException prs) {
            prs.printStackTrace();
        }
        try {

            try {
                connectDB.setAutoCommit(false);
                registerSavePoint = connectDB.setSavepoint("registration");
                java.sql.Statement stmtf = connectDB.createStatement();
                java.sql.ResultSet rsetf = stmtf.executeQuery("SELECT period_from,period_to FROM period_setup WHERE period_status ilike 'Open' AND '" + admissionDatePicker.getDate() + "' BETWEEN period_from AND period_to");
                while (rsetf.next()) {
                    periodFrom = rsetf.getDate(1);
                    periodTo = rsetf.getDate(2);
                }
                java.sql.Statement stmtfs = connectDB.createStatement();
                java.sql.ResultSet rsetfs = stmtfs.executeQuery("SELECT '" + datePickerYOB.getDate() + "'::DATE ");
                while (rsetfs.next()) {
                    dateOfBirth = rsetfs.getString(1);

                }

                if (admissionDatePicker.getDate().before(periodFrom) || admissionDatePicker.getDate().after(periodTo)) {
                    javax.swing.JOptionPane.showMessageDialog(this, "You cannot save before or after the accounting period set \n Contact head of accounts".toUpperCase(), "Caution Message", javax.swing.JOptionPane.INFORMATION_MESSAGE);

                } else {

                    String name = null;
                    String activity = null;
                    String actNo = null;
                    String billNo = null;
                    String rate = null;
                    String transNo = null;
                    String patientAcc = null;
                    String insAcc = null;
                    String cardAcc = null;
                    String AccDesc = null;
                    String cardName = null;
                    String insName = null;
                    String user = null;
                    String adcode = null;
                    double adrate = 0.00;
                    double nursing = 0.00;
                    double bedfees = 0.00;
                    String Type = null;
                    String Typet = null;
                    String Main = null;
                    double Limit = 0.0;
                    String Categ = null;
                    String visitid = null;
                    String patientNo = null;
                    String selectedchkbx = null;

                    boolean manualNo = false;
                    String preFix = null;
                    int digitNo = 0;
                    String yrEnd = null;
                    boolean incYr = false;
                    String patientsNo = null;
                    String patientsNo2 = com.afrisoftech.lib.DateLables.getDateLabel();
                    String useoneNumber = null;

                    boolean chargeNursing = false;
                    boolean chargeBed = false;
                    boolean nhifStatus = false;
                    java.sql.Statement stmnzz = connectDB.createStatement();
                    java.sql.ResultSet rsnzz = stmnzz.executeQuery("select ip_numbering,use_one_number from pb_patient_names");
                    while (rsnzz.next()) {
                        manualNo = rsnzz.getBoolean(1);
                        useoneNumber = rsnzz.getString(2);
                    }
                    if (newAdimissionRbtn.isSelected() && manualNo == true) {
                        manualNo = true;
                    } else {
                        if (createManualNumbersRbtn.isSelected() && manualNo == true) {
                            manualNo = false;
                        } else {
                            manualNo = manualNo;
                        }
                    }
                    /*
                     * if(useoneNumber.equalsIgnoreCase("USEONENUMBER") &&
                     * jTextField361.getText().equalsIgnoreCase("")){ manualNo =
                     * true; }else{ manualNo = false; }
                     */

                    if (this.privateCategoryChkbx.isSelected()) {
                        Categ = privateCategoryChkbx.getText();
                    } else {
                        Categ = hospitalCategoryChkbx.getText();
                    }

                    if (this.maleChkbx.isSelected()) {
                        selectedchkbx = maleChkbx.getText();
                    } else {

                        selectedchkbx = femaleChkbx.getText();
                    }

                    if (this.marriedMaritalChkbx.isSelected()) {
                        selectedStatus = marriedMaritalChkbx.getText();
                    } else {
                        if (this.singleMaritalChkbx.isSelected()) {
                            selectedStatus = singleMaritalChkbx.getText();
                        } else {
                            if (this.divorcedMaritalChkbx.isSelected()) {
                                selectedStatus = divorcedMaritalChkbx.getText();
                            } else {
                                if (this.widowedMaritalChkbx.isSelected()) {
                                    selectedStatus = widowedMaritalChkbx.getText();
                                }
                            }
                        }
                    }
                    java.sql.Statement stmnza = connectDB.createStatement();
                    java.sql.ResultSet rsnza = stmnza.executeQuery("select (CURRENT_DATE::DATE - '" + datePickerYOB.getDate() + "'::DATE)/365");
                    while (rsnza.next()) {
                        ageYrs = rsnza.getDouble(1);
                    }
                    if (manualNo == false && admissionNumberTxt.getText().equals("")) {
                        javax.swing.JOptionPane.showMessageDialog(this, "You must enter Patient No.", "Error", javax.swing.JOptionPane.ERROR_MESSAGE);

                    } else {
                        if (admitBtn.getText().equalsIgnoreCase("Update")) {

                            String adm = null;
                            String sex = null;

                            if (admittedChbx.isSelected()) {
                                adm = "false";
                            } else {
                                if (dischargedChkbx.isSelected()) {
                                    adm = "true";
                                }
                            }

                            if (maleChkbx.isSelected()) {
                                sex = maleChkbx.getText();
                            } else {
                                sex = femaleChkbx.getText();
                            }

                            java.sql.PreparedStatement pstmt811x = connectDB.prepareStatement("UPDATE hp_admission SET  patient_name = '" + firstNameTxt.getText() + " " + surNameTxt.getText() + "',date_admitted = '" + admissionDatePicker.getDate().toString() + "',bed_no = '" + bedNumberCmbx.getSelectedItem() + "',ward = '" + admissionWardCmbx.getSelectedItem() + "',wing = '" + bedCategoryCmbx.getSelectedItem() + "', deposit = '" + bedRateTxt.getText() + "',residence ='" + currentResidence.getText() + "',nok = '" + nokNameTxt.getText() + "',tel = '" + nokTelephoneTxt.getText() + "',address = '" + postalAddressTxt.getText() + "',discharge = '" + adm + "',pat_age = '" + ageYrs + "',gender = '" + selectedchkbx + "',marital_status = '" + selectedStatus + "' WHERE visit_id = '" + previousVisitIDTxt.getText() + "'");
                            pstmt811x.executeUpdate();

                            java.sql.PreparedStatement pstmt = connectDB.prepareStatement("UPDATE hp_inpatient_register SET  first_name = '" + surNameTxt.getText() + "',second_name = '" + firstNameTxt.getText() + "',adm_date = '" + admissionDatePicker.getDate().toString() + "',residence ='" + currentResidence.getText() + "',nok = '" + nokNameTxt.getText() + "',tel_no = '" + nokTelephoneTxt.getText() + "',address = '" + postalAddressTxt.getText() + "',sex = '" + sex + "',year_of_birth = '" + dateOfBirth + "',payer = '" + billPayerTxt.getText() + "'  where patient_no = '" + admissionNumberTxt.getText() + "'");
                            pstmt.executeUpdate();

                            javax.swing.JOptionPane.showConfirmDialog(this, "File updated for patient no [" + admissionNumberTxt.getText() + "]", "Information", javax.swing.JOptionPane.INFORMATION_MESSAGE);

                        } else {

                            java.sql.PreparedStatement pstmt21 = connectDB.prepareStatement("UPDATE hp_admission SET diagnosed = true WHERE patient_no ilike '" + admissionNumberTxt.getText() + "'");

                            pstmt21.executeUpdate();

                            if (newAdimissionRbtn.isSelected() || createManualNumbersRbtn.isSelected()) {
                                java.sql.Statement stmt = connectDB.createStatement();
                                java.sql.ResultSet rset = stmt.executeQuery("SELECT patient_no FROM hp_inpatient_register WHERE patient_no ='" + this.admissionNumberTxt.getText() + "'");
                                while (rset.next()) {
                                    patientNo = rset.getObject(1).toString();
                                }

                                java.sql.Statement stmt11 = connectDB.createStatement();

                                java.sql.ResultSet rset11 = stmt11.executeQuery("SELECT patient_no,check_out FROM hp_admission WHERE patient_no ='" + admissionNumberTxt.getText() + "' and check_out = false");
                                while (rset11.next()) {
                                    // jComboBox1.setSelectedItem(rset11.getObject(1).toString());
                                    name = rset11.getObject(1).toString();
                                    if (rset11.getBoolean(2) == false) {
                                        hasInterimBillChkbx.setSelected(true);
                                    } else {
                                        hasInterimBillChkbx.setSelected(false);
                                    }
                                }

                                if (this.admissionNumberTxt.getText().equalsIgnoreCase(patientNo)) {
                                    jLabel33.setForeground(java.awt.Color.red);
                                    jLabel33.setText("PATIENT No. Already On File");

                                    // javax.swing.JOptionPane.showMessageDialog(this,"PATIENT No. Already Exists", "Error",javax.swing.JOptionPane.ERROR_MESSAGE);
                                } else if (admissionNumberTxt.getText().equalsIgnoreCase(name)) {
                                    javax.swing.JOptionPane.showMessageDialog(this, " Patient with patient no '" + name + "' already admitted ", "Error", javax.swing.JOptionPane.ERROR_MESSAGE);

                                } else {

                                    if (manualNo) {

                                        patientsNo2 = patientsNo2;

                                    } else {

                                        patientsNo = admissionNumberTxt.getText();
                                        patientsNo2 = patientsNo;
                                    }
                                    java.sql.PreparedStatement pstmt = connectDB.prepareStatement("INSERT INTO hp_inpatient_register(patient_no, first_name, second_name, last_name, nok, residence, address, year_of_birth, tel_no, sex,op_no) VALUES(?, UPPER(?), UPPER(?), ?, ?, ?, ?, ?, ?, ?,?)");
                                    pstmt.setString(1, patientsNo2);
                                    if (surNameTxt.getText().equals("")) {
                                        javax.swing.JOptionPane.showMessageDialog(this, "You must enter First Name and Second Name", "Error", javax.swing.JOptionPane.ERROR_MESSAGE);
                                    } else {
                                        pstmt.setString(2, surNameTxt.getText().toUpperCase());
                                    }
                                    pstmt.setString(3, firstNameTxt.getText());
                                    pstmt.setString(4, "");
                                    pstmt.setString(5, nokNameTxt.getText());
                                    pstmt.setString(8, dateOfBirth);
                                    pstmt.setString(7, postalAddressTxt.getText());
                                    if (currentResidence.getText().equals("")) {
                                        javax.swing.JOptionPane.showMessageDialog(this, "You must enter residence", "Error", javax.swing.JOptionPane.ERROR_MESSAGE);
                                    } else {
                                        pstmt.setString(6, currentResidence.getText());
                                    }

                                    pstmt.setString(9, nokTelephoneTxt.getText());
                                    if (selectedchkbx == null) {
                                        javax.swing.JOptionPane.showMessageDialog(this, "You must tick patient sex", "Error", javax.swing.JOptionPane.ERROR_MESSAGE);
                                    } else {
                                        pstmt.setObject(10, selectedchkbx);
                                    }
                                    pstmt.setString(11, opdNoTxt.getText());
                                    pstmt.executeUpdate();
                                    this.admitBtn.setVisible(false);
                                    //   javax.swing.JOptionPane.showMessageDialog(this, "Insert Done Successfully","Comfirmation Message",javax.swing.JOptionPane.INFORMATION_MESSAGE);

                                }
                            }

                            if (newAdimissionRbtn.isSelected()) {

                                if (manualNo) {
                                    String patNos = null;

                                    if (useoneNumber.equalsIgnoreCase("useonenumber")) {
                                        // Checking the presence of out patient number in hp_patient_register
                                        int opNos = 0;
                                        java.sql.Statement stmnz1c = connectDB.createStatement();
                                        java.sql.ResultSet rsnz1c = stmnz1c.executeQuery("SELECT COUNT(patient_no) FROM hp_patient_register WHERE patient_no = '" + opdNoTxt.getText() + "'");
                                        while (rsnz1c.next()) {
                                            opNos = rsnz1c.getInt(1);
                                        }
                                        if (opNos > 0) {
                                            patientNo = opdNoTxt.getText();
                                            admissionNumberTxt.setText(opdNoTxt.getText());
                                        } else {
                                            java.sql.Statement stmnz1 = connectDB.createStatement();
                                            java.sql.ResultSet rsnz1 = stmnz1.executeQuery("select prefix_item,digit_no,yr_end,inc_year from pb_patient_names");
                                            while (rsnz1.next()) {
                                                preFix = rsnz1.getString(1);
                                                digitNo = rsnz1.getInt(2);
                                                yrEnd = rsnz1.getString(3);
                                                incYr = rsnz1.getBoolean(4);
                                            }
                                            if (incYr) {

                                                java.sql.Statement pss1x = connectDB.createStatement();
                                                java.sql.ResultSet rss1x = pss1x.executeQuery("select nextval('outpatient_no_seq')");
                                                while (rss1x.next()) {
                                                    patNos = rss1x.getObject(1).toString();
                                                }
                                                if (preFix.equalsIgnoreCase("noPrefix")) {
                                                    java.sql.Statement pss1 = connectDB.createStatement();
                                                    java.sql.ResultSet rss1 = pss1.executeQuery("select lpad('" + patNos + "'," + digitNo + ",'0')||'/'||'" + yrs + "'");
                                                    while (rss1.next()) {
                                                        patientNo = rss1.getObject(1).toString();
                                                        admissionNumberTxt.setText(rss1.getObject(1).toString());

                                                    }

                                                } else {
                                                    java.sql.Statement pss1 = connectDB.createStatement();
                                                    java.sql.ResultSet rss1 = pss1.executeQuery("select '" + preFix + "'||lpad('" + patNos + "'," + digitNo + ",'0')||'/'||'" + yrs + "'");
                                                    while (rss1.next()) {
                                                        patientNo = rss1.getObject(1).toString();
                                                        admissionNumberTxt.setText(rss1.getObject(1).toString());
                                                    }
                                                }
                                            } else {
                                                java.sql.Statement pss1x = connectDB.createStatement();
                                                java.sql.ResultSet rss1x = pss1x.executeQuery("select nextval('outpatient_no_seq')");
                                                while (rss1x.next()) {
                                                    patNos = rss1x.getObject(1).toString();
                                                }
                                                if (preFix.equalsIgnoreCase("noPrefix")) {
                                                    java.sql.Statement pss1 = connectDB.createStatement();
                                                    java.sql.ResultSet rss1 = pss1.executeQuery("select lpad('" + patNos + "'," + digitNo + ",'0')");
                                                    while (rss1.next()) {
                                                        patientNo = rss1.getObject(1).toString();
                                                        admissionNumberTxt.setText(rss1.getObject(1).toString());
                                                    }
                                                } else {
                                                    java.sql.Statement pss1 = connectDB.createStatement();
                                                    java.sql.ResultSet rss1 = pss1.executeQuery("select '" + preFix + "'||lpad('" + patNos + "'," + digitNo + ",'0')");
                                                    while (rss1.next()) {
                                                        patientNo = rss1.getObject(1).toString();
                                                        admissionNumberTxt.setText(rss1.getObject(1).toString());
                                                    }
                                                }
                                            }
                                        }
                                    } else {

                                        java.sql.Statement pss1x = connectDB.createStatement();
                                        java.sql.ResultSet rss1x = pss1x.executeQuery("select nextval('inpatient_no_seq')");
                                        while (rss1x.next()) {
                                            patNos = rss1x.getObject(1).toString();
                                        }
                                        java.sql.Statement stmnz1 = connectDB.createStatement();
                                        java.sql.ResultSet rsnz1 = stmnz1.executeQuery("select ip_prefix,ip_digit,ip_yr from pb_patient_names");
                                        while (rsnz1.next()) {
                                            preFix = rsnz1.getString(1);
                                            digitNo = rsnz1.getInt(2);
                                            incYr = rsnz1.getBoolean(3);
                                        }
                                        if (incYr) {

                                            if (preFix.equalsIgnoreCase("noIP")) {

                                                java.sql.Statement pss1 = connectDB.createStatement();
                                                java.sql.ResultSet rss1 = pss1.executeQuery("select lpad('" + patNos + "'," + digitNo + ",'0')||'/'||'" + yrs + "'");
                                                while (rss1.next()) {
                                                    patientsNo = rss1.getObject(1).toString();
                                                    admissionNumberTxt.setText(rss1.getObject(1).toString());
                                                }

                                            } else {
                                                java.sql.Statement pss1 = connectDB.createStatement();
                                                java.sql.ResultSet rss1 = pss1.executeQuery("select '" + preFix + "'||lpad('" + patNos + "'," + digitNo + ",'0')||'/'||'" + yrs + "'");
                                                while (rss1.next()) {
                                                    patientsNo = rss1.getObject(1).toString();
                                                    admissionNumberTxt.setText(rss1.getObject(1).toString());
                                                }
                                            }
                                        } else {
                                            if (preFix.equalsIgnoreCase("noiP")) {
                                                java.sql.Statement pss1 = connectDB.createStatement();
                                                java.sql.ResultSet rss1 = pss1.executeQuery("select lpad('" + patNos + "'," + digitNo + ",'0')");
                                                while (rss1.next()) {
                                                    patientsNo = rss1.getObject(1).toString();
                                                    admissionNumberTxt.setText(rss1.getObject(1).toString());
                                                }
                                            } else {
                                                java.sql.Statement pss1 = connectDB.createStatement();
                                                java.sql.ResultSet rss1 = pss1.executeQuery("select '" + preFix + "'||lpad('" + patNos + "'," + digitNo + ",'0')");
                                                while (rss1.next()) {
                                                    patientsNo = rss1.getObject(1).toString();
                                                    admissionNumberTxt.setText(rss1.getObject(1).toString());
                                                }
                                            }
                                        }

                                    }
                                    java.sql.PreparedStatement pstmt11 = connectDB.prepareStatement("UPDATE hp_inpatient_register SET patient_no = '" + admissionNumberTxt.getText() + "'  WHERE patient_no = '" + patientsNo2 + "'");
                                    pstmt11.executeUpdate();
                                    java.sql.PreparedStatement pstmt11z = connectDB.prepareStatement("UPDATE hp_admission SET patient_no = '" + admissionNumberTxt.getText() + "',admission_no = '" + admissionNumberTxt.getText() + "'  WHERE patient_no = '" + patientsNo2 + "'");
                                    pstmt11z.executeUpdate();
                                }

                            }
                            if (admissionNumberTxt.getText().equalsIgnoreCase(name)) {
                                javax.swing.JOptionPane.showMessageDialog(this, " Patient with with patient no '" + name + "' already admitted ", "Error", javax.swing.JOptionPane.ERROR_MESSAGE);

                            } else {
                                java.sql.Statement stmtD = connectDB.createStatement();
                                java.sql.ResultSet rsetD = stmtD.executeQuery("select rate,gl_account,service_type,main_service from pb_operating_parameters where category ='AF'");
                                while (rsetD.next()) {

                                    // adrate = rsetD.getDouble(1);
                                    //   adcode = rsetD.getObject(2).toString();
                                    Type = rsetD.getObject(3).toString();
                                    //   Main = rsetD.getObject(4).toString();
                                }

                                java.sql.Statement stmtDt = connectDB.createStatement();
                                java.sql.ResultSet rsetDt = stmtDt.executeQuery("select rate,gl_account,service_type,main_service from pb_operating_parameters where category ='NF'");
                                while (rsetDt.next()) {

                                    // adrate = rsetD.getDouble(1);
                                    //   adcode = rsetD.getObject(2).toString();
                                    Typet = rsetDt.getObject(3).toString();
                                    //   Main = rsetD.getObject(4).toString();
                                }

                                java.sql.Statement stmtDq = connectDB.createStatement();
                                java.sql.ResultSet rsetDq = stmtDq.executeQuery("select revdesc,revcode from hp_wards where ward_name = '" + admissionWardCmbx.getSelectedItem() + "'");
                                while (rsetDq.next()) {

                                    //   adrate = rsetD.getDouble(1);
                                    adcode = rsetDq.getObject(2).toString();
                                    //    Type = rsetD.getObject(3).toString();
                                    Main = rsetDq.getObject(1).toString();
                                }

                                java.sql.Statement stm1 = connectDB.createStatement();
                                java.sql.ResultSet rse1 = stm1.executeQuery("select code,activity,user from pb_activity where activity_category ='PR'");
                                while (rse1.next()) {

                                    patientAcc = rse1.getObject(1).toString();
                                    AccDesc = rse1.getObject(2).toString();
                                }

                                java.sql.Statement stm1d = connectDB.createStatement();
                                java.sql.ResultSet rse1d = stm1d.executeQuery("select current_user");
                                while (rse1d.next()) {

                                    user = rse1d.getObject(1).toString();
                                }

                                java.sql.Statement stm1l = connectDB.createStatement();
                                java.sql.ResultSet rse1l = stm1l.executeQuery("select amount from pb_iplimit");
                                while (rse1l.next()) {

                                    Limit = rse1l.getDouble(1);

                                }
                                java.sql.Statement stm1lx = connectDB.createStatement();
                                java.sql.ResultSet rse1lx = stm1lx.executeQuery("select nursing,adm_rate, rate,charge_nfee,charge_bfee from hp_bed_category WHERE category ilike '" + bedCategoryCmbx.getSelectedItem() + "'");
                                while (rse1lx.next()) {

                                    adrate = rse1lx.getDouble(2);
                                    nursing = rse1lx.getDouble(1);
                                    bedfees = rse1lx.getDouble(3);
                                    chargeNursing = rse1lx.getBoolean(4);
                                    chargeBed = rse1lx.getBoolean(5);
                                }
                                java.sql.Statement stm2 = connectDB.createStatement();
                                java.sql.ResultSet rse2 = stm2.executeQuery("select code,activity from pb_activity where activity_category ='PR'");
                                while (rse2.next()) {

                                    insAcc = rse2.getObject(1).toString();
                                    insName = rse2.getObject(2).toString();
                                }
                                // if(jCheckBox1.isSelected()||jCheckBox2.isSelected()){

                                java.sql.Statement stmt1 = connectDB.createStatement();
                                java.sql.ResultSet rset1 = stmt1.executeQuery("select nextval('billing_no_seq')");
                                while (rset1.next()) {
                                    billNo = rset1.getObject(1).toString();
                                }
                                java.sql.Statement stmt3 = connectDB.createStatement();
                                java.sql.ResultSet rset3 = stmt3.executeQuery("select nextval('transaction_no_seq')");
                                while (rset3.next()) {
                                    transNo = rset3.getObject(1).toString();
                                }
                                java.sql.Statement stmtq = connectDB.createStatement();
                                java.sql.ResultSet rsetq = stmtq.executeQuery("select nextval('ipvisit_id')");
                                while (rsetq.next()) {
                                    visitid = rsetq.getObject(1).toString();
                                }

                                java.sql.PreparedStatement pstmt27 = connectDB.prepareStatement("update hp_bed_setup set occupied = true where bed_no ='" + bedNumberCmbx.getSelectedItem() + "' and ward = '" + admissionWardCmbx.getSelectedItem() + "'");
                                pstmt27.execute();

                                java.sql.PreparedStatement pstmt11 = connectDB.prepareStatement("UPDATE hp_inpatient_register set pay_mode = '" + paymentModeCmbx.getSelectedItem().toString() + "',category = '" + bedCategoryCmbx.getSelectedItem().toString() + "',adm_date = '" + com.afrisoftech.lib.SQLDateFormat.getSQLDate(admissionDatePicker.getDate()) + "',payer = '" + billPayerTxt.getText() + "'  WHERE patient_no = '" + admissionNumberTxt.getText() + "'");
                                pstmt11.executeUpdate();

                                //  java.sql.PreparedStatement pstmt81x = connectDB.prepareStatement("UPDATE hp_patient_card SET invoice_no = '"+visitid+"', visit_id = '"+visitid+"' where patient_no = '"+jTextField12.getText()+"' and visit_id = 'Booking'");
                                //  pstmt81x.executeUpdate();
                                java.sql.PreparedStatement pstmt811x = connectDB.prepareStatement("UPDATE hp_patient_card SET visit_id = '" + visitid + "' where patient_no = '" + admissionNumberTxt.getText() + "' and service ilike 'Receip%' AND invoice_no not ilike 'I%' and date::date BETWEEN (current_date - 200) AND CURRENT_DATE and (visit_id = '' or visit_id = '-')");
                                pstmt811x.executeUpdate();

                                if (schemePanel.isVisible()) {
                                    java.sql.PreparedStatement pstmt111 = connectDB.prepareStatement("UPDATE hp_inpatient_register set description = '" + schemeNameTxt.getText() + "',payer = '" + schemeMangerTxt.getText() + "',account_no ='" + memberNumberTxt.getText() + "',expiry_date = '" + com.afrisoftech.lib.SQLDateFormat.getSQLDate(cardExpiryDatePicker.getDate()) + "', member_no = '" + memberNumberTxt.getText() + "',member_name = '" + memberNameTxt.getText() + "' WHERE patient_no = '" + admissionNumberTxt.getText() + "'");
                                    pstmt111.executeUpdate();
                                } else {
                                    if (bankCardsPanel.isVisible()) {
                                        java.sql.PreparedStatement pstmta = connectDB.prepareStatement("UPDATE hp_inpatient_register set description = '" + cardNameCmbx.getSelectedItem().toString() + "',payer = '" + cardIssurerTxt.getText() + "',account_no ='" + cardNumberTxt.getText() + "',expiry_date = '" + com.afrisoftech.lib.SQLDateFormat.getSQLDate(schemeExpiryDatePicker.getDate()) + "' WHERE patient_no = '" + admissionNumberTxt.getText() + "'");

                                        pstmta.executeUpdate();
                                    }

                                }

// Entry of nursing fees into the hp_admission table
                                java.sql.PreparedStatement pstmt = connectDB.prepareStatement("INSERT INTO hp_admission VALUES(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)");

                                pstmt.setString(1, admissionNumberTxt.getText());

                                pstmt.setString(2, firstNameTxt.getText().toUpperCase() + " " + surNameTxt.getText().toUpperCase());
                                pstmt.setString(3, diagnosisTextPane.getText());
                                if (admissionWardCmbx.getSelectedItem() == null) {
                                    javax.swing.JOptionPane.showMessageDialog(this, "You must Select Ward Name", "Error", javax.swing.JOptionPane.ERROR_MESSAGE);
                                } else {

                                    pstmt.setString(5, admissionWardCmbx.getSelectedItem().toString());
                                }
                                if (paymentModeCmbx.getSelectedItem().toString().equalsIgnoreCase("Scheme")) {
                                    pstmt.setString(4, schemeNameTxt.getText());
                                } else {
                                    pstmt.setString(4, "Self");
                                }
                                pstmt.setString(6, bedNumberCmbx.getSelectedItem().toString());
                                pstmt.setString(7, admittedByTxt.getText().toString());
                                pstmt.setString(8, bedCategoryCmbx.getSelectedItem().toString());
                                pstmt.setString(9, nokNameTxt.getText());
                                pstmt.setString(10, nokTelephoneTxt.getText());
                                pstmt.setString(11, postalAddressTxt.getText());
                                pstmt.setString(12, idPassportTxt.getText());
                                pstmt.setString(13, paymentModeCmbx.getSelectedItem().toString());
                                pstmt.setString(14, Categ);
                                pstmt.setDouble(15, java.lang.Double.valueOf(bedRateTxt.getText()));
                                pstmt.setString(16, referredcombo.getSelectedItem().toString());
                                pstmt.setString(17, nationalityCmbx.getSelectedItem().toString());
                                pstmt.setBoolean(18, false);
                                pstmt.setString(19, currentResidence.getText());
                                pstmt.setString(20, "");
                                pstmt.setString(21, nhifChbx.getText());
                                pstmt.setDate(22, com.afrisoftech.lib.SQLDateFormat.getSQLDate(admissionDatePicker.getDate()));

                                pstmt.setString(23, admissionNumberTxt.getText());

                                pstmt.setString(24, user);
                                pstmt.setString(25, null);
                                pstmt.setString(26, null);
                                pstmt.setString(27, visitid);
                                pstmt.setDouble(28, 0.00);
                                pstmt.setString(29, "");
                                pstmt.setDouble(30, nursing);
                                pstmt.setBoolean(31, false);
                                pstmt.setString(32, "");
                                pstmt.setString(33, "");
                                pstmt.setString(34, registrationPointCmbx.getSelectedItem().toString());
                                pstmt.setString(35, "");
                                pstmt.setDouble(36, ageYrs);
                                pstmt.setObject(37, selectedchkbx);
                                pstmt.setObject(38, selectedStatus);
                                pstmt.setString(39, "Admitted");
                                if (newAdimissionRbtn.isSelected()) {
                                    pstmt.setString(40, "First Admission ");
                                } else {
                                    pstmt.setString(40, "Re Admission ");
                                }
                                pstmt.setObject(41, specialtyClinicCmbx.getSelectedItem());
                                pstmt.setObject(42, occupationCmbx.getSelectedItem());
                                pstmt.setBoolean(43, false);
                                pstmt.setObject(44, religionCmbx.getSelectedItem());
                                pstmt.setObject(45, this.districtCmbx.getSelectedItem());
                                pstmt.setObject(46, this.locationTxt.getText());
                                pstmt.setObject(47, this.nokteltxt.getText());
                                pstmt.setObject(48, this.unitNumberTxt.getText());
                                pstmt.setObject(49, this.nokResidenceTxt.getText());
                                pstmt.setObject(50, this.nokRelationShipCmbx.getSelectedItem());
                                pstmt.setBoolean(51, false);
                                pstmt.setString(52, null);
                                if (nhifChbx.isSelected()) {
                                    nhifStatus = true;
                                } else {
                                    nhifStatus = false;
                                }
                                pstmt.setBoolean(53, nhifStatus);
                                pstmt.setString(54, countyofBirthCmbx.getSelectedItem().toString());
                                pstmt.setString(55, countyofResidenceCmbx.getSelectedItem().toString());
                                pstmt.setString(56, educationLevelCmbx.getSelectedItem().toString());
                                pstmt.setString(57, cSheetNoTxt.getText());

                                pstmt.executeUpdate();

// Ledger entry for admission fees at the point of registration. (This is done on ac_ledger)                                
                                java.sql.PreparedStatement pstmt2 = connectDB.prepareStatement("insert into ac_ledger values(?,?,?,?,?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?,?,?,?)");
                                pstmt2.setString(1, adcode);
                                pstmt2.setString(2, Type);
                                pstmt2.setString(3, admissionNumberTxt.getText());
                                pstmt2.setString(4, surNameTxt.getText());
                                pstmt2.setString(5, "");
                                pstmt2.setString(6, "");
                                pstmt2.setString(7, "");
                                pstmt2.setString(8, "IP");
                                pstmt2.setString(9, "");
                                pstmt2.setString(10, paymentModeCmbx.getSelectedItem().toString());
                                pstmt2.setString(11, "");
                                pstmt2.setString(12, "");
                                pstmt2.setString(13, "");
                                pstmt2.setString(14, Type);
                                pstmt2.setString(15, "Revenue");
                                pstmt2.setDouble(16, 0.00);
                                pstmt2.setDouble(17, adrate);
                                pstmt2.setDate(18, com.afrisoftech.lib.SQLDateFormat.getSQLDate(admissionDatePicker.getDate()));
                                pstmt2.setString(19, "" + transNo + "");
                                pstmt2.setBoolean(20, false);
                                pstmt2.setBoolean(21, false);
                                pstmt2.setBoolean(22, false);
                                pstmt2.setString(23, user);
                                pstmt2.executeUpdate();

// Billing for admission fee at the point point of admission.
                                java.sql.PreparedStatement pstmt1 = connectDB.prepareStatement("insert into hp_patient_card values(?,?,?,?,?,?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?,?,?,?,?,?,?,?)");
                                pstmt1.setString(1, admissionNumberTxt.getText());
                                pstmt1.setString(2, Type);
                                pstmt1.setString(3, bedCategoryCmbx.getSelectedItem().toString());
                                pstmt1.setString(4, paymentModeCmbx.getSelectedItem().toString());
                                pstmt1.setString(5, "" + transNo + "");
                                if (paymentModeCmbx.getSelectedItem().equals("Cash")) {
                                    pstmt1.setString(6, "");
                                    pstmt1.setString(7, "");
                                    pstmt1.setString(8, "");
                                    pstmt1.setString(9, "");
                                    pstmt1.setDate(10, com.afrisoftech.lib.SQLDateFormat.getSQLDate(admissionDatePicker.getDate()));
                                    pstmt1.setString(15, patientAcc);
                                    pstmt1.setString(18, "");
                                    // pstmt1.setString(22,AccDesc);
                                } else {
                                    if (schemePanel.isVisible()) {
                                        //  if(jComboBox5.getSelectedItem().toString().equalsIgnoreCase(jTextField6.getText())){

                                        pstmt1.setString(6, "");
                                        pstmt1.setString(8, "");
                                        pstmt1.setString(7, schemeNameTxt.getText());
                                        pstmt1.setString(9, schemeMangerTxt.getText());
                                        pstmt1.setDate(10, com.afrisoftech.lib.SQLDateFormat.getSQLDate(cardExpiryDatePicker.getDate()));
                                        pstmt1.setString(15, insAcc);
                                        pstmt1.setString(18, memberNumberTxt.getText());

                                    } else {
                                        pstmt1.setString(6, cardNumberTxt.getText());
                                        pstmt1.setString(7, "");
                                        pstmt1.setString(8, cardNameCmbx.getSelectedItem().toString());
                                        pstmt1.setString(9, cardIssurerTxt.getText());
                                        pstmt1.setDate(10, com.afrisoftech.lib.SQLDateFormat.getSQLDate(schemeExpiryDatePicker.getDate()));
                                        pstmt1.setString(15, cardAcc);
                                        pstmt1.setString(18, "");
                                        //  pstmt1.setString(22,cardName);
                                    }
                                }
                                pstmt1.setString(11, admittedByTxt.getText());
                                pstmt1.setDouble(12, adrate);
                                pstmt1.setDouble(13, 0.00);
                                pstmt1.setDate(14, com.afrisoftech.lib.SQLDateFormat.getSQLDate(admissionDatePicker.getDate()));
                                pstmt1.setString(16, Main);
                                pstmt1.setDouble(17, 1);
                                pstmt1.setBoolean(19, false);
                                pstmt1.setString(20, "Billing");
                                pstmt1.setBoolean(21, true);
                                pstmt1.setString(22, AccDesc);
                                pstmt1.setString(23, visitid);
                                pstmt1.setString(24, user);
                                pstmt1.setString(25, billNo);
                                pstmt1.setString(26, "IP");
                                pstmt1.setTimestamp(27, new java.sql.Timestamp(java.util.Calendar.getInstance().getTimeInMillis()));
                                pstmt1.setString(28, visitid);
                                pstmt1.executeUpdate();

// Ledger entry for nursing fees at the point of admission. This is done on ac_ledger table
                                if (chargeNursing) {
                                    java.sql.PreparedStatement pstmt2n = connectDB.prepareStatement("insert into ac_ledger values(?,?,?,?,?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?,?,?,?)");
                                    pstmt2n.setString(1, adcode);
                                    //                                pstmt2n.setString(2, Type);
                                    pstmt2n.setString(2, "Nursing/Professional Fees");
                                    pstmt2n.setString(3, admissionNumberTxt.getText());
                                    pstmt2n.setString(4, surNameTxt.getText());
                                    pstmt2n.setString(5, "");
                                    pstmt2n.setString(6, "");
                                    pstmt2n.setString(7, "");
                                    pstmt2n.setString(8, "IP");
                                    pstmt2n.setString(9, "");
                                    pstmt2n.setString(10, paymentModeCmbx.getSelectedItem().toString());
                                    pstmt2n.setString(11, "");
                                    pstmt2n.setString(12, "");
                                    pstmt2n.setString(13, "");
                                    pstmt2n.setString(14, "Nursing/Professional Fees");
                                    pstmt2n.setString(15, "Revenue");
                                    pstmt2n.setDouble(16, 0.00);
                                    pstmt2n.setDouble(17, nursing);
                                    pstmt2n.setDate(18, com.afrisoftech.lib.SQLDateFormat.getSQLDate(admissionDatePicker.getDate()));
                                    pstmt2n.setString(19, "" + transNo + "");
                                    pstmt2n.setBoolean(20, false);
                                    pstmt2n.setBoolean(21, false);
                                    pstmt2n.setBoolean(22, false);
                                    pstmt2n.setString(23, user);
                                    pstmt2n.executeUpdate();

// Bill admission nursing/professional fees at the point of admission (This is done on the patient bill - hp_patient_card table
                                    java.sql.PreparedStatement pstmt1m = connectDB.prepareStatement("insert into hp_patient_card values(?,?,?,?,?,?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?,?,?,?,?,?,?,?)");
                                    pstmt1m.setString(1, admissionNumberTxt.getText());
                                    pstmt1m.setString(2, "Nursing/Professional Fees");
                                    pstmt1m.setString(3, bedCategoryCmbx.getSelectedItem().toString());
                                    pstmt1m.setString(4, paymentModeCmbx.getSelectedItem().toString());
                                    pstmt1m.setString(5, "" + transNo + "");
                                    if (paymentModeCmbx.getSelectedItem().equals("Cash")) {
                                        pstmt1m.setString(6, "");
                                        pstmt1m.setString(7, "");
                                        pstmt1m.setString(8, "");
                                        pstmt1m.setString(9, "");
                                        pstmt1m.setDate(10, com.afrisoftech.lib.SQLDateFormat.getSQLDate(admissionDatePicker.getDate()));
                                        pstmt1m.setString(15, patientAcc);
                                        pstmt1m.setString(18, "");
                                        // pstmt1.setString(22,AccDesc);
                                    } else {
                                        if (schemePanel.isVisible()) {
                                            //  if(jComboBox5.getSelectedItem().toString().equalsIgnoreCase(jTextField6.getText())){

                                            pstmt1m.setString(6, "");
                                            pstmt1m.setString(8, "");
                                            pstmt1m.setString(7, schemeNameTxt.getText());
                                            pstmt1m.setString(9, schemeMangerTxt.getText());
                                            pstmt1m.setDate(10, com.afrisoftech.lib.SQLDateFormat.getSQLDate(cardExpiryDatePicker.getDate()));
                                            pstmt1m.setString(15, insAcc);
                                            pstmt1m.setString(18, memberNumberTxt.getText());

                                        } else {
                                            pstmt1m.setString(6, cardNumberTxt.getText());
                                            pstmt1m.setString(7, "");
                                            pstmt1m.setString(8, cardNameCmbx.getSelectedItem().toString());
                                            pstmt1m.setString(9, cardIssurerTxt.getText());
                                            pstmt1m.setDate(10, com.afrisoftech.lib.SQLDateFormat.getSQLDate(schemeExpiryDatePicker.getDate()));
                                            pstmt1m.setString(15, cardAcc);
                                            pstmt1m.setString(18, "");
                                            //  pstmt1.setString(22,cardName);
                                        }
                                    }
                                    pstmt1m.setString(11, admittedByTxt.getText());
                                    pstmt1m.setDouble(12, nursing);
                                    pstmt1m.setDouble(13, 0.00);
                                    pstmt1m.setDate(14, com.afrisoftech.lib.SQLDateFormat.getSQLDate(admissionDatePicker.getDate()));
                                    pstmt1m.setString(16, Main);
                                    pstmt1m.setDouble(17, 1);
                                    pstmt1m.setBoolean(19, false);
                                    pstmt1m.setString(20, "Billing");
                                    pstmt1m.setBoolean(21, true);
                                    pstmt1m.setString(22, AccDesc);
                                    pstmt1m.setString(23, visitid);
                                    pstmt1m.setString(24, user);
                                    pstmt1m.setString(25, billNo);
                                    pstmt1m.setString(26, "IP");
                                    pstmt1m.setTimestamp(27, new java.sql.Timestamp(java.util.Calendar.getInstance().getTimeInMillis()));
                                    pstmt1m.setString(28, visitid);
                                    pstmt1m.executeUpdate();
                                }
// Ledger entry for bed fees at the point of admission. This is done on ac_ledger table
                                if (chargeBed) {
                                    java.sql.PreparedStatement pstmt2bed = connectDB.prepareStatement("insert into ac_ledger values(?,?,?,?,?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?,?,?,?)");
                                    pstmt2bed.setString(1, adcode);
                                    //                                pstmt2n.setString(2, Type);
                                    pstmt2bed.setString(2, "Bed Fees");
                                    pstmt2bed.setString(3, admissionNumberTxt.getText());
                                    pstmt2bed.setString(4, surNameTxt.getText());
                                    pstmt2bed.setString(5, "");
                                    pstmt2bed.setString(6, "");
                                    pstmt2bed.setString(7, "");
                                    pstmt2bed.setString(8, "IP");
                                    pstmt2bed.setString(9, "");
                                    pstmt2bed.setString(10, paymentModeCmbx.getSelectedItem().toString());
                                    pstmt2bed.setString(11, "");
                                    pstmt2bed.setString(12, "");
                                    pstmt2bed.setString(13, "");
                                    pstmt2bed.setString(14, "Bed Fees");
                                    pstmt2bed.setString(15, "Revenue");
                                    pstmt2bed.setDouble(16, 0.00);
                                    pstmt2bed.setDouble(17, bedfees);
                                    pstmt2bed.setDate(18, com.afrisoftech.lib.SQLDateFormat.getSQLDate(admissionDatePicker.getDate()));
                                    pstmt2bed.setString(19, "" + transNo + "");
                                    pstmt2bed.setBoolean(20, false);
                                    pstmt2bed.setBoolean(21, false);
                                    pstmt2bed.setBoolean(22, false);
                                    pstmt2bed.setString(23, user);
                                    pstmt2bed.executeUpdate();

// Bill admission bed fees at the point of admission (This is done on the patient bill - hp_patient_card table
                                    java.sql.PreparedStatement pstmt1bedhp = connectDB.prepareStatement("insert into hp_patient_card values(?,?,?,?,?,?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?,?,?,?,?,?,?,?)");
                                    pstmt1bedhp.setString(1, admissionNumberTxt.getText());
                                    pstmt1bedhp.setString(2, "Bed Fees");
                                    pstmt1bedhp.setString(3, bedCategoryCmbx.getSelectedItem().toString());
                                    pstmt1bedhp.setString(4, paymentModeCmbx.getSelectedItem().toString());
                                    pstmt1bedhp.setString(5, "" + transNo + "");
                                    if (paymentModeCmbx.getSelectedItem().equals("Cash")) {
                                        pstmt1bedhp.setString(6, "");
                                        pstmt1bedhp.setString(7, "");
                                        pstmt1bedhp.setString(8, "");
                                        pstmt1bedhp.setString(9, "");
                                        pstmt1bedhp.setDate(10, com.afrisoftech.lib.SQLDateFormat.getSQLDate(admissionDatePicker.getDate()));
                                        pstmt1bedhp.setString(15, patientAcc);
                                        pstmt1bedhp.setString(18, "");
                                        // pstmt1.setString(22,AccDesc);
                                    } else {
                                        if (schemePanel.isVisible()) {
                                            //  if(jComboBox5.getSelectedItem().toString().equalsIgnoreCase(jTextField6.getText())){

                                            pstmt1bedhp.setString(6, "");
                                            pstmt1bedhp.setString(8, "");
                                            pstmt1bedhp.setString(7, schemeNameTxt.getText());
                                            pstmt1bedhp.setString(9, schemeMangerTxt.getText());
                                            pstmt1bedhp.setDate(10, com.afrisoftech.lib.SQLDateFormat.getSQLDate(cardExpiryDatePicker.getDate()));
                                            pstmt1bedhp.setString(15, insAcc);
                                            pstmt1bedhp.setString(18, memberNumberTxt.getText());

                                        } else {
                                            pstmt1bedhp.setString(6, cardNumberTxt.getText());
                                            pstmt1bedhp.setString(7, "");
                                            pstmt1bedhp.setString(8, cardNameCmbx.getSelectedItem().toString());
                                            pstmt1bedhp.setString(9, cardIssurerTxt.getText());
                                            pstmt1bedhp.setDate(10, com.afrisoftech.lib.SQLDateFormat.getSQLDate(schemeExpiryDatePicker.getDate()));
                                            pstmt1bedhp.setString(15, cardAcc);
                                            pstmt1bedhp.setString(18, "");
                                            //  pstmt1.setString(22,cardName);
                                        }
                                    }
                                    pstmt1bedhp.setString(11, admittedByTxt.getText());
                                    pstmt1bedhp.setDouble(12, bedfees);
                                    pstmt1bedhp.setDouble(13, 0.00);
                                    pstmt1bedhp.setDate(14, com.afrisoftech.lib.SQLDateFormat.getSQLDate(admissionDatePicker.getDate()));
                                    pstmt1bedhp.setString(16, Main);
                                    pstmt1bedhp.setDouble(17, 1);
                                    pstmt1bedhp.setBoolean(19, false);
                                    pstmt1bedhp.setString(20, "Billing");
                                    pstmt1bedhp.setBoolean(21, true);
                                    pstmt1bedhp.setString(22, AccDesc);
                                    pstmt1bedhp.setString(23, visitid);
                                    pstmt1bedhp.setString(24, user);
                                    pstmt1bedhp.setString(25, billNo);
                                    pstmt1bedhp.setString(26, "IP");
                                    pstmt1bedhp.setTimestamp(27, new java.sql.Timestamp(java.util.Calendar.getInstance().getTimeInMillis()));
                                    pstmt1bedhp.setString(28, visitid);
                                    pstmt1bedhp.executeUpdate();

                                }

                                java.sql.PreparedStatement pstmt31 = connectDB.prepareStatement("UPDATE hp_inpatient_register SET iplimit = " + Limit + "  WHERE patient_no = '" + admissionNumberTxt.getText() + "'");
                                pstmt31.executeUpdate();
                                if (mergeOPBillChkbx.isSelected()) {
                                    if (opdNoTxt.getText().toString().equalsIgnoreCase("") | opdNoTxt.getText().toString().equalsIgnoreCase(" ") | opdNoTxt.getText().toString().equalsIgnoreCase("  ")) {
                                        javax.swing.JOptionPane.showMessageDialog(this, "You Must select patient details from out patient", "Comfirmation Message", javax.swing.JOptionPane.INFORMATION_MESSAGE);

                                    } else {

                                        java.sql.PreparedStatement pstmt221 = connectDB.prepareStatement("UPDATE hp_patient_billing set paid = 'true' WHERE patient_no = '" + opdNoTxt.getText() + "' AND trans_date ='" + admissionDatePicker.getDate() + "'");
                                        pstmt221.executeUpdate();

                                        java.sql.PreparedStatement pstmt2221 = connectDB.prepareStatement("UPDATE ac_ledger set patient_no = '" + admissionNumberTxt.getText() + "' WHERE patient_no = '" + opdNoTxt.getText() + "' AND date ='" + admissionDatePicker.getDate() + "'");
                                        pstmt2221.executeUpdate();

                                        java.sql.PreparedStatement pstmt2223 = connectDB.prepareStatement("UPDATE ac_cash_collection set patient_no = '" + admissionNumberTxt.getText() + "' WHERE patient_no = '" + opdNoTxt.getText() + "' AND date ='" + admissionDatePicker.getDate() + "'");
                                        pstmt2223.executeUpdate();

                                        java.sql.PreparedStatement pstmt2224 = connectDB.prepareStatement("UPDATE ac_doctors_ledger set patient_no = '" + admissionNumberTxt.getText() + "' WHERE patient_no = '" + opdNoTxt.getText() + "' AND input_date ='" + admissionDatePicker.getDate() + "'");
                                        pstmt2224.executeUpdate();

                                        java.sql.PreparedStatement pstmt221111 = connectDB.prepareStatement("UPDATE hp_pharmacy set patient_no = '" + admissionNumberTxt.getText() + "' WHERE patient_no = '" + opdNoTxt.getText() + "' AND date_prescribed ='" + admissionDatePicker.getDate() + "'");
                                        pstmt221111.executeUpdate();

                                        java.sql.PreparedStatement pstmtz = connectDB.prepareStatement("UPDATE hp_patient_card set visit_id = '" + visitid + "',patient_no = '" + admissionNumberTxt.getText() + "' WHERE patient_no = '" + opdNoTxt.getText() + "' AND date::date ='" + admissionDatePicker.getDate() + "'");
                                        pstmtz.executeUpdate();
                                    }
                                }
                                java.sql.Statement pss1 = connectDB.createStatement();
                                java.sql.ResultSet rss1 = pss1.executeQuery("select patient_no from hp_inpatient_register ORDER BY OID desc LIMIT 1");
                                while (rss1.next()) {
                                    // patientsNo = rss1.getObject(1).toString();
                                    //       jTextField24.setText(rss1.getObject(1).toString());
                                }

                                javax.swing.JOptionPane.showMessageDialog(this, "Admission record successful, Patient Number : [" + admissionNumberTxt.getText() + "] with Name : [" + firstNameTxt.getText() + " " + surNameTxt.getText() + "]", "Comfirmation Message", javax.swing.JOptionPane.INFORMATION_MESSAGE);

                            }
                        }
                        connectDB.commit();
                        connectDB.setAutoCommit(true);
                        referredcombo.setSelectedItem("-");
                        postalAddressTxt.setText("");
                        nokTelephoneTxt.setText("");
                        nokNameTxt.setText("");
                        wardCodeTxt.setText("");
                        surNameTxt.setText("");
//                        referredFromTxt.setText("");
                        currentResidence.setText("");
                        billPayerTxt.setText("");
                        schemeNameTxt.setText("");
                        schemeMangerTxt.setText("");
                        memberNameTxt.setText("");
                        nhifClaimNumberTxt.setText("");
                        cSheetNoTxt.setText("");
                        countyofResidenceCmbx.setSelectedItem(null);
                        countyofBirthCmbx.setSelectedItem(null);
                        educationLevelCmbx.setSelectedItem(null);
                        clinicFileNumberTxt.setText("");
                        employerTxt.setText("");
                        employerTelTxt.setText("");
                        this.admitBtn.setEnabled(false);
                        this.admitPrintBtn.setEnabled(false);
                    }
                }
                // connectDB.releaseSavepoint(registerSavePoint);
                admitBtn.setText("Admit");

            } catch (java.lang.Exception sq) {

                try {
                    connectDB.rollback(registerSavePoint);
                } catch (java.sql.SQLException sql) {
                    sql.printStackTrace();
                    javax.swing.JOptionPane.showMessageDialog(this, sql.getMessage(), "Error Message!", javax.swing.JOptionPane.ERROR_MESSAGE);
                }
                sq.printStackTrace();
                System.out.println(sq.getMessage());
                javax.swing.JOptionPane.showMessageDialog(this, sq.getMessage(), "Error", javax.swing.JOptionPane.ERROR_MESSAGE);

            }

        } catch (java.lang.Exception ex) {
            ex.printStackTrace();
            System.out.println(ex.getMessage());
            javax.swing.JOptionPane.showMessageDialog(this, "TRANSACTION ERROR : Please double check your entries. \n DETAILS : " + ex.toString(), "Error", javax.swing.JOptionPane.ERROR_MESSAGE);

        }

    }

    private void adminPrint() {
        int countAdmissions = 0;
        try {
            java.sql.PreparedStatement pstmtCheckAdmissionStatus = connectDB.prepareStatement("SELECT count(*) FROM hp_admission WHERE patient_no = ? AND sub_chief = ? AND check_out = false");
            pstmtCheckAdmissionStatus.setString(1, admissionNumberTxt.getText());
            pstmtCheckAdmissionStatus.setString(2, unitNumberTxt.getText());
            java.sql.ResultSet rsetCheckAdmissionStatus = pstmtCheckAdmissionStatus.executeQuery();
            while (rsetCheckAdmissionStatus.next()) {
                countAdmissions = rsetCheckAdmissionStatus.getInt(1);
            }
        } catch (SQLException ex) {
            ex.printStackTrace();
            javax.swing.JOptionPane.showMessageDialog(this, ex.getMessage());
            Logger
                    .getLogger(AdmissionIntfr.class
                            .getName()).log(Level.SEVERE, null, ex);
        }
        if (countAdmissions == 0) {
            String yrs = null;
            java.util.Date periodFrom = null;
            java.util.Date periodTo = null;

            String dateOfBirth = null;
            String name = null;
            String activity = null;
            String actNo = null;
            String billNo = null;
            String rate = null;
            String transNo = null;
            String patientAcc = null;
            String insAcc = null;
            String cardAcc = null;
            String AccDesc = null;
            String cardName = null;
            String insName = null;
            String user = null;
            String adcode = null;
            double adrate = 0.00;
            double nursing = 0.00;
            double bedfees = 0.00;
            String Type = null;
            String Typet = null;
            String Main = null;
            double Limit = 0.0;
            int unitNo = 0;
            String Categ = null;
            String visitid = null;
            String patientNo = null;
            String selectedchkbx = null;
            String selectedStatus = null;
            boolean manualNo = false;
            String preFix = null;
            int digitNo = 0;
            String yrEnd = null;
            boolean incYr = false;
            String patientsNo = null;
            String patientsNo2 = com.afrisoftech.lib.DateLables.getDateLabel();
            String useoneNumber = null;
            double ageYrs = 0.00;
            boolean chargeNursing = false;
            boolean chargeBed = false;
            boolean nhifStatus;

            try {

                // Date parser
                java.text.SimpleDateFormat dateFormat = new java.text.SimpleDateFormat("EEE MMM dd HH:mm:ss zzz yy");
                com.afrisoftech.lib.DateFormatter dateFormatter = new com.afrisoftech.lib.DateFormatter(dateFormat.parse(admissionDatePicker.getDate().toString().trim()), "yy");

                java.lang.String monthString = dateFormatter.getDateString();

                yrs = monthString;

                // Catch java.text.parse exception.
            } catch (java.text.ParseException prs) {
                prs.printStackTrace();
            }
            java.sql.Savepoint registerSavePoint = null;
            try {

                //            try {
                connectDB.setAutoCommit(false);
                registerSavePoint = connectDB.setSavepoint("registration");

                java.sql.Statement stmtf = connectDB.createStatement();
                java.sql.ResultSet rsetf = stmtf.executeQuery("SELECT period_from,period_to FROM period_setup WHERE period_status ilike 'Open' AND '" + admissionDatePicker.getDate() + "' BETWEEN period_from AND period_to");
                while (rsetf.next()) {
                    periodFrom = rsetf.getDate(1);
                    periodTo = rsetf.getDate(2);
                }
                java.sql.Statement stmtfs = connectDB.createStatement();
                java.sql.ResultSet rsetfs = stmtfs.executeQuery("SELECT '" + datePickerYOB.getDate() + "'::DATE ");
                while (rsetfs.next()) {
                    dateOfBirth = rsetfs.getString(1);

                }

                if (admissionDatePicker.getDate().before(periodFrom) || admissionDatePicker.getDate().after(periodTo)) {
                    javax.swing.JOptionPane.showMessageDialog(this, "You cannot save before or after the accounting period set \n Contact head of accounts".toUpperCase(), "Caution Message", javax.swing.JOptionPane.INFORMATION_MESSAGE);

                } else {

                    java.sql.Statement stmnzz = connectDB.createStatement();
                    java.sql.ResultSet rsnzz = stmnzz.executeQuery("select ip_numbering,use_one_number from pb_patient_names");
                    while (rsnzz.next()) {
                        manualNo = rsnzz.getBoolean(1);
                        useoneNumber = rsnzz.getString(2);
                    }
                    if (newAdimissionRbtn.isSelected() && manualNo == true) {
                        manualNo = true;
                    } else {
                        if (createManualNumbersRbtn.isSelected() && manualNo == true) {
                            manualNo = false;
                        } else {
                            manualNo = manualNo;
                        }
                    }

                    if (this.privateCategoryChkbx.isSelected()) {
                        Categ = privateCategoryChkbx.getText();
                    } else {
                        Categ = hospitalCategoryChkbx.getText();
                    }

                    if (this.maleChkbx.isSelected()) {
                        selectedchkbx = maleChkbx.getText();
                    } else {

                        selectedchkbx = femaleChkbx.getText();
                    }

                    if (this.marriedMaritalChkbx.isSelected()) {
                        selectedStatus = marriedMaritalChkbx.getText();
                    } else {
                        if (this.singleMaritalChkbx.isSelected()) {
                            selectedStatus = singleMaritalChkbx.getText();
                        } else {
                            if (this.divorcedMaritalChkbx.isSelected()) {
                                selectedStatus = divorcedMaritalChkbx.getText();
                            } else {
                                if (this.widowedMaritalChkbx.isSelected()) {
                                    selectedStatus = widowedMaritalChkbx.getText();
                                }
                            }
                        }
                    }
                    java.sql.Statement stmnza = connectDB.createStatement();
                    java.sql.ResultSet rsnza = stmnza.executeQuery("select (CURRENT_DATE::DATE - '" + datePickerYOB.getDate() + "'::DATE)/365");
                    while (rsnza.next()) {
                        ageYrs = rsnza.getDouble(1);
                    }
                    if (manualNo == false && admissionNumberTxt.getText().equals("")) {
                        javax.swing.JOptionPane.showMessageDialog(this, "You must enter Patient No.", "Error", javax.swing.JOptionPane.ERROR_MESSAGE);

                    } else {

                        System.out.println(admitPrintBtn.getText());

                        java.sql.PreparedStatement pstmt21 = connectDB.prepareStatement("UPDATE hp_admission SET diagnosed = true WHERE patient_no ilike '" + admissionNumberTxt.getText() + "'");

                        pstmt21.executeUpdate();

                        if (newAdimissionRbtn.isSelected() || createManualNumbersRbtn.isSelected()) {

                            java.sql.Statement stmtx = connectDB.createStatement();
                            java.sql.ResultSet rsetx = stmtx.executeQuery("SELECT count(*) FROM hp_admission WHERE sub_chief ='" + unitNumberTxt.getText() + "'");
                            while (rsetx.next()) {
                                unitNo = rsetx.getInt(1);
                            }

                            java.sql.Statement stmt = connectDB.createStatement();
                            java.sql.ResultSet rset = stmt.executeQuery("SELECT patient_no FROM hp_inpatient_register WHERE patient_no ='" + this.admissionNumberTxt.getText() + "'");
                            while (rset.next()) {
                                patientNo = rset.getObject(1).toString();
                            }

                            java.sql.Statement stmt11 = connectDB.createStatement();

                            java.sql.ResultSet rset11 = stmt11.executeQuery("SELECT patient_no,check_out FROM hp_admission WHERE patient_no ='" + admissionNumberTxt.getText() + "' and check_out = false");
                            while (rset11.next()) {
                                // jComboBox1.setSelectedItem(rset11.getObject(1).toString());
                                name = rset11.getObject(1).toString();
                                if (rset11.getBoolean(2) == false) {
                                    hasInterimBillChkbx.setSelected(true);
                                } else {
                                    hasInterimBillChkbx.setSelected(false);
                                }
                            }

                            if (this.admissionNumberTxt.getText().equalsIgnoreCase(patientNo)) {
                                jLabel33.setForeground(java.awt.Color.red);
                                jLabel33.setText("PATIENT No. Already On File");

                                // javax.swing.JOptionPane.showMessageDialog(this,"PATIENT No. Already Exists", "Error",javax.swing.JOptionPane.ERROR_MESSAGE);
                            } else if (admissionNumberTxt.getText().equalsIgnoreCase(name)) {
                                javax.swing.JOptionPane.showMessageDialog(this, " Patient with patient no '" + name + "' already admitted ", "Error", javax.swing.JOptionPane.ERROR_MESSAGE);

                            } else {

                                if (manualNo) {

                                    patientsNo2 = patientsNo2;

                                } else {

                                    patientsNo = admissionNumberTxt.getText();
                                    patientsNo2 = patientsNo;
                                }
                                java.sql.PreparedStatement pstmt = connectDB.prepareStatement("INSERT INTO hp_inpatient_register(patient_no, first_name, second_name, last_name, nok, residence, address, year_of_birth, tel_no, sex,op_no) VALUES(?, UPPER(?), UPPER(?), ?, ?, ?, ?, ?, ?, ?,?)");
                                pstmt.setString(1, patientsNo2);
                                if (surNameTxt.getText().equals("")) {
                                    javax.swing.JOptionPane.showMessageDialog(this, "You must enter First Name and Second Name", "Error", javax.swing.JOptionPane.ERROR_MESSAGE);
                                } else {
                                    pstmt.setString(2, surNameTxt.getText().toUpperCase());
                                }
                                pstmt.setString(3, firstNameTxt.getText());
                                pstmt.setString(4, "");
                                pstmt.setString(5, nokNameTxt.getText());
                                pstmt.setString(8, dateOfBirth);
                                pstmt.setString(7, postalAddressTxt.getText());
                                if (currentResidence.getText().equals("")) {
                                    javax.swing.JOptionPane.showMessageDialog(this, "You must enter residence", "Error", javax.swing.JOptionPane.ERROR_MESSAGE);
                                } else {
                                    pstmt.setString(6, currentResidence.getText());
                                }

                                pstmt.setString(9, nokTelephoneTxt.getText());
                                if (selectedchkbx == null) {
                                    javax.swing.JOptionPane.showMessageDialog(this, "You must tick patient sex", "Error", javax.swing.JOptionPane.ERROR_MESSAGE);
                                } else {
                                    pstmt.setObject(10, selectedchkbx);
                                }
                                
                                pstmt.setString(11, opdNoTxt.getText());

                                pstmt.executeUpdate();
                                this.admitBtn.setVisible(false);
                                //   javax.swing.JOptionPane.showMessageDialog(this, "Insert Done Successfully","Comfirmation Message",javax.swing.JOptionPane.INFORMATION_MESSAGE);

                            }
                        }

                        if (newAdimissionRbtn.isSelected()) {

                            if (manualNo) {
                                String patNos = null;

                                if (useoneNumber.equalsIgnoreCase("useonenumber")) {
                                    // Checking the presence of out patient number in hp_patient_register
                                    int opNos = 0;
                                    java.sql.Statement stmnz1c = connectDB.createStatement();
                                    java.sql.ResultSet rsnz1c = stmnz1c.executeQuery("SELECT COUNT(patient_no) FROM hp_patient_register WHERE patient_no = '" + opdNoTxt.getText() + "'");
                                    while (rsnz1c.next()) {
                                        opNos = rsnz1c.getInt(1);
                                    }
                                    if (opNos > 0) {
                                        patientNo = opdNoTxt.getText();
                                        admissionNumberTxt.setText(opdNoTxt.getText());
                                    } else {
                                        java.sql.Statement stmnz1 = connectDB.createStatement();
                                        java.sql.ResultSet rsnz1 = stmnz1.executeQuery("select prefix_item,digit_no,yr_end,inc_year from pb_patient_names");
                                        while (rsnz1.next()) {
                                            preFix = rsnz1.getString(1);
                                            digitNo = rsnz1.getInt(2);
                                            yrEnd = rsnz1.getString(3);
                                            incYr = rsnz1.getBoolean(4);
                                        }
                                        if (incYr) {

                                            java.sql.Statement pss1x = connectDB.createStatement();
                                            java.sql.ResultSet rss1x = pss1x.executeQuery("select nextval('outpatient_no_seq')");
                                            while (rss1x.next()) {
                                                patNos = rss1x.getObject(1).toString();
                                            }
                                            if (preFix.equalsIgnoreCase("noPrefix")) {
                                                java.sql.Statement pss1 = connectDB.createStatement();
                                                java.sql.ResultSet rss1 = pss1.executeQuery("select lpad('" + patNos + "'," + digitNo + ",'0')||'/'||'" + yrs + "'");
                                                while (rss1.next()) {
                                                    patientNo = rss1.getObject(1).toString();
                                                    admissionNumberTxt.setText(rss1.getObject(1).toString());

                                                }

                                            } else {
                                                java.sql.Statement pss1 = connectDB.createStatement();
                                                java.sql.ResultSet rss1 = pss1.executeQuery("select '" + preFix + "'||lpad('" + patNos + "'," + digitNo + ",'0')||'/'||'" + yrs + "'");
                                                while (rss1.next()) {
                                                    patientNo = rss1.getObject(1).toString();
                                                    admissionNumberTxt.setText(rss1.getObject(1).toString());
                                                }
                                            }
                                        } else {
                                            java.sql.Statement pss1x = connectDB.createStatement();
                                            java.sql.ResultSet rss1x = pss1x.executeQuery("select nextval('outpatient_no_seq')");
                                            while (rss1x.next()) {
                                                patNos = rss1x.getObject(1).toString();
                                            }
                                            if (preFix.equalsIgnoreCase("noPrefix")) {
                                                java.sql.Statement pss1 = connectDB.createStatement();
                                                java.sql.ResultSet rss1 = pss1.executeQuery("select lpad('" + patNos + "'," + digitNo + ",'0')");
                                                while (rss1.next()) {
                                                    patientNo = rss1.getObject(1).toString();
                                                    admissionNumberTxt.setText(rss1.getObject(1).toString());
                                                }
                                            } else {
                                                java.sql.Statement pss1 = connectDB.createStatement();
                                                java.sql.ResultSet rss1 = pss1.executeQuery("select '" + preFix + "'||lpad('" + patNos + "'," + digitNo + ",'0')");
                                                while (rss1.next()) {
                                                    patientNo = rss1.getObject(1).toString();
                                                    admissionNumberTxt.setText(rss1.getObject(1).toString());
                                                }
                                            }
                                        }
                                    }
                                } else {

                                    java.sql.Statement pss1x = connectDB.createStatement();
                                    java.sql.ResultSet rss1x = pss1x.executeQuery("select nextval('inpatient_no_seq')");
                                    while (rss1x.next()) {
                                        patNos = rss1x.getObject(1).toString();
                                    }
                                    java.sql.Statement stmnz1 = connectDB.createStatement();
                                    java.sql.ResultSet rsnz1 = stmnz1.executeQuery("select ip_prefix,ip_digit,ip_yr from pb_patient_names");
                                    while (rsnz1.next()) {
                                        preFix = rsnz1.getString(1);
                                        digitNo = rsnz1.getInt(2);
                                        incYr = rsnz1.getBoolean(3);
                                    }
                                    if (incYr) {

                                        if (preFix.equalsIgnoreCase("noIP")) {

                                            java.sql.Statement pss1 = connectDB.createStatement();
                                            java.sql.ResultSet rss1 = pss1.executeQuery("select lpad('" + patNos + "'," + digitNo + ",'0')||'/'||'" + yrs + "'");
                                            while (rss1.next()) {
                                                patientsNo = rss1.getObject(1).toString();
                                                admissionNumberTxt.setText(rss1.getObject(1).toString());
                                            }

                                        } else {
                                            java.sql.Statement pss1 = connectDB.createStatement();
                                            java.sql.ResultSet rss1 = pss1.executeQuery("select '" + preFix + "'||lpad('" + patNos + "'," + digitNo + ",'0')||'/'||'" + yrs + "'");
                                            while (rss1.next()) {
                                                patientsNo = rss1.getObject(1).toString();
                                                admissionNumberTxt.setText(rss1.getObject(1).toString());
                                            }
                                        }
                                    } else {
                                        if (preFix.equalsIgnoreCase("noiP")) {
                                            java.sql.Statement pss1 = connectDB.createStatement();
                                            java.sql.ResultSet rss1 = pss1.executeQuery("select lpad('" + patNos + "'," + digitNo + ",'0')");
                                            while (rss1.next()) {
                                                patientsNo = rss1.getObject(1).toString();
                                                admissionNumberTxt.setText(rss1.getObject(1).toString());
                                            }
                                        } else {
                                            java.sql.Statement pss1 = connectDB.createStatement();
                                            java.sql.ResultSet rss1 = pss1.executeQuery("select '" + preFix + "'||lpad('" + patNos + "'," + digitNo + ",'0')");
                                            while (rss1.next()) {
                                                patientsNo = rss1.getObject(1).toString();
                                                admissionNumberTxt.setText(rss1.getObject(1).toString());
                                            }
                                        }
                                    }

                                }
                                java.sql.PreparedStatement pstmt11 = connectDB.prepareStatement("UPDATE hp_inpatient_register SET patient_no = '" + admissionNumberTxt.getText() + "'  WHERE patient_no = '" + patientsNo2 + "'");
                                pstmt11.executeUpdate();
                                java.sql.PreparedStatement pstmt11z = connectDB.prepareStatement("UPDATE hp_admission SET patient_no = '" + admissionNumberTxt.getText() + "',admission_no = '" + admissionNumberTxt.getText() + "'  WHERE patient_no = '" + patientsNo2 + "'");
                                pstmt11z.executeUpdate();
                            }

                        }
                        if (admissionNumberTxt.getText().equalsIgnoreCase(name)) {
                            javax.swing.JOptionPane.showMessageDialog(this, " Patient with with patient no '" + name + "' already admitted ", "Error", javax.swing.JOptionPane.ERROR_MESSAGE);

                        } else {
                            java.sql.Statement stmtD = connectDB.createStatement();
                            java.sql.ResultSet rsetD = stmtD.executeQuery("select rate,gl_account,service_type,main_service from pb_operating_parameters where category ='AF'");
                            while (rsetD.next()) {

                                // adrate = rsetD.getDouble(1);
                                //   adcode = rsetD.getObject(2).toString();
                                Type = rsetD.getObject(3).toString();
                                //   Main = rsetD.getObject(4).toString();
                            }

                            java.sql.Statement stmtDt = connectDB.createStatement();
                            java.sql.ResultSet rsetDt = stmtDt.executeQuery("select rate,gl_account,service_type,main_service from pb_operating_parameters where category ='NF'");
                            while (rsetDt.next()) {

                                // adrate = rsetD.getDouble(1);
                                //   adcode = rsetD.getObject(2).toString();
                                Typet = rsetDt.getObject(3).toString();
                                //   Main = rsetD.getObject(4).toString();
                            }

                            java.sql.Statement stmtDq = connectDB.createStatement();
                            java.sql.ResultSet rsetDq = stmtDq.executeQuery("select admission_revdesc, admission_revcode from hp_wards where ward_name = '" + admissionWardCmbx.getSelectedItem() + "'");
                            while (rsetDq.next()) {

                                //   adrate = rsetD.getDouble(1);
                                adcode = rsetDq.getObject(2).toString();
                                //    Type = rsetD.getObject(3).toString();
                                Main = rsetDq.getObject(1).toString();
                            }

                            java.sql.Statement stm1 = connectDB.createStatement();
                            java.sql.ResultSet rse1 = stm1.executeQuery("select code,activity,user from pb_activity where activity_category ='PR'");
                            while (rse1.next()) {

                                patientAcc = rse1.getObject(1).toString();
                                AccDesc = rse1.getObject(2).toString();
                            }

                            java.sql.Statement stm1d = connectDB.createStatement();
                            java.sql.ResultSet rse1d = stm1d.executeQuery("select current_user");
                            while (rse1d.next()) {

                                user = rse1d.getObject(1).toString();
                            }

                            java.sql.Statement stm1l = connectDB.createStatement();
                            java.sql.ResultSet rse1l = stm1l.executeQuery("select amount from pb_iplimit");
                            while (rse1l.next()) {

                                Limit = rse1l.getDouble(1);

                            }
                            java.sql.Statement stm1lx = connectDB.createStatement();
                            java.sql.ResultSet rse1lx = stm1lx.executeQuery("select nursing,adm_rate, rate,charge_nfee,charge_bfee from hp_bed_category WHERE category ilike '" + bedCategoryCmbx.getSelectedItem() + "'");
                            while (rse1lx.next()) {

                                adrate = rse1lx.getDouble(2);
                                nursing = rse1lx.getDouble(1);
                                bedfees = rse1lx.getDouble(3);
                                chargeNursing = rse1lx.getBoolean(4);
                                chargeBed = rse1lx.getBoolean(5);
                            }
                            java.sql.Statement stm2 = connectDB.createStatement();
                            java.sql.ResultSet rse2 = stm2.executeQuery("select code,activity from pb_activity where activity_category ='PR'");
                            while (rse2.next()) {

                                insAcc = rse2.getObject(1).toString();
                                insName = rse2.getObject(2).toString();
                            }
                            // if(jCheckBox1.isSelected()||jCheckBox2.isSelected()){

                            java.sql.Statement stmt1 = connectDB.createStatement();
                            java.sql.ResultSet rset1 = stmt1.executeQuery("select nextval('billing_no_seq')");
                            while (rset1.next()) {
                                billNo = rset1.getObject(1).toString();
                            }
                            java.sql.Statement stmt3 = connectDB.createStatement();
                            java.sql.ResultSet rset3 = stmt3.executeQuery("select nextval('transaction_no_seq')");
                            while (rset3.next()) {
                                transNo = rset3.getObject(1).toString();
                            }
                            java.sql.Statement stmtq = connectDB.createStatement();
                            java.sql.ResultSet rsetq = stmtq.executeQuery("select nextval('ipvisit_id')");
                            while (rsetq.next()) {
                                visitid = rsetq.getObject(1).toString();
                            }

                            java.sql.PreparedStatement pstmt27 = connectDB.prepareStatement("update hp_bed_setup set occupied = true where bed_no ='" + bedNumberCmbx.getSelectedItem() + "' and ward = '" + admissionWardCmbx.getSelectedItem() + "'");
                            pstmt27.execute();

                            java.sql.PreparedStatement pstmt11 = connectDB.prepareStatement("UPDATE hp_inpatient_register set pay_mode = '" + paymentModeCmbx.getSelectedItem().toString() + "',category = '" + bedCategoryCmbx.getSelectedItem().toString() + "',adm_date = '" + com.afrisoftech.lib.SQLDateFormat.getSQLDate(admissionDatePicker.getDate()) + "',payer = '" + billPayerTxt.getText() + "'  WHERE patient_no = '" + admissionNumberTxt.getText() + "'");
                            pstmt11.executeUpdate();

                            //  java.sql.PreparedStatement pstmt81x = connectDB.prepareStatement("UPDATE hp_patient_card SET invoice_no = '"+visitid+"', visit_id = '"+visitid+"' where patient_no = '"+jTextField12.getText()+"' and visit_id = 'Booking'");
                            //  pstmt81x.executeUpdate();
                            java.sql.PreparedStatement pstmt811x = connectDB.prepareStatement("UPDATE hp_patient_card SET visit_id = '" + visitid + "' where patient_no = '" + admissionNumberTxt.getText() + "' and service ilike 'Receip%' AND invoice_no not ilike 'I%' and date::date BETWEEN (current_date - 200) AND CURRENT_DATE and (visit_id = '' or visit_id = '-')");
                            pstmt811x.executeUpdate();

                            if (schemePanel.isVisible()) {
                                java.sql.PreparedStatement pstmt111 = connectDB.prepareStatement("UPDATE hp_inpatient_register set description = '" + schemeNameTxt.getText() + "',payer = '" + schemeMangerTxt.getText() + "',account_no ='" + memberNumberTxt.getText() + "',expiry_date = '" + com.afrisoftech.lib.SQLDateFormat.getSQLDate(cardExpiryDatePicker.getDate()) + "', member_no = '" + memberNumberTxt.getText() + "',member_name = '" + memberNameTxt.getText() + "' WHERE patient_no = '" + admissionNumberTxt.getText() + "'");
                                pstmt111.executeUpdate();
                            } else {
                                if (bankCardsPanel.isVisible()) {
                                    java.sql.PreparedStatement pstmta = connectDB.prepareStatement("UPDATE hp_inpatient_register set description = '" + cardNameCmbx.getSelectedItem().toString() + "',payer = '" + cardIssurerTxt.getText() + "',account_no ='" + cardNumberTxt.getText() + "',expiry_date = '" + com.afrisoftech.lib.SQLDateFormat.getSQLDate(schemeExpiryDatePicker.getDate()) + "' WHERE patient_no = '" + admissionNumberTxt.getText() + "'");

                                    pstmta.executeUpdate();
                                }

                            }

// Entry of admission information into the hp_admission table
                            java.sql.PreparedStatement pstmt = connectDB.prepareStatement("INSERT INTO hp_admission VALUES(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)");

                            pstmt.setString(1, admissionNumberTxt.getText());

                            pstmt.setString(2, firstNameTxt.getText().toUpperCase() + " " + surNameTxt.getText().toUpperCase());
                            pstmt.setString(3, diagnosisTextPane.getText());
                            if (admissionWardCmbx.getSelectedItem() == null) {
                                javax.swing.JOptionPane.showMessageDialog(this, "You must Select Ward Name", "Error", javax.swing.JOptionPane.ERROR_MESSAGE);
                            } else {

                                pstmt.setString(5, admissionWardCmbx.getSelectedItem().toString());
                            }
                            if (paymentModeCmbx.getSelectedItem().toString().equalsIgnoreCase("Scheme")) {
                                pstmt.setString(4, schemeNameTxt.getText());
                            } else {
                                pstmt.setString(4, "Self");
                            }
                            pstmt.setString(6, bedNumberCmbx.getSelectedItem().toString());
                            pstmt.setString(7, admittedByTxt.getText().toString());
                            pstmt.setString(8, bedCategoryCmbx.getSelectedItem().toString());
                            pstmt.setString(9, nokNameTxt.getText());
                            pstmt.setString(10, nokTelephoneTxt.getText());
                            pstmt.setString(11, postalAddressTxt.getText());
                            pstmt.setString(12, idPassportTxt.getText());
                            pstmt.setString(13, paymentModeCmbx.getSelectedItem().toString());
                            pstmt.setString(14, Categ);
                            pstmt.setDouble(15, java.lang.Double.valueOf(bedRateTxt.getText()));
                            pstmt.setString(16, referredcombo.getSelectedItem().toString());
                            pstmt.setString(17, nationalityCmbx.getSelectedItem().toString());
                            pstmt.setBoolean(18, false);
                            pstmt.setString(19, currentResidence.getText());
                            pstmt.setString(20, "");
                            pstmt.setString(21, nhifChbx.getText());
                            pstmt.setDate(22, com.afrisoftech.lib.SQLDateFormat.getSQLDate(admissionDatePicker.getDate()));

                            pstmt.setString(23, admissionNumberTxt.getText());

                            pstmt.setString(24, user);
                            pstmt.setString(25, null);
                            pstmt.setString(26, null);
                            pstmt.setString(27, visitid);
                            pstmt.setDouble(28, 0.00);
                            pstmt.setString(29, "");
                            pstmt.setDouble(30, nursing);
                            pstmt.setBoolean(31, false);
                            pstmt.setString(32, "");
                            pstmt.setString(33, clinicFileNumberTxt.getText());
                            pstmt.setObject(34, registrationPointCmbx.getSelectedItem());
                            pstmt.setObject(35, patientUrgencyCMBX.getSelectedItem());
                            pstmt.setDouble(36, ageYrs);
                            pstmt.setObject(37, selectedchkbx);
                            pstmt.setObject(38, selectedStatus);
                            pstmt.setString(39, "Admitted");
                            if (newAdimissionRbtn.isSelected()) {
                                pstmt.setString(40, "First Admission ");
                            } else {
                                pstmt.setString(40, "Re Admission ");
                            }
                            pstmt.setObject(41, specialtyClinicCmbx.getSelectedItem());
                            pstmt.setObject(42, occupationCmbx.getSelectedItem());
                            pstmt.setBoolean(43, false);
                            pstmt.setObject(44, religionCmbx.getSelectedItem());
                            pstmt.setObject(45, this.districtCmbx.getSelectedItem());
                            pstmt.setObject(46, this.locationTxt.getText());
                            pstmt.setObject(47, this.nokteltxt.getText());
                            pstmt.setObject(48, this.unitNumberTxt.getText());
                            pstmt.setObject(49, this.nokResidenceTxt.getText());
                            pstmt.setObject(50, this.nokRelationShipCmbx.getSelectedItem());
                            pstmt.setBoolean(51, false);
                            pstmt.setString(52, null);
                            if (nhifChbx.isSelected()) {
                                nhifStatus = true;
                            } else {
                                nhifStatus = false;
                            }
                            pstmt.setBoolean(53, nhifStatus);
                            pstmt.setObject(54, countyofBirthCmbx.getSelectedItem());
                            pstmt.setObject(55, countyofResidenceCmbx.getSelectedItem());
                            pstmt.setObject(56, educationLevelCmbx.getSelectedItem());
                            pstmt.setString(57, cSheetNoTxt.getText());

                            pstmt.executeUpdate();

// Ledger entry for admission fees at the point of registration. (This is done on ac_ledger)                                
                            java.sql.PreparedStatement pstmt2 = connectDB.prepareStatement("insert into ac_ledger values(?,?,?,?,?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?,?,?,?)");
                            pstmt2.setString(1, com.afrisoftech.lib.WardGLAccountsFactory.getAdmissionChargesGLAccount(connectDB, admissionWardCmbx.getSelectedItem().toString()));
                            pstmt2.setString(2, com.afrisoftech.lib.GLCodesFactory.getActivityDescription(connectDB, com.afrisoftech.lib.WardGLAccountsFactory.getAdmissionChargesGLAccount(connectDB, admissionWardCmbx.getSelectedItem().toString())));
                            pstmt2.setString(3, admissionNumberTxt.getText());
                            pstmt2.setString(4, surNameTxt.getText());
                            pstmt2.setString(5, "");
                            pstmt2.setString(6, "");
                            pstmt2.setString(7, "");
                            pstmt2.setString(8, "IP");
                            pstmt2.setString(9, "");
                            pstmt2.setString(10, paymentModeCmbx.getSelectedItem().toString());
                            pstmt2.setString(11, "");
                            pstmt2.setString(12, "");
                            pstmt2.setString(13, "");
                            pstmt2.setString(14, Type);
                            pstmt2.setString(15, "Revenue");
                            pstmt2.setDouble(16, 0.00);
                            pstmt2.setDouble(17, adrate);
                            pstmt2.setDate(18, com.afrisoftech.lib.SQLDateFormat.getSQLDate(admissionDatePicker.getDate()));
                            pstmt2.setString(19, "" + transNo + "");
                            pstmt2.setBoolean(20, false);
                            pstmt2.setBoolean(21, false);
                            pstmt2.setBoolean(22, false);
                            pstmt2.setString(23, user);
                            pstmt2.executeUpdate();

// Billing for admission fee at the point of admission.
                            java.sql.PreparedStatement pstmt1 = connectDB.prepareStatement("insert into hp_patient_card values(?,?,?,?,?,?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?,?,?,?,?,?,?,?)");
                            pstmt1.setString(1, admissionNumberTxt.getText());
                            pstmt1.setString(2, Type);
                            pstmt1.setString(3, bedCategoryCmbx.getSelectedItem().toString());
                            pstmt1.setString(4, paymentModeCmbx.getSelectedItem().toString());
                            pstmt1.setString(5, "" + transNo + "");
                            if (paymentModeCmbx.getSelectedItem().equals("Cash")) {
                                pstmt1.setString(6, "");
                                pstmt1.setString(7, "");
                                pstmt1.setString(8, "");
                                pstmt1.setString(9, "");
                                pstmt1.setDate(10, com.afrisoftech.lib.SQLDateFormat.getSQLDate(admissionDatePicker.getDate()));
                                pstmt1.setString(15, patientAcc);
                                pstmt1.setString(18, "");
                                // pstmt1.setString(22,AccDesc);
                            } else {
                                if (schemePanel.isVisible()) {
                                    //  if(jComboBox5.getSelectedItem().toString().equalsIgnoreCase(jTextField6.getText())){

                                    pstmt1.setString(6, "");
                                    pstmt1.setString(8, "");
                                    pstmt1.setString(7, schemeNameTxt.getText());
                                    pstmt1.setString(9, schemeMangerTxt.getText());
                                    pstmt1.setDate(10, com.afrisoftech.lib.SQLDateFormat.getSQLDate(cardExpiryDatePicker.getDate()));
                                    pstmt1.setString(15, insAcc);
                                    pstmt1.setString(18, memberNumberTxt.getText());

                                } else {
                                    pstmt1.setString(6, cardNumberTxt.getText());
                                    pstmt1.setString(7, "");
                                    pstmt1.setString(8, cardNameCmbx.getSelectedItem().toString());
                                    pstmt1.setString(9, cardIssurerTxt.getText());
                                    pstmt1.setDate(10, com.afrisoftech.lib.SQLDateFormat.getSQLDate(schemeExpiryDatePicker.getDate()));
                                    pstmt1.setString(15, cardAcc);
                                    pstmt1.setString(18, "");
                                    //  pstmt1.setString(22,cardName);
                                }
                            }
                            pstmt1.setString(11, admittedByTxt.getText());
                            pstmt1.setDouble(12, adrate);
                            pstmt1.setDouble(13, 0.00);
                            pstmt1.setDate(14, com.afrisoftech.lib.SQLDateFormat.getSQLDate(admissionDatePicker.getDate()));
                            pstmt1.setString(16, com.afrisoftech.lib.GLCodesFactory.getActivityDescription(connectDB, com.afrisoftech.lib.WardGLAccountsFactory.getAdmissionChargesGLAccount(connectDB, admissionWardCmbx.getSelectedItem().toString())));
                            pstmt1.setDouble(17, 1);
                            pstmt1.setBoolean(19, false);
                            pstmt1.setString(20, "Billing");
                            pstmt1.setBoolean(21, true);
                            pstmt1.setString(22, AccDesc);
                            pstmt1.setString(23, visitid);
                            pstmt1.setString(24, user);
                            pstmt1.setString(25, billNo);
                            pstmt1.setString(26, "IP");
                            pstmt1.setTimestamp(27, new java.sql.Timestamp(java.util.Calendar.getInstance().getTimeInMillis()));
                            pstmt1.setString(28, visitid);
                            pstmt1.executeUpdate();

// Ledger entry for nursing fees at the point of admission. This is done on ac_ledger table
                            if (chargeNursing) {
                                java.sql.PreparedStatement pstmt2n = connectDB.prepareStatement("insert into ac_ledger values(?,?,?,?,?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?,?,?,?)");
                                pstmt2n.setString(1, com.afrisoftech.lib.WardGLAccountsFactory.getNursingChargesGLAccount(connectDB, admissionWardCmbx.getSelectedItem().toString()));
                                pstmt2n.setString(2, com.afrisoftech.lib.GLCodesFactory.getActivityDescription(connectDB, com.afrisoftech.lib.WardGLAccountsFactory.getNursingChargesGLAccount(connectDB, admissionWardCmbx.getSelectedItem().toString())));
                                pstmt2n.setString(3, admissionNumberTxt.getText());
                                pstmt2n.setString(4, surNameTxt.getText());
                                pstmt2n.setString(5, "");
                                pstmt2n.setString(6, "");
                                pstmt2n.setString(7, "");
                                pstmt2n.setString(8, "IP");
                                pstmt2n.setString(9, "");
                                pstmt2n.setString(10, paymentModeCmbx.getSelectedItem().toString());
                                pstmt2n.setString(11, "");
                                pstmt2n.setString(12, "");
                                pstmt2n.setString(13, "");
                                pstmt2n.setString(14, "Nursing/Professional Fees");
                                pstmt2n.setString(15, "Revenue");
                                pstmt2n.setDouble(16, 0.00);
                                pstmt2n.setDouble(17, nursing);
                                pstmt2n.setDate(18, com.afrisoftech.lib.SQLDateFormat.getSQLDate(admissionDatePicker.getDate()));
                                pstmt2n.setString(19, "" + transNo + "");
                                pstmt2n.setBoolean(20, false);
                                pstmt2n.setBoolean(21, false);
                                pstmt2n.setBoolean(22, false);
                                pstmt2n.setString(23, user);
                                pstmt2n.executeUpdate();

// Bill admission nursing/professional fees at the point of admission (This is done on the patient bill - hp_patient_card table
                                java.sql.PreparedStatement pstmt1m = connectDB.prepareStatement("insert into hp_patient_card values(?,?,?,?,?,?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?,?,?,?,?,?,?,?)");
                                pstmt1m.setString(1, admissionNumberTxt.getText());
                                pstmt1m.setString(2, "Nursing/Professional Fees");
                                pstmt1m.setString(3, bedCategoryCmbx.getSelectedItem().toString());
                                pstmt1m.setString(4, paymentModeCmbx.getSelectedItem().toString());
                                pstmt1m.setString(5, "" + transNo + "");
                                if (paymentModeCmbx.getSelectedItem().equals("Cash")) {
                                    pstmt1m.setString(6, "");
                                    pstmt1m.setString(7, "");
                                    pstmt1m.setString(8, "");
                                    pstmt1m.setString(9, "");
                                    pstmt1m.setDate(10, com.afrisoftech.lib.SQLDateFormat.getSQLDate(admissionDatePicker.getDate()));
                                    pstmt1m.setString(15, patientAcc);
                                    pstmt1m.setString(18, "");
                                    // pstmt1.setString(22,AccDesc);
                                } else {
                                    if (schemePanel.isVisible()) {
                                        //  if(jComboBox5.getSelectedItem().toString().equalsIgnoreCase(jTextField6.getText())){

                                        pstmt1m.setString(6, "");
                                        pstmt1m.setString(8, "");
                                        pstmt1m.setString(7, schemeNameTxt.getText());
                                        pstmt1m.setString(9, schemeMangerTxt.getText());
                                        pstmt1m.setDate(10, com.afrisoftech.lib.SQLDateFormat.getSQLDate(cardExpiryDatePicker.getDate()));
                                        pstmt1m.setString(15, insAcc);
                                        pstmt1m.setString(18, memberNumberTxt.getText());

                                    } else {
                                        pstmt1m.setString(6, cardNumberTxt.getText());
                                        pstmt1m.setString(7, "");
                                        pstmt1m.setString(8, cardNameCmbx.getSelectedItem().toString());
                                        pstmt1m.setString(9, cardIssurerTxt.getText());
                                        pstmt1m.setDate(10, com.afrisoftech.lib.SQLDateFormat.getSQLDate(schemeExpiryDatePicker.getDate()));
                                        pstmt1m.setString(15, cardAcc);
                                        pstmt1m.setString(18, "");
                                        //  pstmt1.setString(22,cardName);
                                    }
                                }
                                pstmt1m.setString(11, admittedByTxt.getText());
                                pstmt1m.setDouble(12, nursing);
                                pstmt1m.setDouble(13, 0.00);
                                pstmt1m.setDate(14, com.afrisoftech.lib.SQLDateFormat.getSQLDate(admissionDatePicker.getDate()));
                                pstmt1m.setString(16, com.afrisoftech.lib.GLCodesFactory.getActivityDescription(connectDB, com.afrisoftech.lib.WardGLAccountsFactory.getNursingChargesGLAccount(connectDB, admissionWardCmbx.getSelectedItem().toString())));
                                pstmt1m.setDouble(17, 1);
                                pstmt1m.setBoolean(19, false);
                                pstmt1m.setString(20, "Billing");
                                pstmt1m.setBoolean(21, true);
                                pstmt1m.setString(22, AccDesc);
                                pstmt1m.setString(23, visitid);
                                pstmt1m.setString(24, user);
                                pstmt1m.setString(25, billNo);
                                pstmt1m.setString(26, "IP");
                                pstmt1m.setTimestamp(27, new java.sql.Timestamp(java.util.Calendar.getInstance().getTimeInMillis()));
                                pstmt1m.setString(28, visitid);
                                pstmt1m.executeUpdate();
                            }
// Ledger entry for bed fees at the point of admission. This is done on ac_ledger table
                            if (chargeBed) {
                                java.sql.PreparedStatement pstmt2bed = connectDB.prepareStatement("insert into ac_ledger values(?,?,?,?,?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?,?,?,?)");
                                pstmt2bed.setString(1, com.afrisoftech.lib.WardGLAccountsFactory.getBedChargesGLAccount(connectDB, admissionWardCmbx.getSelectedItem().toString()));
                                //                                pstmt2n.setString(2, Type);
                                pstmt2bed.setString(2, com.afrisoftech.lib.GLCodesFactory.getActivityDescription(connectDB, com.afrisoftech.lib.WardGLAccountsFactory.getBedChargesGLAccount(connectDB, admissionWardCmbx.getSelectedItem().toString())));
                                pstmt2bed.setString(3, admissionNumberTxt.getText());
                                pstmt2bed.setString(4, surNameTxt.getText());
                                pstmt2bed.setString(5, "");
                                pstmt2bed.setString(6, "");
                                pstmt2bed.setString(7, "");
                                pstmt2bed.setString(8, "IP");
                                pstmt2bed.setString(9, "");
                                pstmt2bed.setString(10, paymentModeCmbx.getSelectedItem().toString());
                                pstmt2bed.setString(11, "");
                                pstmt2bed.setString(12, "");
                                pstmt2bed.setString(13, "");
                                pstmt2bed.setString(14, "Daily Bed Fees");
                                pstmt2bed.setString(15, "Revenue");
                                pstmt2bed.setDouble(16, 0.00);
                                pstmt2bed.setDouble(17, bedfees);
                                pstmt2bed.setDate(18, com.afrisoftech.lib.SQLDateFormat.getSQLDate(admissionDatePicker.getDate()));
                                pstmt2bed.setString(19, "" + transNo + "");
                                pstmt2bed.setBoolean(20, false);
                                pstmt2bed.setBoolean(21, false);
                                pstmt2bed.setBoolean(22, false);
                                pstmt2bed.setString(23, user);
                                pstmt2bed.executeUpdate();

// Bill admission bed fees at the point of admission (This is done on the patient bill - hp_patient_card table
                                java.sql.PreparedStatement pstmt1bedhp = connectDB.prepareStatement("insert into hp_patient_card values(?,?,?,?,?,?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?,?,?,?,?,?,?,?)");
                                pstmt1bedhp.setString(1, admissionNumberTxt.getText());
                                pstmt1bedhp.setString(2, "Bed Fees");
                                pstmt1bedhp.setString(3, bedCategoryCmbx.getSelectedItem().toString());
                                pstmt1bedhp.setString(4, paymentModeCmbx.getSelectedItem().toString());
                                pstmt1bedhp.setString(5, "" + transNo + "");
                                if (paymentModeCmbx.getSelectedItem().equals("Cash")) {
                                    pstmt1bedhp.setString(6, "");
                                    pstmt1bedhp.setString(7, "");
                                    pstmt1bedhp.setString(8, "");
                                    pstmt1bedhp.setString(9, "");
                                    pstmt1bedhp.setDate(10, com.afrisoftech.lib.SQLDateFormat.getSQLDate(admissionDatePicker.getDate()));
                                    pstmt1bedhp.setString(15, patientAcc);
                                    pstmt1bedhp.setString(18, "");
                                    // pstmt1.setString(22,AccDesc);
                                } else {
                                    if (schemePanel.isVisible()) {
                                        //  if(jComboBox5.getSelectedItem().toString().equalsIgnoreCase(jTextField6.getText())){

                                        pstmt1bedhp.setString(6, "");
                                        pstmt1bedhp.setString(8, "");
                                        pstmt1bedhp.setString(7, schemeNameTxt.getText());
                                        pstmt1bedhp.setString(9, schemeMangerTxt.getText());
                                        pstmt1bedhp.setDate(10, com.afrisoftech.lib.SQLDateFormat.getSQLDate(cardExpiryDatePicker.getDate()));
                                        pstmt1bedhp.setString(15, insAcc);
                                        pstmt1bedhp.setString(18, memberNumberTxt.getText());

                                    } else {
                                        pstmt1bedhp.setString(6, cardNumberTxt.getText());
                                        pstmt1bedhp.setString(7, "");
                                        pstmt1bedhp.setString(8, cardNameCmbx.getSelectedItem().toString());
                                        pstmt1bedhp.setString(9, cardIssurerTxt.getText());
                                        pstmt1bedhp.setDate(10, com.afrisoftech.lib.SQLDateFormat.getSQLDate(schemeExpiryDatePicker.getDate()));
                                        pstmt1bedhp.setString(15, cardAcc);
                                        pstmt1bedhp.setString(18, "");
                                        //  pstmt1.setString(22,cardName);
                                    }
                                }
                                pstmt1bedhp.setString(11, admittedByTxt.getText());
                                pstmt1bedhp.setDouble(12, bedfees);
                                pstmt1bedhp.setDouble(13, 0.00);
                                pstmt1bedhp.setDate(14, com.afrisoftech.lib.SQLDateFormat.getSQLDate(admissionDatePicker.getDate()));
                                pstmt1bedhp.setString(16, com.afrisoftech.lib.GLCodesFactory.getActivityDescription(connectDB, com.afrisoftech.lib.WardGLAccountsFactory.getBedChargesGLAccount(connectDB, admissionWardCmbx.getSelectedItem().toString())));
                                pstmt1bedhp.setDouble(17, 1);
                                pstmt1bedhp.setBoolean(19, false);
                                pstmt1bedhp.setString(20, "Billing");
                                pstmt1bedhp.setBoolean(21, true);
                                pstmt1bedhp.setString(22, AccDesc);
                                pstmt1bedhp.setString(23, visitid);
                                pstmt1bedhp.setString(24, user);
                                pstmt1bedhp.setString(25, billNo);
                                pstmt1bedhp.setString(26, "IP");
                                pstmt1bedhp.setTimestamp(27, new java.sql.Timestamp(java.util.Calendar.getInstance().getTimeInMillis()));
                                pstmt1bedhp.setString(28, visitid);
                                pstmt1bedhp.executeUpdate();

                            }

                            java.sql.PreparedStatement pstmt31 = connectDB.prepareStatement("UPDATE hp_inpatient_register SET iplimit = " + Limit + "  WHERE patient_no = '" + admissionNumberTxt.getText() + "'");
                            pstmt31.executeUpdate();
                            if (mergeOPBillChkbx.isSelected()) {
                                if (opdNoTxt.getText().toString().equalsIgnoreCase("") | opdNoTxt.getText().toString().equalsIgnoreCase(" ") | opdNoTxt.getText().toString().equalsIgnoreCase("  ")) {
                                    javax.swing.JOptionPane.showMessageDialog(this, "You Must select patient details from out patient", "Comfirmation Message", javax.swing.JOptionPane.INFORMATION_MESSAGE);

                                } else {

                                    java.sql.PreparedStatement pstmt221 = connectDB.prepareStatement("UPDATE hp_patient_billing set paid = 'true' WHERE patient_no = '" + opdNoTxt.getText() + "' AND trans_date ='" + admissionDatePicker.getDate() + "'");
                                    pstmt221.executeUpdate();

                                    java.sql.PreparedStatement pstmt2221 = connectDB.prepareStatement("UPDATE ac_ledger set patient_no = '" + admissionNumberTxt.getText() + "' WHERE patient_no = '" + opdNoTxt.getText() + "' AND date ='" + admissionDatePicker.getDate() + "'");
                                    pstmt2221.executeUpdate();

                                    java.sql.PreparedStatement pstmt2223 = connectDB.prepareStatement("UPDATE ac_cash_collection set patient_no = '" + admissionNumberTxt.getText() + "' WHERE patient_no = '" + opdNoTxt.getText() + "' AND date ='" + admissionDatePicker.getDate() + "'");
                                    pstmt2223.executeUpdate();

                                    java.sql.PreparedStatement pstmt2224 = connectDB.prepareStatement("UPDATE ac_doctors_ledger set patient_no = '" + admissionNumberTxt.getText() + "' WHERE patient_no = '" + opdNoTxt.getText() + "' AND input_date ='" + admissionDatePicker.getDate() + "'");
                                    pstmt2224.executeUpdate();

                                    java.sql.PreparedStatement pstmt221111 = connectDB.prepareStatement("UPDATE hp_pharmacy set patient_no = '" + admissionNumberTxt.getText() + "' WHERE patient_no = '" + opdNoTxt.getText() + "' AND date_prescribed ='" + admissionDatePicker.getDate() + "'");
                                    pstmt221111.executeUpdate();

                                    java.sql.PreparedStatement pstmtz = connectDB.prepareStatement("UPDATE hp_patient_card set visit_id = '" + visitid + "',patient_no = '" + admissionNumberTxt.getText() + "' WHERE patient_no = '" + opdNoTxt.getText() + "' AND date::date ='" + admissionDatePicker.getDate() + "'");
                                    pstmtz.executeUpdate();
                                }
                            }
                            java.sql.Statement pss1 = connectDB.createStatement();
                            java.sql.ResultSet rss1 = pss1.executeQuery("select patient_no from hp_inpatient_register ORDER BY OID desc LIMIT 1");
                            while (rss1.next()) {
                                // patientsNo = rss1.getObject(1).toString();
                                //     jTextField24.setText(rss1.getObject(1).toString());
                            }

                            javax.swing.JOptionPane.showMessageDialog(this, "Insert Done Successfully", "Comfirmation Message", javax.swing.JOptionPane.INFORMATION_MESSAGE);

                        }

                        connectDB.commit();
                        connectDB.setAutoCommit(true);

                    }
                }

                String nhifStatusTxt = null;

                if (nhifChbx.isSelected()) {
                    nhifStatusTxt = "YES";
                } else {
                    nhifStatusTxt = "NO";
                }

                String interviewer = null;
                java.sql.PreparedStatement pstmt = connectDB.prepareStatement("SELECT current_user");
                java.sql.ResultSet rset = pstmt.executeQuery();
                while (rset.next()) {
                    interviewer = rset.getString(1);
                }

                String receiptNo = null, amt = null;

                try {
                    java.sql.Statement stmt11 = connectDB.createStatement();
                    java.sql.ResultSet rset11 = stmt11.executeQuery("SELECT  description,receipt_no, debit  FROM ac_cash_collection where  patient_no='" + admissionNumberTxt.getText() + "' and receipt_time::date >= current_date-1 ");
                    while (rset11.next()) {
                        receiptNo = rset11.getObject(2).toString();
                        amt = rset11.getObject(3).toString();

                    }

                } catch (SQLException ex) {
                    Logger.getLogger(PatientRegisterIntfr.class
                            .getName()).log(Level.SEVERE, null, ex);
                    javax.swing.JOptionPane.showMessageDialog(this, ex.getMessage());
                }
                String selectgender = null;
                if (this.maleChkbx.isSelected()) {
                    selectgender = maleChkbx.getText();
                } else {

                    selectgender = femaleChkbx.getText();
                }
                java.sql.PreparedStatement pstmtDisability = connectDB.prepareStatement("UPDATE hp_patient_register SET patient_disability = ? WHERE patient_no = ?");
                pstmtDisability.setObject(1, this.patientDisabilityCmbx.getSelectedItem());
                pstmtDisability.setObject(2, this.admissionNumberTxt.getText());
                pstmtDisability.executeUpdate();

                com.afrisoftech.reports.PatientRegFormPdf.connectDB = connectDB;
                com.afrisoftech.reports.PatientRegFormPdf regForm = new com.afrisoftech.reports.PatientRegFormPdf();
                regForm.callPdf(connectDB, admissionNumberTxt.getText(), "IP");
//                                                                           
//                    regForm.generatePdf(firstNameTxt.getText().toUpperCase() + " " + surNameTxt.getText().toUpperCase(),
//                            agelabel.getText(), selectedStatus, nationalityCmbx.getSelectedItem().toString(),
//                            idPassportTxt.getText(), districtCmbx.getSelectedItem().toString(), occupationCmbx.getSelectedItem().toString(), selectedStatus,
//                            religionCmbx.getSelectedItem().toString(), nokTelephoneTxt.getText(), " ", currentResidence.getText(), locationTxt.getText(), countyofBirthCmbx.getSelectedItem().toString(),
//                            countyofResidenceCmbx.getSelectedItem().toString(), nokNameTxt.getText(), nokRelationShipCmbx.getSelectedItem().toString(), nokTelephoneTxt.getText(), referredFromTxt.getText(), " ",
//                            specialtyClinicCmbx.getSelectedItem().toString(), nhifStatusTxt, nhifClaimNumberTxt.getText(),
//                            educationLevelCmbx.getSelectedItem().toString(), employerTelTxt.getText(), employerTxt.getText(), amt, receiptNo, cSheetNoTxt.getText(), " ",
//                            interviewer, com.afrisoftech.lib.ServerTime.serverTimeStamp(connectDB), jComboBox2.getSelectedItem().toString(),
//                            unitNumberTxt.getText(), admissionNumber.getText(), admissionWardCmbx.getSelectedItem().toString(),
//                            com.afrisoftech.lib.ServerTime.serverTimeStamp(connectDB), bedCategoryCmbx.getSelectedItem().toString(), nhifClaimNumberTxt.getText(), datePicker1.getDate(), selectgender,
//                            "", "", "", "", "", "", "", "", "", "");

                admitBtn.setText("Admit");

            } catch (java.sql.SQLException sq) {
                sq.printStackTrace();
                try {
                    connectDB.rollback(registerSavePoint);
                } catch (java.sql.SQLException sql) {
                    sql.printStackTrace();
                    javax.swing.JOptionPane.showMessageDialog(this, sql.getMessage(), "Error Message!", javax.swing.JOptionPane.ERROR_MESSAGE);
                }
                sq.printStackTrace();
                System.out.println(sq.getMessage());
                javax.swing.JOptionPane.showMessageDialog(this, sq.getMessage(), "Error", javax.swing.JOptionPane.ERROR_MESSAGE);

            }

            this.admitBtn.setVisible(true);

//        }catch (java.lang.Exception ex) {
//                ex.printStackTrace();
//                System.out.println(ex.getMessage());
//                javax.swing.JOptionPane.showMessageDialog(this, "TRANSACTION ERROR : Please double check your entries. \n DETAILS : " + ex.toString(), "Error", javax.swing.JOptionPane.ERROR_MESSAGE);
//
//            }
        } else {
            javax.swing.JOptionPane.showMessageDialog(this, "Patient is already admitted! You CANNOT have multiple admissions for a patient.", "Error", javax.swing.JOptionPane.ERROR_MESSAGE);

        }

    }

    private void resetFields() {

        this.admitPrintBtn.setEnabled(true);
        this.admitBtn.setVisible(true);
        this.admitBtn.setText("Admit");
        admitPrintBtn.setText("Admit & Print");
        referredcombo.setSelectedItem("-");
        postalAddressTxt.setText("");
        nokTelephoneTxt.setText("");
        nokNameTxt.setText("");
        firstNameTxt.setText("");
        wardCodeTxt.setText("");
        surNameTxt.setText("");
        //jTextField6.setText("");
        admissionNumberTxt.setText("");
        memberNumberTxt.setText("");
        currentResidence.setText("");
        billPayerTxt.setText("");
        schemeNameTxt.setText("");
        opdNoTxt.setText("");
        schemeMangerTxt.setText("");
        memberNameTxt.setText("");
        opdSearchButton.setEnabled(true);
        searchButton.setEnabled(true);
//        searchbyPatientNameChkbx.setEnabled(true);
//        searchbyPatientNumberChkbx.setEnabled(true);
        dischargedChkbx.setEnabled(false);
        admittedChbx.setEnabled(false);
//        referredFromTxt.setEditable(true);
        postalAddressTxt.setEditable(true);
        nokTelephoneTxt.setEditable(true);
        nokNameTxt.setEditable(true);
        firstNameTxt.setEditable(true);
        surNameTxt.setEditable(true);
        //jTextField6.setEditable(true);
        admissionNumberTxt.setEditable(true);
        memberNumberTxt.setEditable(true);
        currentResidence.setEditable(true);
        billPayerTxt.setEditable(true);
        schemeNameTxt.setEditable(true);
        opdNoTxt.setEditable(false);
        schemeMangerTxt.setEditable(true);
        memberNameTxt.setEditable(true);
        String useonenumber = null;
        religionCmbx.setSelectedIndex(-1);
        nationalityCmbx.setSelectedIndex(-1);
        districtCmbx.setSelectedIndex(-1);
        occupationCmbx.setSelectedIndex(-1);
        admissionWardCmbx.setSelectedIndex(-1);
        bedNumberCmbx.setSelectedIndex(-1);
        bedCategoryCmbx.setSelectedIndex(-1);
        specialtyClinicCmbx.setSelectedIndex(-1);
        nokRelationShipCmbx.setSelectedIndex(-1);
        countyofBirthCmbx.setSelectedIndex(-1);
        educationLevelCmbx.setSelectedIndex(-1);
        paymentModeCmbx.setSelectedItem("-");
        countyofResidenceCmbx.setSelectedIndex(-1);
        buttonGroup4.clearSelection();
        try {

            java.text.DateFormat df = java.text.DateFormat.getDateInstance();

            java.text.SimpleDateFormat sdf = (java.text.SimpleDateFormat) df;

            sdf.applyPattern("yyyy-MM-dd");
            java.sql.Statement stmtx2 = connectDB.createStatement();
            java.sql.ResultSet rsetx2 = stmtx2.executeQuery("SELECT CURRENT_DATE::DATE");
            try {
                while (rsetx2.next()) {
                    admissionDatePicker.setDate(sdf.parse(rsetx2.getObject(1).toString()));
                }
            } catch (java.text.ParseException pe) {
                javax.swing.JOptionPane.showMessageDialog(this, pe.getMessage());
            }
            java.sql.Statement stmtx = connectDB.createStatement();
            java.sql.ResultSet rsetx = stmtx.executeQuery("select ip_numbering,use_one_number from pb_patient_names");
            while (rsetx.next()) {
                autonumber = rsetx.getBoolean(1);
                useonenumber = rsetx.getString(2);
                java.sql.Statement pss1 = connectDB.createStatement();
                java.sql.ResultSet rss1 = pss1.executeQuery("select patient_no from hp_inpatient_register ORDER BY OID desc LIMIT 1");
                while (rss1.next()) {
                    // patientsNo = rss1.getObject(1).toString();
                    //   jTextField24.setText(rss1.getObject(1).toString());
                }
            }
            rsetx.close();
            stmtx.close();
            if (autonumber) {
                admissionNumberTxt.setEditable(false);

            } else {
                admissionNumberTxt.setEditable(true);
            }

        } catch (java.sql.SQLException sqe) {
            sqe.printStackTrace();
            System.out.println("selection not successful");
            javax.swing.JOptionPane.showMessageDialog(this, sqe.getMessage());
        }
    }
}
