/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */

package com.afrisoftech.hr;
import com.afrisoftech.laundry.*;
import java.awt.Color;
import java.sql.*;
import java.text.SimpleDateFormat;
import java.util.logging.Level;
import java.util.logging.Logger;
import java.util.Date;
import javax.swing.JLabel;
import javax.swing.JOptionPane;
import javax.swing.table.DefaultTableCellRenderer;
import javax.swing.table.TableColumn;


/**
 *
 * @author charlie
 */
public class DutySetup extends javax.swing.JInternalFrame {
    com.afrisoftech.lib.DBObject dbObject;
    java.sql.Connection connectDB = null;
    org.netbeans.lib.sql.pool.PooledConnectionSource pConnDB = null;
    
    
    private Object[][] batch;
    String[][] dutyid;
    String currFunction="new";
    java.lang.String userLoggedIn = null;
    
    /**
     * Creates new form MachineSetup
     */
    public DutySetup(java.sql.Connection connDb, org.netbeans.lib.sql.pool.PooledConnectionSource pconnDB) {
        dbObject = new com.afrisoftech.lib.DBObject();
        connectDB = connDb;
        pConnDB = pconnDB;
        
        initComponents();
        populateCmbox();
        populateTable();
        
        
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {
        java.awt.GridBagConstraints gridBagConstraints;

        newDutiesMainPanel = new javax.swing.JPanel();
        newDutiesPanel = new javax.swing.JPanel();
        dutyDescripLbl = new javax.swing.JLabel();
        dutyCodeTxt = new javax.swing.JTextField();
        dutyCodeLbl = new javax.swing.JLabel();
        dutySaveBtn = new javax.swing.JButton();
        dutyDescripScrollPane = new javax.swing.JScrollPane();
        dutyDescripTxa = new javax.swing.JTextArea();
        dutyClearBtn = new javax.swing.JButton();
        currentDutiesMainPanel = new javax.swing.JPanel();
        currentDutiesPanel = new javax.swing.JPanel();
        currentDutiesScrollPane = new javax.swing.JScrollPane();
        currentDutiesTable = new com.afrisoftech.dbadmin.JTable();
        dutyEditBtn = new javax.swing.JButton();
        dutyRemoveBtn = new javax.swing.JButton();
        comboxPanel = new javax.swing.JPanel();
        divisionCmbx = new javax.swing.JComboBox();
        departmentCmbx = new javax.swing.JComboBox();
        sectionCmbx = new javax.swing.JComboBox();

        setClosable(true);
        setIconifiable(true);
        setMaximizable(true);
        setResizable(true);
        setTitle("Duties Setup");
        setPreferredSize(new java.awt.Dimension(500, 600));
        setVisible(true);
        getContentPane().setLayout(new java.awt.GridBagLayout());

        newDutiesMainPanel.setBorder(javax.swing.BorderFactory.createTitledBorder(""));
        newDutiesMainPanel.setMaximumSize(new java.awt.Dimension(2147483647, 2147483647));
        newDutiesMainPanel.setMinimumSize(new java.awt.Dimension(140, 60));
        newDutiesMainPanel.setPreferredSize(new java.awt.Dimension(51, 39));
        newDutiesMainPanel.setLayout(new java.awt.GridBagLayout());

        newDutiesPanel.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "New Duty", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 0, 11), new java.awt.Color(0, 51, 255))); // NOI18N
        newDutiesPanel.setLayout(new java.awt.GridBagLayout());

        dutyDescripLbl.setText("Description");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.ipadx = 15;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 0.2;
        gridBagConstraints.insets = new java.awt.Insets(0, 10, 0, 10);
        newDutiesPanel.add(dutyDescripLbl, gridBagConstraints);

        dutyCodeTxt.setColumns(5);
        dutyCodeTxt.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                dutyCodeTxtActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.gridwidth = 2;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.ipadx = 15;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 0.2;
        gridBagConstraints.insets = new java.awt.Insets(0, 10, 0, 10);
        newDutiesPanel.add(dutyCodeTxt, gridBagConstraints);

        dutyCodeLbl.setText("Duty Code");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.ipadx = 15;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 0.2;
        gridBagConstraints.insets = new java.awt.Insets(0, 10, 0, 10);
        newDutiesPanel.add(dutyCodeLbl, gridBagConstraints);

        dutySaveBtn.setText("Save");
        dutySaveBtn.setPreferredSize(new java.awt.Dimension(71, 23));
        dutySaveBtn.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                dutySaveBtnActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 4;
        gridBagConstraints.ipadx = 15;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 0.2;
        gridBagConstraints.insets = new java.awt.Insets(0, 10, 0, 10);
        newDutiesPanel.add(dutySaveBtn, gridBagConstraints);

        dutyDescripTxa.setColumns(20);
        dutyDescripTxa.setLineWrap(true);
        dutyDescripTxa.setRows(5);
        dutyDescripTxa.setWrapStyleWord(true);
        dutyDescripScrollPane.setViewportView(dutyDescripTxa);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.gridwidth = 2;
        gridBagConstraints.gridheight = 2;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.ipadx = 15;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 0.2;
        gridBagConstraints.insets = new java.awt.Insets(0, 10, 0, 10);
        newDutiesPanel.add(dutyDescripScrollPane, gridBagConstraints);

        dutyClearBtn.setText("Clear");
        dutyClearBtn.setPreferredSize(new java.awt.Dimension(71, 23));
        dutyClearBtn.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                dutyClearBtnActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 4;
        gridBagConstraints.ipadx = 15;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 0.2;
        gridBagConstraints.insets = new java.awt.Insets(0, 10, 0, 10);
        newDutiesPanel.add(dutyClearBtn, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        newDutiesMainPanel.add(newDutiesPanel, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.gridwidth = 4;
        gridBagConstraints.gridheight = 5;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.ipadx = 15;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 10.0;
        getContentPane().add(newDutiesMainPanel, gridBagConstraints);

        currentDutiesMainPanel.setBorder(javax.swing.BorderFactory.createTitledBorder(""));
        currentDutiesMainPanel.setMaximumSize(new java.awt.Dimension(2147483647, 2147483647));
        currentDutiesMainPanel.setMinimumSize(new java.awt.Dimension(140, 60));
        currentDutiesMainPanel.setPreferredSize(new java.awt.Dimension(51, 39));
        currentDutiesMainPanel.setLayout(new java.awt.GridBagLayout());

        currentDutiesPanel.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Current Duties", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 0, 11), new java.awt.Color(51, 51, 255))); // NOI18N
        currentDutiesPanel.setLayout(new java.awt.GridBagLayout());

        currentDutiesTable.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null},
                {null},
                {null},
                {null}
            },
            new String [] {
                "Title 1"
            }
        ));
        currentDutiesTable.setTableHeader(null);
        currentDutiesTable.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                currentDutiesTableMouseClicked(evt);
            }
        });
        currentDutiesTable.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusLost(java.awt.event.FocusEvent evt) {
                currentDutiesTableFocusLost(evt);
            }
        });
        currentDutiesScrollPane.setViewportView(currentDutiesTable);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.gridwidth = 2;
        gridBagConstraints.gridheight = 5;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 5.0;
        currentDutiesPanel.add(currentDutiesScrollPane, gridBagConstraints);

        dutyEditBtn.setText("Edit");
        dutyEditBtn.setEnabled(false);
        dutyEditBtn.setMaximumSize(new java.awt.Dimension(100, 23));
        dutyEditBtn.setMinimumSize(new java.awt.Dimension(71, 23));
        dutyEditBtn.setPreferredSize(new java.awt.Dimension(100, 23));
        dutyEditBtn.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                dutyEditBtnActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 6;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(0, 10, 0, 10);
        currentDutiesPanel.add(dutyEditBtn, gridBagConstraints);

        dutyRemoveBtn.setText("Remove");
        dutyRemoveBtn.setMaximumSize(new java.awt.Dimension(100, 23));
        dutyRemoveBtn.setPreferredSize(new java.awt.Dimension(100, 23));
        dutyRemoveBtn.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                dutyRemoveBtnActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 6;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(0, 10, 0, 10);
        currentDutiesPanel.add(dutyRemoveBtn, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        currentDutiesMainPanel.add(currentDutiesPanel, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 4;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.gridheight = 5;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.ipadx = 15;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 10.0;
        getContentPane().add(currentDutiesMainPanel, gridBagConstraints);

        comboxPanel.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Select (Division, Department & Section)", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 0, 11), new java.awt.Color(255, 0, 0))); // NOI18N
        comboxPanel.setLayout(new java.awt.GridBagLayout());

        divisionCmbx.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Division", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 0, 11), new java.awt.Color(0, 51, 255))); // NOI18N
        divisionCmbx.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                divisionCmbxActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.ipadx = 15;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 0.2;
        gridBagConstraints.insets = new java.awt.Insets(0, 10, 0, 10);
        comboxPanel.add(divisionCmbx, gridBagConstraints);

        departmentCmbx.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Department", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 0, 11), new java.awt.Color(51, 51, 255))); // NOI18N
        departmentCmbx.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                departmentCmbxActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.ipadx = 15;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 0.2;
        gridBagConstraints.insets = new java.awt.Insets(0, 10, 0, 10);
        comboxPanel.add(departmentCmbx, gridBagConstraints);

        sectionCmbx.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Section", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 0, 11), new java.awt.Color(0, 0, 255))); // NOI18N
        sectionCmbx.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                sectionCmbxActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.ipadx = 15;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 0.2;
        gridBagConstraints.insets = new java.awt.Insets(0, 10, 0, 10);
        comboxPanel.add(sectionCmbx, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.gridwidth = 5;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.ipadx = 15;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 0.5;
        getContentPane().add(comboxPanel, gridBagConstraints);

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void dutySaveBtnActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_dutySaveBtnActionPerformed
        Date dateToday = new Date();
        SimpleDateFormat sdf = new SimpleDateFormat("EEE, d MMM yyyy");
        
        if (dutyCodeTxt.getText().equals("") || dutyDescripTxa.getText().equals("")) {
            System.out.println("Empty Values Registered!!!");
            if (dutyCodeTxt.getText().equals("") ) {
                JOptionPane.showMessageDialog(null, "Duty Code Field is Empty.", "Empty Values.", JOptionPane.ERROR_MESSAGE);
                dutyCodeLbl.setForeground(Color.red);
            } else {
                JOptionPane.showMessageDialog(null, "Duty Description Field is Empty.", "Empty Values.", JOptionPane.ERROR_MESSAGE);
                dutyDescripLbl.setForeground(Color.red);
            }
            
        } else {
            
            try {                        
                    java.sql.PreparedStatement pstmtUser = connectDB.prepareStatement("SELECT (SELECT upper(f_name||' '||l_name) FROM secure_menu_access "
                            + "where login_name = current_user order by 1 limit 1)");
                    java.sql.ResultSet rsetUser = pstmtUser.executeQuery();

                        while (rsetUser.next()) {
                            userLoggedIn = rsetUser.getString(1);

                        }

            } catch (java.sql.SQLException SqlExec) {

                SqlExec.printStackTrace();

                javax.swing.JOptionPane.showMessageDialog(new javax.swing.JFrame(), SqlExec.getMessage());

            }
            
            int a = JOptionPane.showConfirmDialog(null, "Do you want to Save Duty - '"+dutyCodeTxt.getText()+"'?", 
                                    "Saving Duty.", JOptionPane.YES_NO_CANCEL_OPTION);
            if (a == 0) {

                try {
                    connectDB.setAutoCommit(false);

                    java.sql.PreparedStatement pstmt = connectDB.prepareStatement("INSERT INTO hr.hr_duty_setup (duty_code, duty_description, "
                            + "duty_division, duty_department, duty_section, duty_date, duty_created_by) "
                            + "VALUES (?, ?, ?, ?, ?, ?, ?)");

                        pstmt.setString(1, dutyCodeTxt.getText().toString().trim());
                        pstmt.setString(2, dutyDescripTxa.getText().toString().trim());
                        pstmt.setString(3, divisionCmbx.getSelectedItem().toString().trim());
                        pstmt.setString(4, departmentCmbx.getSelectedItem().toString().trim());
                        pstmt.setString(5, sectionCmbx.getSelectedItem().toString().trim());
                        pstmt.setDate(6, com.afrisoftech.lib.SQLDateFormat.getSQLDate(dateToday));
                        pstmt.setObject(7, userLoggedIn);

                        pstmt.executeUpdate();
                        connectDB.commit();
                        connectDB.setAutoCommit(true);
                        
                        System.out.println("Date - "+com.afrisoftech.lib.SQLDateFormat.getSQLDate(dateToday));
                        
                        JOptionPane.showMessageDialog(null, "Duty - '"+dutyCodeTxt.getText()+"' Created and Saved Successfully!", 
                                "Duty Created.", JOptionPane.INFORMATION_MESSAGE);
                        
                        populateTable();
                        Clear();

                } catch (java.lang.Exception sq) {

                    try {
                        connectDB.rollback();
                    } catch (java.sql.SQLException sql) {
                        javax.swing.JOptionPane.showMessageDialog(this, sql.getMessage(), "Error Message!", javax.swing.JOptionPane.ERROR_MESSAGE);
                    }
                    System.out.println(sq.getMessage());
                    javax.swing.JOptionPane.showMessageDialog(this, sq.getMessage(), "Error", javax.swing.JOptionPane.ERROR_MESSAGE);

                }
                
                
             } else {
                JOptionPane.showMessageDialog(comboxPanel, "The Duty has not been Set-Up.", 
                    "Nothing Saved.", JOptionPane.INFORMATION_MESSAGE);
            }
        }
                
    }//GEN-LAST:event_dutySaveBtnActionPerformed

    private void dutyCodeTxtActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_dutyCodeTxtActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_dutyCodeTxtActionPerformed

    private void dutyEditBtnActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_dutyEditBtnActionPerformed
        int currFuncInt=Integer.parseInt(currFunction);
        String editCode=(String) batch[currFuncInt][0];
        dutyCodeTxt.setText(editCode);
        dutyDescripTxa.setText(dutyid[currFuncInt][1]);
        
    }//GEN-LAST:event_dutyEditBtnActionPerformed

    private void dutyClearBtnActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_dutyClearBtnActionPerformed
        Clear();
    }//GEN-LAST:event_dutyClearBtnActionPerformed

    private void dutyRemoveBtnActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_dutyRemoveBtnActionPerformed
        int a = JOptionPane.showConfirmDialog(null, "Do you want to Remove Duty - '"+currentDutiesTable.getValueAt(currentDutiesTable.getSelectedRow(), 0)+"'?", 
                                    "Removing Duty.", JOptionPane.YES_NO_CANCEL_OPTION);
            if (a == 0) {
                if(!currFunction.equals("new")){
                    try {
                        int currFuncInt=Integer.parseInt(currFunction);
                        String dutyidedit=dutyid[currFuncInt][0];
                        String sql="DELETE FROM hr.hr_duty_setup WHERE duty_id = "+dutyidedit+"";
                        System.out.println(currFuncInt+", "+currFunction+", "+dutyidedit);
                        Statement stmt = connectDB.createStatement();
                        stmt.execute( sql );
                        populateTable();
                        
                        JOptionPane.showMessageDialog(null,"Duty Deleted, Successfully!","Duty Deleted.", JOptionPane.INFORMATION_MESSAGE);
                        
                        Clear();
                        
                    } catch (SQLException ex) {
                        Logger.getLogger(dutiesSetup.class.getName()).log(Level.SEVERE, null, ex);
                    }
                }
            } else {
                JOptionPane.showMessageDialog(comboxPanel, "The Duty - '"+currentDutiesTable.getValueAt(currentDutiesTable.getSelectedRow(), 0)+"' has not been Removed.", 
                    "Nothing Removed.", JOptionPane.INFORMATION_MESSAGE);
            }
        
        
    }//GEN-LAST:event_dutyRemoveBtnActionPerformed

    private void currentDutiesTableMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_currentDutiesTableMouseClicked
        String rowSelected=Integer.toString(currentDutiesTable.getSelectedRow());
        dutyEditBtn.setEnabled(true);
        currFunction=rowSelected;
    }//GEN-LAST:event_currentDutiesTableMouseClicked

    private void currentDutiesTableFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_currentDutiesTableFocusLost
       
    }//GEN-LAST:event_currentDutiesTableFocusLost

    private void divisionCmbxActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_divisionCmbxActionPerformed
        departmentCmbx.setModel(com.afrisoftech.lib.ComboBoxModel.ComboBoxModel(connectDB, "SELECT DISTINCT department FROM master_file "
            + "WHERE unit_division = '"+divisionCmbx.getSelectedItem()+"' ORDER BY department"));
        departmentCmbx.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                departmentCmbxActionPerformed(evt);
            }
            });

        sectionCmbx.setModel(com.afrisoftech.lib.ComboBoxModel.ComboBoxModel(connectDB, "SELECT DISTINCT section FROM master_file "
            + "WHERE unit_division = '"+divisionCmbx.getSelectedItem()+"' AND department = '"+departmentCmbx.getSelectedItem()+"' ORDER BY section"));
        sectionCmbx.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                sectionCmbxActionPerformed(evt);
            }
            });

        populateTable();
    }//GEN-LAST:event_divisionCmbxActionPerformed

    private void departmentCmbxActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_departmentCmbxActionPerformed
        sectionCmbx.setModel(com.afrisoftech.lib.ComboBoxModel.ComboBoxModel(connectDB, "SELECT DISTINCT section FROM master_file "
            + "WHERE unit_division = '"+divisionCmbx.getSelectedItem()+"' AND department = '"+departmentCmbx.getSelectedItem()+"' ORDER BY section"));
        sectionCmbx.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                sectionCmbxActionPerformed(evt);
            }
            });

        populateTable();
    }//GEN-LAST:event_departmentCmbxActionPerformed

    private void sectionCmbxActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_sectionCmbxActionPerformed
        populateTable();
    }//GEN-LAST:event_sectionCmbxActionPerformed

    public final void populateTable(){
        try {
            
            String sql2 = "SELECT duty_code, duty_id, duty_description FROM hr.hr_duty_setup "
                    + "WHERE duty_division = '"+divisionCmbx.getSelectedItem()+"' "
                    + "AND duty_department = '"+departmentCmbx.getSelectedItem()+"' "
                    + "AND duty_section = '"+sectionCmbx.getSelectedItem()+"' "
                    + "ORDER BY duty_code ASC";
            
            Statement stmt2 = connectDB.createStatement(ResultSet.TYPE_SCROLL_INSENSITIVE, ResultSet.CONCUR_UPDATABLE);
            ResultSet rs2 = stmt2.executeQuery( sql2 );
            rs2.last();
            if(rs2.getRow()>0){
                batch=new Object[rs2.getRow()][1];
                dutyid=new String[rs2.getRow()][2];
                rs2.beforeFirst();
                int counter=0;
                while(rs2.next()) {
                    batch[counter][0]=(rs2.getString("duty_code"));
                    dutyid[counter][0]=rs2.getString("duty_id");
                    dutyid[counter][1]=rs2.getString("duty_description");
                    counter++;
                }
            }
            
            RefreshClientsTable();
            
            TableColumn col0=currentDutiesTable.getColumnModel().getColumn(0);
            col0.setPreferredWidth(20);
            
            DefaultTableCellRenderer rrendr=new DefaultTableCellRenderer();
            rrendr.setHorizontalAlignment(JLabel.CENTER);
            rrendr.setOpaque(true);            

            col0.setCellRenderer(rrendr);
        }catch (SQLException ex) {
            JOptionPane.showMessageDialog(null,"Error: "+ex.toString());

       }
        
    }
    
    
    private void RefreshClientsTable(){
        currentDutiesTable.setModel(com.afrisoftech.dbadmin.TableModel.createTableVectors(connectDB, 
                            "SELECT duty_code FROM hr.hr_duty_setup "
                                + "WHERE duty_division = '"+divisionCmbx.getSelectedItem()+"' "
                                + "AND duty_department = '"+departmentCmbx.getSelectedItem()+"' "
                                + "AND duty_section = '"+sectionCmbx.getSelectedItem()+"' "
                                + "ORDER BY duty_code ASC"));
    }
    
    private void populateCmbox() {
        divisionCmbx.setModel(com.afrisoftech.lib.ComboBoxModel.ComboBoxModel(connectDB, "SELECT DISTINCT unit_division FROM master_file "
                + "ORDER BY unit_division ASC"));
        divisionCmbx.addActionListener(new java.awt.event.ActionListener() {
                public void actionPerformed(java.awt.event.ActionEvent evt) {
                    departmentCmbxActionPerformed(evt);
                }
            }); 
                
        departmentCmbx.setModel(com.afrisoftech.lib.ComboBoxModel.ComboBoxModel(connectDB, "SELECT DISTINCT department FROM master_file "
                + " WHERE unit_division = '"+divisionCmbx.getSelectedItem()+"' ORDER BY department ASC"));
        departmentCmbx.addActionListener(new java.awt.event.ActionListener() {
                public void actionPerformed(java.awt.event.ActionEvent evt) {
                    departmentCmbxActionPerformed(evt);
                }
            });   
        
        sectionCmbx.setModel(com.afrisoftech.lib.ComboBoxModel.ComboBoxModel(connectDB, "SELECT DISTINCT section FROM master_file "
                    + "WHERE unit_division = '"+divisionCmbx.getSelectedItem()+"' AND department = '"+departmentCmbx.getSelectedItem()+"' "
                    + "ORDER BY section ASC"));
        sectionCmbx.addActionListener(new java.awt.event.ActionListener() {
                public void actionPerformed(java.awt.event.ActionEvent evt) {
                    sectionCmbxActionPerformed(evt);
                }
            });
        
    }
    
    public void Clear() {
        dutyCodeTxt.setText("");
        dutyDescripTxa.setText("");
        currFunction="new";
        dutyEditBtn.setEnabled(false);
    }


    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JPanel comboxPanel;
    private javax.swing.JPanel currentDutiesMainPanel;
    private javax.swing.JPanel currentDutiesPanel;
    private javax.swing.JScrollPane currentDutiesScrollPane;
    private javax.swing.JTable currentDutiesTable;
    private javax.swing.JComboBox departmentCmbx;
    private javax.swing.JComboBox divisionCmbx;
    private javax.swing.JButton dutyClearBtn;
    private javax.swing.JLabel dutyCodeLbl;
    private javax.swing.JTextField dutyCodeTxt;
    private javax.swing.JLabel dutyDescripLbl;
    private javax.swing.JScrollPane dutyDescripScrollPane;
    private javax.swing.JTextArea dutyDescripTxa;
    private javax.swing.JButton dutyEditBtn;
    private javax.swing.JButton dutyRemoveBtn;
    private javax.swing.JButton dutySaveBtn;
    private javax.swing.JPanel newDutiesMainPanel;
    private javax.swing.JPanel newDutiesPanel;
    private javax.swing.JComboBox sectionCmbx;
    // End of variables declaration//GEN-END:variables
}
